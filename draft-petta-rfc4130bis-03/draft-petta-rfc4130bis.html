<!DOCTYPE html>
<html lang="en" class="Internet-Draft">
<head>
<meta charset="utf-8">
<meta content="Common,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>AS2 Specification Modernization</title>
<meta content="Debra Petta" name="author">
<meta content='
       This document provides an applicability statement (RFC 2026, Section 3.2)
describing how to securely exchange structured business data over HTTP.
Structured business data may be XML; Electronic Data Interchange (EDI)
in either the American National Standards Committee (ANSI) X12 format or
the UN Electronic Data Interchange for Administration, Commerce, and
Transport (UN/EDIFACT) format; or other structured data formats. The data
is packaged using standard MIME structures. Authentication and data
confidentiality are obtained by using Cryptographic Message Syntax with
S/MIME security body parts (see  Section 10.1 ).
Authenticated acknowledgements make use of multipart/signed
Message Disposition Notification (MDN) responses to the original HTTP message.
This applicability statement is informally referred to as "AS2" because
it is the second applicability statement, produced after "AS1" (RFC 3335).
This document obsoletes RFC 4130 and stands on its own without reference to AS1
or SMTP, except where required for IANA registry updates. 
       This document also updates IANA registries originally created by RFC
3335 and RFC 4130. 
    ' name="description">
<meta content="xml2rfc 3.31.0" name="generator">
<meta content="AS2" name="keyword">
<meta content="EDIINT" name="keyword">
<meta content="B2B" name="keyword">
<meta content="draft-petta-rfc4130bis-latest" name="ietf.draft">
<!-- Generator version information:
  xml2rfc 3.31.0
    Python 3.12.12
    ConfigArgParse 1.7
    google-i18n-address 3.1.1
    intervaltree 3.2.1
    Jinja2 3.1.6
    lxml 6.0.2
    platformdirs 4.5.1
    pycountry 24.6.1
    PyYAML 6.0.3
    requests 2.32.5
    wcwidth 0.3.0
-->
<link href="draft-petta-rfc4130bis.xml" rel="alternate" type="application/rfc+xml">
<link href="#copyright" rel="license">
<style type="text/css">@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}

@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-cyrillic.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-cyrillic.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Lora SemiBold'), local('Lora-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-semibold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Oxygen Mono';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Oxygen Mono'), local('OxygenMono-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/oxygenmono-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Oxygen Mono';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Oxygen Mono'), local('OxygenMono-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/oxygenmono-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C8A, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-cyrillic.woff2') format('woff2');
  unicode-range: U+0301, U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-greek.woff2') format('woff2');
  unicode-range: U+0370-0377, U+037A-037F, U+0384-038A, U+038C, U+038E-03A1, U+03A3-03FF;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-02BA, U+02BD-02C5, U+02C7-02CC, U+02CE-02D7, U+02DD-02FF, U+0304, U+0308, U+0329, U+1D00-1DBF, U+1E00-1E9F, U+1EF2-1EFF, U+2020, U+20A0-20AB, U+20AD-20C0, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+0304, U+0308, U+0329, U+2000-206F, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C8A, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-cyrillic.woff2') format('woff2');
  unicode-range: U+0301, U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-greek.woff2') format('woff2');
  unicode-range: U+0370-0377, U+037A-037F, U+0384-038A, U+038C, U+038E-03A1, U+03A3-03FF;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-02BA, U+02BD-02C5, U+02C7-02CC, U+02CE-02D7, U+02DD-02FF, U+0304, U+0308, U+0329, U+1D00-1DBF, U+1E00-1E9F, U+1EF2-1EFF, U+2020, U+20A0-20AB, U+20AD-20C0, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+0304, U+0308, U+0329, U+2000-206F, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

:root {
  color-scheme: light dark;
  --background-color: #fff;
  --text-color: #222;
  --title-color: #191919;
  --link-color: #2a6496;
  --highlight-color: #f9f9f9;
  --line-color: #eee;
  --pilcrow-weak: #ddd;
  --pilcrow-strong: #bbb;
  --small-font-size: 14.5px;
  --font-mono: 'Oxygen Mono', monospace;
  --font-title: "Sofia Sans Semi Condensed", sans-serif;
  scrollbar-color: #bbb #eee;
}
body {
  max-width: 600px;
  margin: 75px auto;
  padding: 0 5px;
  color: var(--text-color);
  background-color: var(--background-color);
  font: 16px/22px "Lora", serif;
  scroll-behavior: smooth;
}

.ears {
  display: none;
}

/* headings */
section {
  clear: both;
}
.section-number {
  padding-right: 0.5em;
}
h1, h2, h3, h4, h5, h6 {
  font-family: var(--font-title);
  font-weight: 680;
  margin: 0.8em 0 0.3em;
  font-size-adjust: 0.5;
  color: var(--title-color);
}
h1#title {
  font-size: 32px;
  line-height: 40px;
  clear: both;
}
h1#title, h1#rfcnum {
  margin: 1.5em 0 0.2em;
}
h1#rfcnum + h1#title {
  margin: 0.2em 0;
}

h1, h2, h3 {
  font-size: 22px;
  line-height: 27px;
}
h4, h5, h6 {
  font-size: 20px;
  line-height: 24px;
}

/* general structure */
.author {
  padding-bottom: 0.3em;
  vertical-align: top;
}
#abstract+p {
  font-size: 18px;
  line-height: 24px;
}
#abstract+p code, #abstract+p samp, #abstract+p tt {
  font-size: 16px;
  line-height: 0;
}

p {
  padding: 0;
  margin: 0.5em 0;
  text-align: left;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  padding: 0.5em 1em 0;
  margin-bottom: 0.5em;
}
.alignRight.art-text pre {
  padding: 0;
  width: auto;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
/* font-family isn't space-separated, but =~ will have to do */
svg[font-family~="monospace" i], svg [font-family~="monospace" i] {
  font-family: var(--font-mono);
}
.alignCenter.art-text {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  padding: 0.5em 1em 0;
  margin-bottom: 0.5em;
}
.alignCenter.art-text pre {
  padding: 0;
  width: auto;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 0.5em 2em;
  & :is(ol, ul) {
    margin-left: 1em;
  }
}
li {
  margin: 0 0 0.25em 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
  & li {
    margin-top: 0.5em;
  }
}
:is(ul, ol).compact, .ulCompact, .olCompact {
  margin: 0 0 0 2em;
  & li {
    margin: 0;
    & :first-child { margin-top: 0; }
    & :last-child { margin-bottom: 0; }
  }
}

/* definition lists */
dl {
  clear: left;
  --indent: 3ch;
  /* --indent: attr(indent ch); not supported in any browser, but we can dream */
  &.olPercent {
    --indent: 5ch;
    & > dt {
      min-width: calc(var(--indent) - 2ch);
    }
  }
  &.olPercent > dt {
    float: none;
  }

  dl > dd > & {
    margin-top: 0.5em;
    margin-bottom: 0;
  }
}
dl:not(.dlNewline) > dt {
  float: left;
  margin-right: 2ch;
  min-width: 8ch;
}
dl > dd {
  margin-bottom: .8em;
  margin-left: var(--indent) !important; /* stupid element overrides */
  min-height: 2ex;
}
:is(dl.compact, .dlCompact) > dd {
  margin-bottom: 0;
  & > :is(:first-child, .break:first-child + *) {
    margin-top: 0;
  }
  & > :is(:last-child) {
    margin-bottom: 0;
  }
}
:is(dd, span).break {
  display: none;
}

/* links */
a, a[href].selfRef:hover {
  text-decoration: none;
}
a[href] {
  color: var(--link-color);
}
a[href].selfRef, .iref + a[href].internal {
  color: var(--text-color);
}
a[href]:hover {
  text-decoration: underline;
}
a[href].selfRef:hover {
  background-color: var(--highlight-color);
}
a.xref:is(.cite, .auto), :is(#status-of-memo, #copyright) a {
  white-space: nowrap;
}

/* Figures */
tt, code, pre {
  background-color: var(--highlight-color);
  font: 14px/22px var(--font-mono);
}
tt, code {
  /* changing the font for inline elements leads to different ascender
     and descender heights; as we want to retain baseline alignment,
     remove leading to avoid altering the final height of lines
     note: this fails if these blocks take an entire line,
     a different solution would be great */
  line-height: 0;
}
:is(h1, h2, h3, h4, h5, h6) :is(tt, code) {
  font-size: 84%;
}
pre {
  border: 1px solid var(--line-color);
  font-size: 13.5px;
  line-height: 16px;
  letter-spacing: -0.2px;
  margin: 5px;
  padding: 5px;
}
img {
  max-width: 100%;
}
figure {
  margin: 0.5em 0;
  padding: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption, caption {
  font-style: italic;
  margin: 0.5em 1.5em;
  text-align: left;
  caption-side: bottom;
}
@media screen {
  /* Auto-collapse boilerplate. */
  :is(#status-of-memo, #copyright) p {
    margin: -2px 0;
    max-height: 0;
    transition: max-height 2s ease, margin 0.5s ease 0.5s;
    overflow: hidden;
  }
  :is(#status-of-memo, #copyright):hover p,
  :is(#status-of-memo, #copyright) h2:target ~ p {
    margin: 0.5em 0;
    max-height: 500px;
    overflow: auto;
  }
  pre, svg {
    display: inline-block;
    /* In the horizontal direction, sometimes people make over-sized figures.
       Scrollbars for those is therefore necessary: auto adds them as necessary..
       In the vertical direction, the line-height can combine with the font
       asender/descender height to produce scrollbars: hidden avoids that. */
    overflow: auto hidden;
  }
  pre {
    max-width: 100%;
    width: calc(100% - 22px - 1em);
  }
  svg {
    max-width: calc(100% - 22px - 1em);
  }
  figure pre {
    display: block;
    width: calc(100% - 25px);
  }
  :is(pre, svg) + .pilcrow {
    display: inline-block;
    vertical-align: text-bottom;
    padding-bottom: 8px;
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 0 2em;
  font-style: italic;
}
blockquote {
  margin: 1em 0;
  border-left: 2px var(--pilcrow-strong) solid;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  width: auto;
  max-width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
}
table.right {
  margin-left: auto;
}
table.center {
  margin-left: auto;
  margin-right: auto;
}
table.left {
  margin-right: auto;
}
table .text-left {
  text-align: left;
}
table .text-center {
  text-align: center;
}
table .text-right {
  text-align: right;
}

thead, tbody {
  border: 1px solid var(--line-color);
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 5px 10px;
}
th {
  background-color: var(--line-color);
}
:is(tr:nth-child(2n), thead+tbody > tr:nth-child(2n+1)) > td {
  background-color: var(--background-color);
}
:is(tr:nth-child(2n+1), thead+tbody > tr:nth-child(2n)) > td {
  background-color: var(--highlight-color);
}
table caption {
  margin: 0;
  padding: 3px 0 3px 1em;
}
table p {
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  margin-left: 3px;
  opacity: 0.2;
  user-select: none;
  &[href] {
    color: var(--pilcrow-weak);
    &:hover { text-decoration: none; }
  }
}
@media not print {
  :hover > a.pilcrow, a.pilcrow:focus {
    opacity: 1;
  }
  a.pilcrow[href]:hover {
    color: var(--pilcrow-strong);
    background-color: transparent;
  }
}
@media print {
  a.pilcrow {
    display: none;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid var(--line-color);
}
.bcp14 {
  font-variant: small-caps;
  font-weight: 600;
  font-size: var(--small-font-size);
}
.role {
  font-variant: all-small-caps;
}
sub, sup {
  line-height: 1;
  font-size: 80%;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: var(--small-font-size);
  line-height: 18px;
  --identifier-width: 15ch;
  & dt {
    width: var(--identifier-width);
    min-width: var(--identifier-width);
    clear: left;
    float: left;
    text-align: right;
    margin-right: 1ch;
  }
  & dd {
    margin: 0;
    margin-left: calc(1em + var(--identifier-width)) !important;
    min-width: 5em;
  }
  & .authors {
    & .author {
      display: inline-block;
      margin-right: 1.5em;
    }
    & .org {
      font-style: italic;
    }
  }
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #999;
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;

  & nav {
    & ul {
      margin: 0 0.5em 0 0;
      padding: 0;
      list-style: none;
    }
    & li {
      line-height: 1.3em;
      margin: 2px 0;
      padding-left: 1.2em;
      text-indent: -1.2em;
    }
  }
  & a.xref {
    white-space: normal;
  }
}

.references {
  & > dt {
    text-align: right;
    font-weight: bold;
    min-width: 10ch;
    margin-right: 1.5ch;
    &:target::before {
      content: "⇒";
      margin: 0 10px 0 -25px;
    }
  }
  & > dd {
    margin-left: 12ch !important;
    overflow: visible;
    & .refInstance {
      margin-bottom: 0.8em;
    }
    & .ascii {
      margin-bottom: 0.25em;
    }
  }
}

#rfc\.index\.index + ul {
  margin-left: 0;
}

/* authors */
address.vcard {
  font-style: normal;
  max-width: 20em;
  margin: 1em auto 1em 0;

  & .nameRole {
    font-weight: 700;
    margin-left: 0;
  }
  & .label {
    margin: 0.5em 0;
  }
  & .type {
    display: none;
  }
  & .alternative-contact {
    margin: 0.5em 0 0.25em 0;
  }
  & .non-ascii {
    margin: 0 0 0 2em;
  }
  & div.left {
    text-align: left;
  }
  & div.right {
    text-align: right;
  }
}

hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}
@media (min-width: 500px) {
  #authors-addresses > section {
    column-count: 2;
    column-gap: 20px;
  }
  #authors-addresses > section > h2 {
    column-span: all;
  }
  /* hack for break-inside: avoid-column */
  #authors-addresses address {
    display: inline-block;
    break-inside: avoid-column;
  }
}

/* Comments */
.rfcEditorRemove p:first-of-type {
  font-style: italic;
}
.cref {
  background-color: rgba(249, 232, 105, 0.3);
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}

@media screen {
  #toc nav {
    font-family: var(--font-title);
    font-weight: 360;
    & > ul { margin-bottom: 2em; }
    & ul {
      margin: 0 0 0 4px;
      & :is(p, li) {
        margin: 2px 0;
      }
    }
  }
  #toc a.toplink {
    float: right;
  }
}
@media not screen {
  #toc a.toplink {
    display: none;
  }
}


/* TOC layout for smaller screens */
@media screen and (max-width: 929px) {
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 1px 0 0 0;
    margin: 0;
    border-bottom: 1px solid #ccc;
    opacity: 0.6;
  }
  #toc h2 {
    margin: 0;
    padding: 2px 0 2px 6px;
    padding-right: 1em;
    font-size: 18px;
    line-height: 24px;
    min-width: 190px;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
    &::before { /* css hamburger */
      float: right;
      position: relative;
      width: 1em;
      height: 1px;
      left: -164px;
      margin: 8px 0 0 0;
      background: white none repeat scroll 0 0;
      box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
      content: "";
    }
  }
  #toc nav {
    display: none;
    background-color: var(--background-color);
    padding: 0.5em 1em 1em;
    overflow: auto;
    overscroll-behavior: contain;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
  #toc.active {
    opacity: 1;
    & nav { display: block; }
  }
  /* Make the collapsed ToC header render white on gray also when it's a link */
  #toc h2 a,
  #toc h2 a:is(:link, :focus, :hover),
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
  #toc a.toplink {
    margin: 2px 0.5em 0;
  }
}

/* TOC layout for wide screens */
@media screen and (min-width: 930px) {
  body {
    padding-right: 360px;
    padding-right: calc(min(180px + 20%, 500px));
  }
  #toc {
    position: fixed;
    bottom: 0;
    right: 0;
    right: calc(50vw - 480px);
    width: 312px;
    margin: 0;
    padding: 0;
    z-index: 1;
  }
  #toc h2 {
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 2em;
    overflow: auto;
    overscroll-behavior: contain;
    scrollbar-width: thin;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
  #toc a.toplink {
    margin: 8px 0.5em 0;
  }
}

/* pagination */
@media print {
  body {
    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre, .vcard {
    page-break-inside: avoid;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  :is(h2, h3, h4, h5, h6)+*, dd {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
}

/* Dark mode. */
@media (prefers-color-scheme: dark) {
:root {
  --background-color: #121212;
  --text-color: #f0f0f0;
  --title-color: #fff;
  --link-color: #4da4f0;
  --highlight-color: #282828;
  --line-color: #444;
  --pilcrow-weak: #444;
  --pilcrow-strong: #666;
  scrollbar-color: #777 #333;
}
}

/* SVG Trick: a prefix match works because only black and white are allowed */
svg :is([stroke="black"], [stroke^="#000"]) {
  stroke: var(--text-color);
}
svg :is([stroke="white"], [stroke^="#fff"]) {
  stroke: var(--background-color);
}
svg :is([fill="black"], [fill^="#000"], :not([fill])) {
  fill: var(--text-color);
}
svg :is([fill="white"], [fill^="#fff"]) {
  fill: var(--background-color);
}
</style>

</head>
<body class="xml2rfc">
<table class="ears">
<thead><tr>
<td class="left">Internet-Draft</td>
<td class="center">AS2 Specification Modernization</td>
<td class="right">January 2026</td>
</tr></thead>
<tfoot><tr>
<td class="left">Petta</td>
<td class="center">Expires 1 August 2026</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-workgroup">Workgroup:</dt>
<dd class="workgroup">Network Working Group</dd>
<dt class="label-internet-draft">Internet-Draft:</dt>
<dd class="internet-draft">draft-petta-rfc4130bis-latest</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2026-01-28" class="published">28 January 2026</time>
    </dd>
<dt class="label-intended-status">Intended Status:</dt>
<dd class="intended-status">Informational</dd>
<dt class="label-expires">Expires:</dt>
<dd class="expires"><time datetime="2026-08-01">1 August 2026</time></dd>
<dt class="label-authors">Author:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">D. Petta</div>
<div class="org">Drummond Group, LLC</div>
</div>
</dd>
</dl>
</div>
<h1 id="title">AS2 Specification Modernization</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">This document provides an applicability statement (RFC 2026, Section 3.2)
describing how to securely exchange structured business data over HTTP.
Structured business data may be XML; Electronic Data Interchange (EDI)
in either the American National Standards Committee (ANSI) X12 format or
the UN Electronic Data Interchange for Administration, Commerce, and
Transport (UN/EDIFACT) format; or other structured data formats. The data
is packaged using standard MIME structures. Authentication and data
confidentiality are obtained by using Cryptographic Message Syntax with
S/MIME security body parts (see <a href="#https-tls-reqs" class="internal xref">Section 10.1</a>).
Authenticated acknowledgements make use of multipart/signed
Message Disposition Notification (MDN) responses to the original HTTP message.
This applicability statement is informally referred to as "AS2" because
it is the second applicability statement, produced after "AS1" (RFC 3335).
This document obsoletes RFC 4130 and stands on its own without reference to AS1
or SMTP, except where required for IANA registry updates.<a href="#section-abstract-1" class="pilcrow">¶</a></p>
<p id="section-abstract-2">This document also updates IANA registries originally created by RFC
3335 and RFC 4130.<a href="#section-abstract-2" class="pilcrow">¶</a></p>
</section>
<section class="note rfcEditorRemove" id="section-note.1">
      <h2 id="name-about-this-document">
<a href="#name-about-this-document" class="section-name selfRef">About This Document</a>
      </h2>
<p id="section-note.1-1">This note is to be removed before publishing as an RFC.<a href="#section-note.1-1" class="pilcrow">¶</a></p>
<p id="section-note.1-2">
        The latest revision of this draft can be found at <span><a href="https://DrummondGroup.github.io/draft-petta-rfc4130bis/draft-petta-rfc4130bis.html">https://DrummondGroup.github.io/draft-petta-rfc4130bis/draft-petta-rfc4130bis.html</a></span>.
        Status information for this document may be found at <span><a href="https://datatracker.ietf.org/doc/draft-petta-rfc4130bis/">https://datatracker.ietf.org/doc/draft-petta-rfc4130bis/</a></span>.<a href="#section-note.1-2" class="pilcrow">¶</a></p>
<p id="section-note.1-3">Source for this draft and an issue tracker can be found at
        <span><a href="https://github.com/DrummondGroup/draft-petta-rfc4130bis">https://github.com/DrummondGroup/draft-petta-rfc4130bis</a></span>.<a href="#section-note.1-3" class="pilcrow">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a href="#name-status-of-this-memo" class="section-name selfRef">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
        This Internet-Draft is submitted in full conformance with the
        provisions of BCP 78 and BCP 79.<a href="#section-boilerplate.1-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-2">
        Internet-Drafts are working documents of the Internet Engineering Task
        Force (IETF). Note that other groups may also distribute working
        documents as Internet-Drafts. The list of current Internet-Drafts is
        at <span><a href="https://datatracker.ietf.org/drafts/current/">https://datatracker.ietf.org/drafts/current/</a></span>.<a href="#section-boilerplate.1-2" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-3">
        Internet-Drafts are draft documents valid for a maximum of six months
        and may be updated, replaced, or obsoleted by other documents at any
        time. It is inappropriate to use Internet-Drafts as reference
        material or to cite them other than as "work in progress."<a href="#section-boilerplate.1-3" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-4">
        This Internet-Draft will expire on 1 August 2026.<a href="#section-boilerplate.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a href="#name-copyright-notice" class="section-name selfRef">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2026 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a href="#section-boilerplate.2-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Revised BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Revised BSD License.<a href="#section-boilerplate.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">▲</a><h2 id="name-table-of-contents">
<a href="#name-table-of-contents" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1"><a href="#section-1" class="auto internal xref">1</a>.  <a href="#name-introduction" class="internal xref">Introduction</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.1">
                <p id="section-toc.1-1.1.2.1.1" class="keepWithNext"><a href="#section-1.1" class="auto internal xref">1.1</a>.  <a href="#name-applicable-rfcs" class="internal xref">Applicable RFCs</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.2">
                <p id="section-toc.1-1.1.2.2.1" class="keepWithNext"><a href="#section-1.2" class="auto internal xref">1.2</a>.  <a href="#name-backward-compatibility-and-" class="internal xref">Backward Compatibility and Interoperability</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.3">
                <p id="section-toc.1-1.1.2.3.1" class="keepWithNext"><a href="#section-1.3" class="auto internal xref">1.3</a>.  <a href="#name-rationale" class="internal xref">Rationale</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.4">
                <p id="section-toc.1-1.1.2.4.1"><a href="#section-1.4" class="auto internal xref">1.4</a>.  <a href="#name-terms" class="internal xref">Terms</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1"><a href="#section-2" class="auto internal xref">2</a>.  <a href="#name-overview" class="internal xref">Overview</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.1">
                <p id="section-toc.1-1.2.2.1.1"><a href="#section-2.1" class="auto internal xref">2.1</a>.  <a href="#name-overall-operation" class="internal xref">Overall Operation</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.2">
                <p id="section-toc.1-1.2.2.2.1"><a href="#section-2.2" class="auto internal xref">2.2</a>.  <a href="#name-purpose-of-a-security-guide" class="internal xref">Purpose of a Security Guideline for MIME EDI</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.3">
                <p id="section-toc.1-1.2.2.3.1"><a href="#section-2.3" class="auto internal xref">2.3</a>.  <a href="#name-definitions" class="internal xref">Definitions</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.3.2.1">
                    <p id="section-toc.1-1.2.2.3.2.1.1"><a href="#section-2.3.1" class="auto internal xref">2.3.1</a>.  <a href="#name-the-secure-transmission-loo" class="internal xref">The Secure Transmission Loop</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.3.2.2">
                    <p id="section-toc.1-1.2.2.3.2.2.1"><a href="#section-2.3.2" class="auto internal xref">2.3.2</a>.  <a href="#name-definition-of-receipts" class="internal xref">Definition of Receipts</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.4">
                <p id="section-toc.1-1.2.2.4.1"><a href="#section-2.4" class="auto internal xref">2.4</a>.  <a href="#name-assumptions" class="internal xref">Assumptions</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.4.2.1">
                    <p id="section-toc.1-1.2.2.4.2.1.1"><a href="#section-2.4.1" class="auto internal xref">2.4.1</a>.  <a href="#name-edi-ec-process-assumptions" class="internal xref">EDI/EC Process Assumptions</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.4.2.2">
                    <p id="section-toc.1-1.2.2.4.2.2.1"><a href="#section-2.4.2" class="auto internal xref">2.4.2</a>.  <a href="#name-flexibility-assumptions" class="internal xref">Flexibility Assumptions</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a href="#section-3" class="auto internal xref">3</a>.  <a href="#name-referenced-rfcs-and-their-c" class="internal xref">Referenced RFCs and Their Contributions</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.1">
                <p id="section-toc.1-1.3.2.1.1"><a href="#section-3.1" class="auto internal xref">3.1</a>.  <a href="#name-rfc-2616-http-v11" class="internal xref">RFC 2616 HTTP v1.1 RFC2616</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2">
                <p id="section-toc.1-1.3.2.2.1"><a href="#section-3.2" class="auto internal xref">3.2</a>.  <a href="#name-rfc-1847-mime-security-mult" class="internal xref">RFC 1847 MIME Security Multiparts RFC1847</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.3">
                <p id="section-toc.1-1.3.2.3.1"><a href="#section-3.3" class="auto internal xref">3.3</a>.  <a href="#name-rfc-3462-multipart-report" class="internal xref">RFC 3462 Multipart/Report RFC3462</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.4">
                <p id="section-toc.1-1.3.2.4.1"><a href="#section-3.4" class="auto internal xref">3.4</a>.  <a href="#name-rfc-1767-edi-content" class="internal xref">RFC 1767 EDI Content RFC1767</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.5">
                <p id="section-toc.1-1.3.2.5.1"><a href="#section-3.5" class="auto internal xref">3.5</a>.  <a href="#name-rfc-2045-2046-and-2049-mime" class="internal xref">RFC 2045, 2046, and 2049 MIME   RFC2045, RFC2046, and RFC2049</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.6">
                <p id="section-toc.1-1.3.2.6.1"><a href="#section-3.6" class="auto internal xref">3.6</a>.  <a href="#name-rfc-3798-message-dispositio" class="internal xref">RFC 3798 Message Disposition Notification RFC3798</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.7">
                <p id="section-toc.1-1.3.2.7.1"><a href="#section-3.7" class="auto internal xref">3.7</a>.  <a href="#name-rfc-3851-and-3852-s-mime-ve" class="internal xref">RFC 3851 and 3852 S/MIME Version 3.1 Message Specifications and Cryptographic Message Syntax (CMS) RFC3851 / RFC3852</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.8">
                <p id="section-toc.1-1.3.2.8.1"><a href="#section-3.8" class="auto internal xref">3.8</a>.  <a href="#name-rfc-3023-xml-media-types" class="internal xref">RFC 3023 XML Media Types RFC3023</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.9">
                <p id="section-toc.1-1.3.2.9.1"><a href="#section-3.9" class="auto internal xref">3.9</a>.  <a href="#name-rfc-3274-compressed-data-co" class="internal xref">RFC 3274 Compressed Data Content Type for Cryptographic Message Syntax (CMS) RFC3274</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="auto internal xref">4</a>.  <a href="#name-structure-of-an-as2-message" class="internal xref">Structure of an AS2 Message</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.1">
                <p id="section-toc.1-1.4.2.1.1"><a href="#section-4.1" class="auto internal xref">4.1</a>.  <a href="#name-introduction-2" class="internal xref">Introduction</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2">
                <p id="section-toc.1-1.4.2.2.1"><a href="#section-4.2" class="auto internal xref">4.2</a>.  <a href="#name-structure-of-an-internet-ed" class="internal xref">Structure of an Internet EDI MIME Message</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="auto internal xref">5</a>.  <a href="#name-http-considerations" class="internal xref">HTTP Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1">
                <p id="section-toc.1-1.5.2.1.1"><a href="#section-5.1" class="auto internal xref">5.1</a>.  <a href="#name-sending-edi-in-http-post-re" class="internal xref">Sending EDI in HTTP POST Requests</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2">
                <p id="section-toc.1-1.5.2.2.1"><a href="#section-5.2" class="auto internal xref">5.2</a>.  <a href="#name-unused-mime-headers-and-ope" class="internal xref">Unused MIME Headers and Operations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2.2.1">
                    <p id="section-toc.1-1.5.2.2.2.1.1"><a href="#section-5.2.1" class="auto internal xref">5.2.1</a>.  <a href="#name-content-transfer-encoding-n" class="internal xref">Content-Transfer-Encoding Not Used in HTTP Transport</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2.2.2">
                    <p id="section-toc.1-1.5.2.2.2.2.1"><a href="#section-5.2.2" class="auto internal xref">5.2.2</a>.  <a href="#name-message-bodies" class="internal xref">Message Bodies</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.3">
                <p id="section-toc.1-1.5.2.3.1"><a href="#section-5.3" class="auto internal xref">5.3</a>.  <a href="#name-modification-of-mime-or-oth" class="internal xref">Modification of MIME or Other Headers or Parameters Used</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.3.2.1">
                    <p id="section-toc.1-1.5.2.3.2.1.1"><a href="#section-5.3.1" class="auto internal xref">5.3.1</a>.  <a href="#name-content-length" class="internal xref">Content-Length</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.3.2.2">
                    <p id="section-toc.1-1.5.2.3.2.2.1"><a href="#section-5.3.2" class="auto internal xref">5.3.2</a>.  <a href="#name-final-recipient-and-origina" class="internal xref">Final Recipient and Original Recipient</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.3.2.3">
                    <p id="section-toc.1-1.5.2.3.2.3.1"><a href="#section-5.3.3" class="auto internal xref">5.3.3</a>.  <a href="#name-message-id-and-original-mes" class="internal xref">Message-Id and Original-Message-Id</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.3.2.4">
                    <p id="section-toc.1-1.5.2.3.2.4.1"><a href="#section-5.3.4" class="auto internal xref">5.3.4</a>.  <a href="#name-host-header" class="internal xref">Host Header</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.4">
                <p id="section-toc.1-1.5.2.4.1"><a href="#section-5.4" class="auto internal xref">5.4</a>.  <a href="#name-http-response-status-codes" class="internal xref">HTTP Response Status Codes</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.5">
                <p id="section-toc.1-1.5.2.5.1"><a href="#section-5.5" class="auto internal xref">5.5</a>.  <a href="#name-http-error-recovery-and-rel" class="internal xref">HTTP Error Recovery and Reliability</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#section-6" class="auto internal xref">6</a>.  <a href="#name-additional-as2-specific-htt" class="internal xref">Additional AS2-Specific HTTP Headers</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.1">
                <p id="section-toc.1-1.6.2.1.1"><a href="#section-6.1" class="auto internal xref">6.1</a>.  <a href="#name-as2-version-header" class="internal xref">AS2 Version Header</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.2">
                <p id="section-toc.1-1.6.2.2.1"><a href="#section-6.2" class="auto internal xref">6.2</a>.  <a href="#name-as2-product-header" class="internal xref">AS2 Product header</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.3">
                <p id="section-toc.1-1.6.2.3.1"><a href="#section-6.3" class="auto internal xref">6.3</a>.  <a href="#name-as2-system-identifiers" class="internal xref">AS2 System Identifiers</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#section-7" class="auto internal xref">7</a>.  <a href="#name-algorithm-requirements" class="internal xref">Algorithm Requirements</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.1">
                <p id="section-toc.1-1.7.2.1.1"><a href="#section-7.1" class="auto internal xref">7.1</a>.  <a href="#name-hash-algorithms" class="internal xref">Hash Algorithms</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.2">
                <p id="section-toc.1-1.7.2.2.1"><a href="#section-7.2" class="auto internal xref">7.2</a>.  <a href="#name-encryption-algorithms" class="internal xref">Encryption Algorithms</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#section-8" class="auto internal xref">8</a>.  <a href="#name-structure-and-processing-of" class="internal xref">Structure and Processing of an MDN Message</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.1">
                <p id="section-toc.1-1.8.2.1.1"><a href="#section-8.1" class="auto internal xref">8.1</a>.  <a href="#name-introduction-3" class="internal xref">Introduction</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.2">
                <p id="section-toc.1-1.8.2.2.1"><a href="#section-8.2" class="auto internal xref">8.2</a>.  <a href="#name-synchronous-and-asynchronou" class="internal xref">Synchronous and Asynchronous MDNs</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.3">
                <p id="section-toc.1-1.8.2.3.1"><a href="#section-8.3" class="auto internal xref">8.3</a>.  <a href="#name-requesting-a-signed-receipt" class="internal xref">Requesting a Signed Receipt</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.3.2.1">
                    <p id="section-toc.1-1.8.2.3.2.1.1"><a href="#section-8.3.1" class="auto internal xref">8.3.1</a>.  <a href="#name-signed-receipt-consideratio" class="internal xref">Signed Receipt Considerations</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.4">
                <p id="section-toc.1-1.8.2.4.1"><a href="#section-8.4" class="auto internal xref">8.4</a>.  <a href="#name-mdn-format-and-values" class="internal xref">MDN Format and Values</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.4.2.1">
                    <p id="section-toc.1-1.8.2.4.2.1.1"><a href="#section-8.4.1" class="auto internal xref">8.4.1</a>.  <a href="#name-as2-mdn-general-formats" class="internal xref">AS2-MDN General Formats</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.4.2.2">
                    <p id="section-toc.1-1.8.2.4.2.2.1"><a href="#section-8.4.2" class="auto internal xref">8.4.2</a>.  <a href="#name-as2-mdn-construction" class="internal xref">AS2-MDN Construction</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.4.2.3">
                    <p id="section-toc.1-1.8.2.4.2.3.1"><a href="#section-8.4.3" class="auto internal xref">8.4.3</a>.  <a href="#name-as2-mdn-fields" class="internal xref">AS2-MDN Fields</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.4.2.4">
                    <p id="section-toc.1-1.8.2.4.2.4.1"><a href="#section-8.4.4" class="auto internal xref">8.4.4</a>.  <a href="#name-as2-mdn-field-requirements" class="internal xref">AS2-MDN Field Requirements</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.4.2.5">
                    <p id="section-toc.1-1.8.2.4.2.5.1"><a href="#section-8.4.5" class="auto internal xref">8.4.5</a>.  <a href="#name-additional-as2-mdn-programm" class="internal xref">Additional AS2-MDN Programming Notes</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.5">
                <p id="section-toc.1-1.8.2.5.1"><a href="#section-8.5" class="auto internal xref">8.5</a>.  <a href="#name-disposition-mode-type-and-m" class="internal xref">Disposition Mode, Type, and Modifier</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.5.2.1">
                    <p id="section-toc.1-1.8.2.5.2.1.1"><a href="#section-8.5.1" class="auto internal xref">8.5.1</a>.  <a href="#name-disposition-mode-overview" class="internal xref">Disposition Mode Overview</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.5.2.2">
                    <p id="section-toc.1-1.8.2.5.2.2.1"><a href="#section-8.5.2" class="auto internal xref">8.5.2</a>.  <a href="#name-successful-processing-statu" class="internal xref">Successful Processing Status Indication</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.5.2.3">
                    <p id="section-toc.1-1.8.2.5.2.3.1"><a href="#section-8.5.3" class="auto internal xref">8.5.3</a>.  <a href="#name-unsuccessful-processed-cont" class="internal xref">Unsuccessful Processed Content</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.5.2.4">
                    <p id="section-toc.1-1.8.2.5.2.4.1"><a href="#section-8.5.4" class="auto internal xref">8.5.4</a>.  <a href="#name-unsuccessful-non-content-pr" class="internal xref">Unsuccessful Non-Content Processing</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.5.2.5">
                    <p id="section-toc.1-1.8.2.5.2.5.1"><a href="#section-8.5.5" class="auto internal xref">8.5.5</a>.  <a href="#name-processing-warnings" class="internal xref">Processing Warnings</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.5.2.6">
                    <p id="section-toc.1-1.8.2.5.2.6.1"><a href="#section-8.5.6" class="auto internal xref">8.5.6</a>.  <a href="#name-backward-compatibility-with" class="internal xref">Backward Compatibility with Disposition Type, Modifier, and Extension</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.6">
                <p id="section-toc.1-1.8.2.6.1"><a href="#section-8.6" class="auto internal xref">8.6</a>.  <a href="#name-receipt-reply-consideration" class="internal xref">Receipt Reply Considerations in an HTTP POST</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a href="#section-9" class="auto internal xref">9</a>.  <a href="#name-public-key-certificate-hand" class="internal xref">Public Key Certificate Handling</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.1">
                <p id="section-toc.1-1.9.2.1.1"><a href="#section-9.1" class="auto internal xref">9.1</a>.  <a href="#name-certificate-roles-and-requi" class="internal xref">Certificate Roles and Requirements</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.2">
                <p id="section-toc.1-1.9.2.2.1"><a href="#section-9.2" class="auto internal xref">9.2</a>.  <a href="#name-certificate-exchange-and-re" class="internal xref">Certificate Exchange and Renewal</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.3">
                <p id="section-toc.1-1.9.2.3.1"><a href="#section-9.3" class="auto internal xref">9.3</a>.  <a href="#name-operational-guidance" class="internal xref">Operational Guidance</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a href="#section-10" class="auto internal xref">10</a>. <a href="#name-security-considerations" class="internal xref">Security Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.1">
                <p id="section-toc.1-1.10.2.1.1"><a href="#section-10.1" class="auto internal xref">10.1</a>.  <a href="#name-https-and-tls-requirements" class="internal xref">HTTPS and TLS Requirements</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.2">
                <p id="section-toc.1-1.10.2.2.1"><a href="#section-10.2" class="auto internal xref">10.2</a>.  <a href="#name-tls-server-certificates" class="internal xref">TLS Server Certificates</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.3">
                <p id="section-toc.1-1.10.2.3.1"><a href="#section-10.3" class="auto internal xref">10.3</a>.  <a href="#name-nrr-cautions" class="internal xref">NRR Cautions</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.4">
                <p id="section-toc.1-1.10.2.4.1"><a href="#section-10.4" class="auto internal xref">10.4</a>.  <a href="#name-replay-remark" class="internal xref">Replay Remark</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11">
            <p id="section-toc.1-1.11.1"><a href="#section-11" class="auto internal xref">11</a>. <a href="#name-iana-considerations" class="internal xref">IANA Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.1">
                <p id="section-toc.1-1.11.2.1.1"><a href="#section-11.1" class="auto internal xref">11.1</a>.  <a href="#name-registration" class="internal xref">Registration</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.1.2.1">
                    <p id="section-toc.1-1.11.2.1.2.1.1"><a href="#section-11.1.1" class="auto internal xref">11.1.1</a>.  <a href="#name-disposition-modifier-warnin" class="internal xref">Disposition Modifier 'warning'</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12">
            <p id="section-toc.1-1.12.1"><a href="#section-12" class="auto internal xref">12</a>. <a href="#name-acknowledgments" class="internal xref">Acknowledgments</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13">
            <p id="section-toc.1-1.13.1"><a href="#section-13" class="auto internal xref">13</a>. <a href="#name-references" class="internal xref">References</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13.2.1">
                <p id="section-toc.1-1.13.2.1.1"><a href="#section-13.1" class="auto internal xref">13.1</a>.  <a href="#name-normative-references" class="internal xref">Normative References</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13.2.2">
                <p id="section-toc.1-1.13.2.2.1"><a href="#section-13.2" class="auto internal xref">13.2</a>.  <a href="#name-informative-references" class="internal xref">Informative References</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14">
            <p id="section-toc.1-1.14.1"><a href="#appendix-A" class="auto internal xref">Appendix A</a>.  <a href="#name-message-examples" class="internal xref">Message Examples</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14.2.1">
                <p id="section-toc.1-1.14.2.1.1"><a href="#appendix-A.1" class="auto internal xref">A.1</a>.  <a href="#name-signed-message-requesting-a" class="internal xref">Signed Message Requesting a Signed, Synchronous Receipt</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14.2.2">
                <p id="section-toc.1-1.14.2.2.1"><a href="#appendix-A.2" class="auto internal xref">A.2</a>.  <a href="#name-mdn-for-message-in-a1-above" class="internal xref">MDN for Message in A.1, Above</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14.2.3">
                <p id="section-toc.1-1.14.2.3.1"><a href="#appendix-A.3" class="auto internal xref">A.3</a>.  <a href="#name-signed-encrypted-message-re" class="internal xref">Signed, Encrypted Message Requesting a Signed, Asynchronous Receipt</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14.2.4">
                <p id="section-toc.1-1.14.2.4.1"><a href="#appendix-A.4" class="auto internal xref">A.4</a>.  <a href="#name-asynchronous-mdn-for-messag" class="internal xref">Asynchronous MDN for Message in A.3, Above</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15">
            <p id="section-toc.1-1.15.1"><a href="#appendix-B" class="auto internal xref">Appendix B</a>.  <a href="#name-legacy-interoperability-non" class="internal xref">Legacy Interoperability (Non-Normative)</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.16">
            <p id="section-toc.1-1.16.1"><a href="#appendix-C" class="auto internal xref">Appendix C</a>.  <a href="#name-change-log-non-normative" class="internal xref">Change Log (Non-Normative)</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.16.2.1">
                <p id="section-toc.1-1.16.2.1.1"><a href="#appendix-C.1" class="auto internal xref">C.1</a>.  <a href="#name-general" class="internal xref">General</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.16.2.2">
                <p id="section-toc.1-1.16.2.2.1"><a href="#appendix-C.2" class="auto internal xref">C.2</a>.  <a href="#name-changes-affecting-section-1" class="internal xref">Changes affecting Section 1.2 - Backward Compatibility and Interoperability</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.16.2.3">
                <p id="section-toc.1-1.16.2.3.1"><a href="#appendix-C.3" class="auto internal xref">C.3</a>.  <a href="#name-changes-affecting-section-5" class="internal xref">Changes affecting Section 5.1 - AS2-Version Header</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.16.2.4">
                <p id="section-toc.1-1.16.2.4.1"><a href="#appendix-C.4" class="auto internal xref">C.4</a>.  <a href="#name-changes-affecting-section-53" class="internal xref">Changes affecting Section 5.3.3 — Message-Id and Original-Message-Id</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.16.2.5">
                <p id="section-toc.1-1.16.2.5.1"><a href="#appendix-C.5" class="auto internal xref">C.5</a>.  <a href="#name-changes-affecting-sections-" class="internal xref">Changes affecting Sections 5.4 and 5.5 — Reliability and Restart</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.16.2.6">
                <p id="section-toc.1-1.16.2.6.1"><a href="#appendix-C.6" class="auto internal xref">C.6</a>.  <a href="#name-changes-affecting-section-6" class="internal xref">Changes affecting Section 6 — Additional AS2-Specific HTTP Headers</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.16.2.7">
                <p id="section-toc.1-1.16.2.7.1"><a href="#appendix-C.7" class="auto internal xref">C.7</a>.  <a href="#name-changes-affecting-section-7" class="internal xref">Changes affecting Section 7 - Algorithm Requirements</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.16.2.8">
                <p id="section-toc.1-1.16.2.8.1"><a href="#appendix-C.8" class="auto internal xref">C.8</a>.  <a href="#name-changes-affecting-section-8" class="internal xref">Changes affecting Section 8 - MDN Processing</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.16.2.9">
                <p id="section-toc.1-1.16.2.9.1"><a href="#appendix-C.9" class="auto internal xref">C.9</a>.  <a href="#name-changes-affecting-section-9" class="internal xref">Changes affecting Section 9 — Public Key Certificate Handling</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.16.2.10">
                <p id="section-toc.1-1.16.2.10.1"><a href="#appendix-C.10" class="auto internal xref">C.10</a>. <a href="#name-changes-affecting-section-10" class="internal xref">Changes affecting Section 10 - Security Considerations</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.16.2.11">
                <p id="section-toc.1-1.16.2.11.1"><a href="#appendix-C.11" class="auto internal xref">C.11</a>. <a href="#name-changes-affecting-section-11" class="internal xref">Changes affecting Section 11 - IANA Considerations</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.16.2.12">
                <p id="section-toc.1-1.16.2.12.1"><a href="#appendix-C.12" class="auto internal xref">C.12</a>. <a href="#name-appendices" class="internal xref">Appendices</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.17">
            <p id="section-toc.1-1.17.1"><a href="#appendix-D" class="auto internal xref"></a><a href="#name-authors-address" class="internal xref">Author's Address</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="introduction">
<section id="section-1">
      <h2 id="name-introduction">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-introduction" class="section-name selfRef">Introduction</a>
      </h2>
<p id="section-1-1">This document is a revision ("bis") of RFC 4130, which defined the
Applicability Statement 2 (AS2) protocol for secure and reliable
transport of business data over HTTP. It obsoletes RFC 4130. The purpose
of this revision is to modernize the specification, clarify ambiguities,
and incorporate implementation experience gathered since the publication
of RFC 4130. Subsequent versions of this draft will refine these updates
based on discussion and consensus in the IETF community. This revision
also adheres to the principle of backward compatibility. Implementations
conformant with RFC 4130 remain valid under this specification, and no
breaking changes are introduced. In addition, this document updates
existing IANA registrations from RFC 3335 and RFC 4130. The specific
IANA actions are described in <a href="#iana-considerations" class="internal xref">Section 11</a>.<a href="#section-1-1" class="pilcrow">¶</a></p>
<p id="section-1-2">Note to readers: Some contributors have suggested that this work could
eventually be split into two documents: a minimal RFC4130bis for errata and
clarifications, and a separate AS2 v2 specification with a clean
modern baseline. This document currently attempts to balance both
objectives within a single text, but further discussion may refine
the scope.<a href="#section-1-2" class="pilcrow">¶</a></p>
<div id="applicable-rfcs">
<section id="section-1.1">
        <h3 id="name-applicable-rfcs">
<a href="#section-1.1" class="section-number selfRef">1.1. </a><a href="#name-applicable-rfcs" class="section-name selfRef">Applicable RFCs</a>
        </h3>
<p id="section-1.1-1">Previous work on Internet EDI focused on specifying MIME content types
for EDI data <span>[<a href="#RFC1767" class="cite xref">RFC1767</a>]</span>. This document expands on RFC 1767 to specify a
comprehensive set of data security features, specifically data
confidentiality, data integrity/authenticity, non-repudiation of origin,
and non-repudiation of receipt over HTTP. This document recognizes
contemporary RFCs and avoids re-inventing mechanisms wherever possible.
Although this document focuses on EDI data, any other data types
describable in a MIME format are also supported.<a href="#section-1.1-1" class="pilcrow">¶</a></p>
<p id="section-1.1-2">Internet MIME-based EDI can be accomplished by using and complying with
the following RFCs:<a href="#section-1.1-2" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-1.1-3">
<pre>
 o  RFC 2616 Hyper Text Transfer Protocol (baseline: HTTP/1.1)
 o  RFC 1767 EDI Content Type
 o  RFC 3023 XML Media Types
 o  RFC 1847 Security Multiparts for MIME
 o  RFC 3462 Multipart/Report
 o  RFC 2045 to 2049 MIME RFCs
 o  RFC 8098 Message Disposition Notification (updates RFC 3798)
 o  RFC 3851, 3852 S/MIME v3.1 Specification
 o  RFC 8551 S/MIME v4.0 (updated algorithm requirements including AES,
    AES-GCM, AES-CCM)
</pre><a href="#section-1.1-3" class="pilcrow">¶</a>
</div>
<p id="section-1.1-4">Our intent here is to define clearly and precisely how these are used
together, and what is required by user agents to be compliant with this
document. Implementers should note that HTTP/2 and HTTP/3 MAY be used
as transports, but are not required for interoperability.<a href="#section-1.1-4" class="pilcrow">¶</a></p>
<p id="section-1.1-5">The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
"SHOULD", "SHOULD NOT", "RECOMMENDED", "NOT RECOMMENDED", "MAY", and
"OPTIONAL" in this document are to be interpreted as described in
BCP 14 <span>[<a href="#RFC2119" class="cite xref">RFC2119</a>]</span> and <span>[<a href="#RFC8174" class="cite xref">RFC8174</a>]</span> when, and only when, they appear in all
capitals, as shown here.<a href="#section-1.1-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="backward-compatibility-and-interoperability">
<section id="section-1.2">
        <h3 id="name-backward-compatibility-and-">
<a href="#section-1.2" class="section-number selfRef">1.2. </a><a href="#name-backward-compatibility-and-" class="section-name selfRef">Backward Compatibility and Interoperability</a>
        </h3>
<p id="section-1.2-1">A central design principle of this specification is "backward
compatibility" with RFC 4130 and with the underlying RFCs it references.
This specification does not redefine or override backward-compatibility
rules established in those RFCs. Implementations MUST rely on the
mechanisms provided in underlying standards.<a href="#section-1.2-1" class="pilcrow">¶</a></p>
<p id="section-1.2-2">Consistent with the Robustness Principle ("be conservative in what you send and liberal in what you receive"),
this document clarifies requirements and aligns terminology but does not introduce breaking changes.
Implementations that conformed to RFC 4130 remain conformant to this specification. Any deviations
are limited to clarifications intended to improve interoperability.<a href="#section-1.2-2" class="pilcrow">¶</a></p>
<p id="section-1.2-3">Implementations MAY interoperate using S/MIME Version 3.1 <span><a href="#RFC3852" class="internal xref">RFC3851</a> [<a href="#RFC3852" class="cite xref">RFC3852</a>]</span>
with legacy trading partners, but conformant implementations MUST also
support S/MIME Version 4.0 <span>[<a href="#RFC8551" class="cite xref">RFC8551</a>]</span> to meet the algorithm requirements
of this specification and ensure forward compatibility. These provisions ensure
smooth migration for existing deployments while establishing RFC 8551 as
the baseline for new implementations.<a href="#section-1.2-3" class="pilcrow">¶</a></p>
<p id="section-1.2-4">This specification defines requirements for modern AS2 deployments
using contemporary cryptographic algorithms. It does not redefine or
extend the use of weak algorithms such as 3DES or SHA-1. When both
partners support this version of AS2, only modern algorithms are in
scope.<a href="#section-1.2-4" class="pilcrow">¶</a></p>
<p id="section-1.2-5">When interoperability with RFC 4130 systems is required, implementers
SHOULD apply the clarifications provided in Appendix B (Legacy
Interoperability). Appendix B is non-normative and does not alter the
algorithm requirements defined in Section 7, but records expected
behavior when communicating with legacy systems.<a href="#section-1.2-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="rationale">
<section id="section-1.3">
        <h3 id="name-rationale">
<a href="#section-1.3" class="section-number selfRef">1.3. </a><a href="#name-rationale" class="section-name selfRef">Rationale</a>
        </h3>
<p id="section-1.3-1">The updates in this specification reflect community consensus to:<a href="#section-1.3-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-1.3-2">
<pre>
 o  Preserve backward compatibility with RFC 4130 and the underlying
    RFCs it references.
 o  Provide explicit guidance on which protocol versions form the
    interoperability baseline for certification and testing.
 o  Incorporate de facto updates already widely deployed (e.g., RFC 8098
    for MDNs, migration from SHA-1 to SHA-2 wherever possible).
 o  Document stronger security requirements while allowing
    backward-compatible fallback to enable phased adoption.
 o  Avoid unnecessary disruption by permitting, but not requiring,
    newer transport features such as HTTP/2, and by clarifying rather
    than redefining MDN behavior.
</pre><a href="#section-1.3-2" class="pilcrow">¶</a>
</div>
<p id="section-1.3-3">This approach reduces ambiguity, simplifies certification, and ensures
interoperability across implementations.<a href="#section-1.3-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="terms">
<section id="section-1.4">
        <h3 id="name-terms">
<a href="#section-1.4" class="section-number selfRef">1.4. </a><a href="#name-terms" class="section-name selfRef">Terms</a>
        </h3>
<div class="breakable lang-text sourcecode" id="section-1.4-1">
<pre>
   AS2:     Applicability Statement 2 (this document) and [RFC4130]; see RFC 2026
            [RFC2026], Section 3.2

   EDI:     Electronic Data Interchange

   EC:      Electronic Commerce (often referred to as Business to Business, B2B).

   B2B:     Business to Business

   Receipt: The functional message that is sent from a receiver to a
            sender to acknowledge that an EDI/EC interchange has been
            received. This message may be either synchronous or asynchronous
            in nature.

   Signed Receipt: A receipt with a digital signature.

   Synchronous Receipt: A receipt returned to the sender over the same
            TCP/IP connection as the sender's original message.

   Asynchronous Receipt: A receipt returned to the sender over a different
            TCP/IP connection than the sender's original message.

   Message Disposition Notification (MDN): The Internet messaging format
            used to convey a receipt. This term is used interchangeably
            with receipt. An MDN is a receipt.

   Non-repudiation of receipt (NRR): A "legal event" that occurs when
            the original sender of an signed EDI/EC interchange has
            verified the signed receipt coming back from the receiver.
            The receipt contains data identifying the original message
            for which it is a receipt, including the message-ID and a
            cryptographic hash (MIC). The original sender must retain
            suitable records providing evidence concerning the message
            content, its message-ID, and its hash value. The original
            sender verifies that the retained hash value is the same as
            the digest of the original message, as reported in the
            signed receipt. NRR is not considered a technical message,
            but instead is thought of as an outcome of possessing
            relevant evidence.

   S/MIME:  A format and protocol for adding cryptographic signature
            and/or encryption services to Internet MIME messages.

   Cryptographic Message Syntax (CMS): An encapsulation syntax used to
            digitally sign, digest, authenticate, or encrypt arbitrary
            messages.

   SHA-1:   A secure, one-way hash algorithm used in conjunction with
            digital signature. This algorithm is retained for backward
            compatibility but is deprecated in this specification.
            Implementations MUST support SHA-256 or stronger where possible,
            and SHOULD prefer these algorithms in production environments
            unless legacy partners cannot yet migrate to SHA-256 or stronger.

   MD5:     A secure, one-way hash algorithm used in conjunction with
            digital signature. This algorithm is obsolete and MUST NOT be generated
            by conformant implementations.

   MIC:     The Message Integrity Check (MIC) is a cryptographic method used
            to verify that a message has not been altered or tampered with during
            transmission or storage, ensuring the data is trustworthy and complete.
            It works by generating a unique hash value from the message's contents,
            which is then transmitted with the message. The recipient recalculates
            the hash on the received message and compares it to the provided MIC;
            if they don't match, the message is discarded, indicating it was modified.

   User Agent (UA): The application that handles and processes the AS2 request.
</pre><a href="#section-1.4-1" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
<div id="overview">
<section id="section-2">
      <h2 id="name-overview">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-overview" class="section-name selfRef">Overview</a>
      </h2>
<div id="overall-operation">
<section id="section-2.1">
        <h3 id="name-overall-operation">
<a href="#section-2.1" class="section-number selfRef">2.1. </a><a href="#name-overall-operation" class="section-name selfRef">Overall Operation</a>
        </h3>
<p id="section-2.1-1">An HTTP POST operation <span>[<a href="#RFC2616" class="cite xref">RFC2616</a>]</span> is used to send appropriately packaged EDI,
   XML, or other business data. The Request-URI (<span>[<a href="#RFC2616" class="cite xref">RFC2616</a>]</span>, Section 10.5)
   identifies a process for unpacking and handling the message data and
   for generating a reply for the client that contains a message
   disposition acknowledgement (MDN), either signed or unsigned. The
   MDN is either returned in the HTTP response message body or by a new
   HTTP POST operation to a URL for the original sender.<a href="#section-2.1-1" class="pilcrow">¶</a></p>
<p id="section-2.1-2">This request/reply transactional interchange can provide secure,
   reliable, and authenticated transport for EDI or other business data
   using HTTP as a transfer protocol. HTTPS is RECOMMENDED as the default
   transport for new implementations (see <a href="#https-tls-reqs" class="internal xref">Section 10.1</a>).<a href="#section-2.1-2" class="pilcrow">¶</a></p>
<p id="section-2.1-3">The security protocols and structures used also support auditable
   records of these document data transmissions, acknowledgements, and
   authentication.<a href="#section-2.1-3" class="pilcrow">¶</a></p>
<p id="section-2.1-4">The message formats and processing requirements described below maintain
   strict backward compatibility (see <a href="#backward-compatibility-and-interoperability" class="internal xref">Section 1.2</a>).<a href="#section-2.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="purpose-of-a-security-guideline-for-mime-edi">
<section id="section-2.2">
        <h3 id="name-purpose-of-a-security-guide">
<a href="#section-2.2" class="section-number selfRef">2.2. </a><a href="#name-purpose-of-a-security-guide" class="section-name selfRef">Purpose of a Security Guideline for MIME EDI</a>
        </h3>
<p id="section-2.2-1">The purpose of these specifications is to ensure interoperability
   between B2B EC user agents, invoking some or all of the commonly
   expected security features.  This document is not limited to
   strict EDI use; it applies to any electronic commerce application for
   which business data needs to be exchanged securely over the Internet.<a href="#section-2.2-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="definitions">
<section id="section-2.3">
        <h3 id="name-definitions">
<a href="#section-2.3" class="section-number selfRef">2.3. </a><a href="#name-definitions" class="section-name selfRef">Definitions</a>
        </h3>
<div id="the-secure-transmission-loop">
<section id="section-2.3.1">
          <h4 id="name-the-secure-transmission-loo">
<a href="#section-2.3.1" class="section-number selfRef">2.3.1. </a><a href="#name-the-secure-transmission-loo" class="section-name selfRef">The Secure Transmission Loop</a>
          </h4>
<p id="section-2.3.1-1">This document's focus is on the formats and protocols for exchanging
   EDI/EC content securely in the Internet's HTTP environment.<a href="#section-2.3.1-1" class="pilcrow">¶</a></p>
<p id="section-2.3.1-2">In the "secure transmission loop" for EDI/EC, one organization sends
   a signed, encrypted and compressed EDI/EC interchange to another organization
   and requests a signed receipt, and later the receiving organization sends
   this signed receipt back to the sending organization. In other words, the
   following transpires:<a href="#section-2.3.1-2" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-2.3.1-3">
<pre>
  o  The organization sending EDI/EC data signs, encrypts and compresses
     the data using S/MIME. In addition, the message will request that
     a signed receipt be returned to the sender. To support NRR,
     the original sender retains records of the message, message-ID,
     and digest (MIC) value.

  o  The receiving organization decompresses and decrypts the message and
     verifies the signature, resulting in verified integrity of the data and
     authenticity of the sender.

  o  The receiving organization then returns a signed receipt using
     the HTTP reply body or a separate HTTP POST operation to the
     sending organization in the form of a signed message
     disposition notification.  This signed receipt will contain the
     hash of the received message, allowing the original sender to
     have evidence that the received message was authenticated
     and/or decrypted properly by the receiver.
</pre><a href="#section-2.3.1-3" class="pilcrow">¶</a>
</div>
<p id="section-2.3.1-4">The above describes functionality that, if implemented, will satisfy
   all security requirements and implement non-repudiation of receipt
   for the exchange.  This specification, however, leaves full
   flexibility for users to decide the degree to which they want to
   deploy those security features with their trading partners.<a href="#section-2.3.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="definition-of-receipts">
<section id="section-2.3.2">
          <h4 id="name-definition-of-receipts">
<a href="#section-2.3.2" class="section-number selfRef">2.3.2. </a><a href="#name-definition-of-receipts" class="section-name selfRef">Definition of Receipts</a>
          </h4>
<p id="section-2.3.2-1">The term used for both the functional activity and the message for
   acknowledging delivery of an EDI/EC interchange is "receipt" or
   "signed receipt". The first term is used if the acknowledgment is
   for an interchange resulting in a receipt that is NOT signed. The
   second term is used if the acknowledgement is for an interchange
   resulting in a receipt that IS signed.<a href="#section-2.3.2-1" class="pilcrow">¶</a></p>
<p id="section-2.3.2-2">The term non-repudiation of receipt (NRR) is often used in
   combination with receipts. NRR refers to a legal event that occurs
   only when the original sender of an interchange has verified the
   signed receipt coming back from the recipient of the message, and has
   verified that the returned MIC value inside the MDN matches the
   previously recorded value for the original message.<a href="#section-2.3.2-2" class="pilcrow">¶</a></p>
<p id="section-2.3.2-3">NRR is best established when both the original message and the
   receipt make use of digital signatures. See the Security
   Considerations section for some cautions regarding NRR.
   For information on how to format and process receipts in AS2, refer
   to refer to <a href="#structure-and-processing-of-an-mdn-message" class="internal xref">Section 8</a>.<a href="#section-2.3.2-3" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="assumptions">
<section id="section-2.4">
        <h3 id="name-assumptions">
<a href="#section-2.4" class="section-number selfRef">2.4. </a><a href="#name-assumptions" class="section-name selfRef">Assumptions</a>
        </h3>
<div id="ediec-process-assumptions">
<section id="section-2.4.1">
          <h4 id="name-edi-ec-process-assumptions">
<a href="#section-2.4.1" class="section-number selfRef">2.4.1. </a><a href="#name-edi-ec-process-assumptions" class="section-name selfRef">EDI/EC Process Assumptions</a>
          </h4>
<p id="section-2.4.1-1">o  Encrypted object is an EDI/EC Interchange.<a href="#section-2.4.1-1" class="pilcrow">¶</a></p>
<p id="section-2.4.1-2">This specification assumes that a typical EDI/EC interchange (i.e., the payload)
   is the lowest-level object that will be subject to security services.<a href="#section-2.4.1-2" class="pilcrow">¶</a></p>
<p id="section-2.4.1-3">Specifically, in EDI ANSI X12, this means that anything between and
   including, segments ISA and IEA is secured. In EDIFACT, this means
   that anything between, and including, segments UNA/UNB and UNZ is
   secured. In other words, the EDI/EC interchanges including envelope
   segments remain intact and unreadable during fully secured transport.<a href="#section-2.4.1-3" class="pilcrow">¶</a></p>
<p id="section-2.4.1-4">o  EDI envelope headers are encrypted.<a href="#section-2.4.1-4" class="pilcrow">¶</a></p>
<p id="section-2.4.1-5">Congruent with the above statement, EDI envelope headers are NOT
   visible in the MIME package.<a href="#section-2.4.1-5" class="pilcrow">¶</a></p>
<p id="section-2.4.1-6">In order to optimize routing from existing commercial EDI networks
   (called Value Added Networks or VANs) to the Internet, it was previously
   useful to make some envelope information visible. Since the EDI/EC message exchanges
   are routed over the public internet and not over VANs, this
   specification provides no support for this optimization.<a href="#section-2.4.1-6" class="pilcrow">¶</a></p>
<p id="section-2.4.1-7">o  X12.58 and UN/EDIFACT Security Considerations<a href="#section-2.4.1-7" class="pilcrow">¶</a></p>
<p id="section-2.4.1-8">The most common EDI standards bodies, ANSI X12 and EDIFACT, have
   defined internal provisions for security. X12.58 is the security
   mechanism for ANSI X12, and AUTACK provides security for EDIFACT.
   This specification does NOT dictate use or non-use of these security
   standards. They are both fully compatible, though possibly
   redundant, with this specification.<a href="#section-2.4.1-8" class="pilcrow">¶</a></p>
</section>
</div>
<div id="flexibility-assumptions">
<section id="section-2.4.2">
          <h4 id="name-flexibility-assumptions">
<a href="#section-2.4.2" class="section-number selfRef">2.4.2. </a><a href="#name-flexibility-assumptions" class="section-name selfRef">Flexibility Assumptions</a>
          </h4>
<p id="section-2.4.2-1">o  Encrypted or Unencrypted Data<a href="#section-2.4.2-1" class="pilcrow">¶</a></p>
<p id="section-2.4.2-2">This specification allows for EDI/EC message exchange in which the
   EDI/EC data can be either unprotected or protected by means of
   encryption.<a href="#section-2.4.2-2" class="pilcrow">¶</a></p>
<p id="section-2.4.2-3">o  Signed or Unsigned Data<a href="#section-2.4.2-3" class="pilcrow">¶</a></p>
<p id="section-2.4.2-4">This specification allows for EDI/EC message exchange with or without
   digital signature of the original EDI transmission.<a href="#section-2.4.2-4" class="pilcrow">¶</a></p>
<p id="section-2.4.2-5">o  Compressed or Uncompressed Data<a href="#section-2.4.2-5" class="pilcrow">¶</a></p>
<p id="section-2.4.2-6">This specification allows for optional compression and MAY be applied alone
  or in combination with signing and/or encryption, as defined in <span>[<a href="#RFC3274" class="cite xref">RFC3274</a>]</span>.
  It is supported by AS2-Version: 1.1 and higher.<a href="#section-2.4.2-6" class="pilcrow">¶</a></p>
<p id="section-2.4.2-7">o  Optional Use of Receipt<a href="#section-2.4.2-7" class="pilcrow">¶</a></p>
<p id="section-2.4.2-8">This specification allows for EDI/EC message transmission with or
   without a request for receipt notification.  A signed receipt
   notification is requested; however, a MIC value is REQUIRED as part
   of the returned receipt, except when a severe error condition
   prevents computation of the digest value. In the exceptional case, a
   signed receipt should be returned with an error message that
   effectively explains why the required MIC value is absent.<a href="#section-2.4.2-8" class="pilcrow">¶</a></p>
<p id="section-2.4.2-9">o  Use of Synchronous or Asynchronous Receipts<a href="#section-2.4.2-9" class="pilcrow">¶</a></p>
<p id="section-2.4.2-10">In addition to a receipt request, this specification allows for the
   designation of the type of receipt that should be returned. It
   supports synchronous or asynchronous receipts in the MDN format
   specified in Section 8 of this document.<a href="#section-2.4.2-10" class="pilcrow">¶</a></p>
<p id="section-2.4.2-11">o  Security Formatting<a href="#section-2.4.2-11" class="pilcrow">¶</a></p>
<p id="section-2.4.2-12">This specification relies on the guidelines set forth in RFC
   3851/3852  <span>[<a href="#RFC3851" class="cite xref">RFC3851</a>]</span> / <span>[<a href="#RFC3852" class="cite xref">RFC3852</a>]</span> "S/MIME Version 3.1 Message Specification;
   Cryptographic Message Syntax" as well as RFC 8551 <span>[<a href="#RFC8551" class="cite xref">RFC8551</a>]</span> "Secure/Multipurpose Internet
   Mail Extensions (S/MIME) Version 4.0" for modern implementations.<a href="#section-2.4.2-12" class="pilcrow">¶</a></p>
<p id="section-2.4.2-13">o  Hash Function, Message Digest Choices<a href="#section-2.4.2-13" class="pilcrow">¶</a></p>
<p id="section-2.4.2-14">When a signature is used, implementations MUST support SHA-256 and SHOULD
   support SHA-384 or stronger. SHA-1 MAY be supported for incoming messages
   for backward compatibility, but SHOULD NOT be generated for outgoing messages
   unless it is strictly required for interoperability. MD5 is obsolete
   and MUST NOT be generated by conformant implementations.<a href="#section-2.4.2-14" class="pilcrow">¶</a></p>
<p id="section-2.4.2-15">o  Permutation Summary<a href="#section-2.4.2-15" class="pilcrow">¶</a></p>
<p id="section-2.4.2-16">The optional use of compression, as defined in <span>[<a href="#RFC3274" class="cite xref">RFC3274</a>]</span> was introduced in AS2-Version 1.1.
   Compression can be applied to the message payload before signing and/or encryption,
   reducing transmission size and improving efficiency. Most modern AS2 implementations
   support compression, and it can be used by itself or in combination with signing and encryption.<a href="#section-2.4.2-16" class="pilcrow">¶</a></p>
<p id="section-2.4.2-17">The following summary therefore extends the original AS2 security permutations to include
   the additional possibilities created by the use of compression, resulting in a total of
   twenty-four security permutations.<a href="#section-2.4.2-17" class="pilcrow">¶</a></p>
<p id="section-2.4.2-18">Without Compression (12 permutations)<a href="#section-2.4.2-18" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-2.4.2-19">
<li id="section-2.4.2-19.1">
              <p id="section-2.4.2-19.1.1">Sender sends un-encrypted data and does NOT request a receipt.<a href="#section-2.4.2-19.1.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-2.4.2-19.2">
              <p id="section-2.4.2-19.2.1">Sender sends un-encrypted data and requests an unsigned receipt.
Receiver sends back the unsigned receipt.<a href="#section-2.4.2-19.2.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-2.4.2-19.3">
              <p id="section-2.4.2-19.3.1">Sender sends un-encrypted data and requests a signed receipt.
Receiver sends back the signed receipt.<a href="#section-2.4.2-19.3.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-2.4.2-19.4">
              <p id="section-2.4.2-19.4.1">Sender sends encrypted data and does NOT request a receipt.<a href="#section-2.4.2-19.4.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-2.4.2-19.5">
              <p id="section-2.4.2-19.5.1">Sender sends encrypted data and requests an unsigned receipt.
Receiver sends back the unsigned receipt.<a href="#section-2.4.2-19.5.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-2.4.2-19.6">
              <p id="section-2.4.2-19.6.1">Sender sends encrypted data and requests a signed receipt.
Receiver sends back the signed receipt.<a href="#section-2.4.2-19.6.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-2.4.2-19.7">
              <p id="section-2.4.2-19.7.1">Sender sends signed data and does NOT request a signed or
unsigned receipt.<a href="#section-2.4.2-19.7.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-2.4.2-19.8">
              <p id="section-2.4.2-19.8.1">Sender sends signed data and requests an unsigned receipt.
Receiver sends back the unsigned receipt.<a href="#section-2.4.2-19.8.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-2.4.2-19.9">
              <p id="section-2.4.2-19.9.1">Sender sends signed data and requests a signed receipt.
Receiver sends back the signed receipt.<a href="#section-2.4.2-19.9.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-2.4.2-19.10">
              <p id="section-2.4.2-19.10.1">Sender sends encrypted and signed data and does NOT request a
signed or unsigned receipt.<a href="#section-2.4.2-19.10.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-2.4.2-19.11">
              <p id="section-2.4.2-19.11.1">Sender sends encrypted and signed data and requests an unsigned
receipt.  Receiver sends back the unsigned receipt.<a href="#section-2.4.2-19.11.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-2.4.2-19.12">
              <p id="section-2.4.2-19.12.1">Sender sends encrypted and signed data and requests a signed
receipt.  Receiver sends back the signed receipt.<a href="#section-2.4.2-19.12.1" class="pilcrow">¶</a></p>
</li>
          </ol>
<p id="section-2.4.2-20">With Compression (12 permutations)<a href="#section-2.4.2-20" class="pilcrow">¶</a></p>
<ol start="13" type="1" class="normal type-1" id="section-2.4.2-21">
<li id="section-2.4.2-21.1">
              <p id="section-2.4.2-21.1.1">Sender sends compressed data (not encrypted or signed) and does NOT request a receipt.<a href="#section-2.4.2-21.1.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-2.4.2-21.2">
              <p id="section-2.4.2-21.2.1">Sender sends compressed data and requests an unsigned receipt. Receiver sends back the unsigned receipt.<a href="#section-2.4.2-21.2.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-2.4.2-21.3">
              <p id="section-2.4.2-21.3.1">Sender sends compressed data and requests a signed receipt. Receiver sends back the signed receipt.<a href="#section-2.4.2-21.3.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-2.4.2-21.4">
              <p id="section-2.4.2-21.4.1">Sender sends compressed and encrypted data and does NOT request a receipt.<a href="#section-2.4.2-21.4.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-2.4.2-21.5">
              <p id="section-2.4.2-21.5.1">Sender sends compressed and encrypted data and requests an unsigned receipt. Receiver sends back the unsigned receipt.<a href="#section-2.4.2-21.5.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-2.4.2-21.6">
              <p id="section-2.4.2-21.6.1">Sender sends compressed and encrypted data and requests a signed receipt. Receiver sends back the signed receipt.<a href="#section-2.4.2-21.6.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-2.4.2-21.7">
              <p id="section-2.4.2-21.7.1">Sender sends compressed and signed data and does NOT request a signed or unsigned receipt.<a href="#section-2.4.2-21.7.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-2.4.2-21.8">
              <p id="section-2.4.2-21.8.1">Sender sends compressed and signed data and requests an unsigned receipt. Receiver sends back the unsigned receipt.<a href="#section-2.4.2-21.8.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-2.4.2-21.9">
              <p id="section-2.4.2-21.9.1">Sender sends compressed and signed data and requests a signed receipt. Receiver sends back the signed receipt.<a href="#section-2.4.2-21.9.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-2.4.2-21.10">
              <p id="section-2.4.2-21.10.1">Sender sends compressed, encrypted, and signed data and does NOT request a signed or unsigned receipt.<a href="#section-2.4.2-21.10.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-2.4.2-21.11">
              <p id="section-2.4.2-21.11.1">Sender sends compressed, encrypted, and signed data and requests an unsigned receipt. Receiver sends back the unsigned receipt.<a href="#section-2.4.2-21.11.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-2.4.2-21.12">
              <p id="section-2.4.2-21.12.1">Sender sends compressed, encrypted, and signed data and requests a signed receipt. Receiver sends back the signed receipt.<a href="#section-2.4.2-21.12.1" class="pilcrow">¶</a></p>
</li>
          </ol>
<p id="section-2.4.2-22"><strong>Key Notes</strong><a href="#section-2.4.2-22" class="pilcrow">¶</a></p>
<p id="section-2.4.2-23">o Compression MAY be applied alone or in combination with signing and/or encryption, as defined in <span>[<a href="#RFC3274" class="cite xref">RFC3274</a>]</span> and is supported
     by AS2-Version 1.1 and higher.<a href="#section-2.4.2-23" class="pilcrow">¶</a></p>
<p id="section-2.4.2-24">o Users may choose any of these twenty-four possibilities, but only the final example (24), when compression, signing, encryption,
     and a signed receipt are all used, offers the full suite of security and efficiency features described in
    <a href="#the-secure-transmission-loop" class="internal xref">Section 2.3.1</a>, “The Secure Transmission Loop.”<a href="#section-2.4.2-24" class="pilcrow">¶</a></p>
<p id="section-2.4.2-25">o As with the original permutations, the receipts may be either synchronous or asynchronous, and the choice does not change the nature of
     the secure transmission loop in support of NRR.<a href="#section-2.4.2-25" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="referenced-rfcs-and-their-contributions">
<section id="section-3">
      <h2 id="name-referenced-rfcs-and-their-c">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-referenced-rfcs-and-their-c" class="section-name selfRef">Referenced RFCs and Their Contributions</a>
      </h2>
<div id="rfc-2616-http-v11-rfc2616">
<section id="section-3.1">
        <h3 id="name-rfc-2616-http-v11">
<a href="#section-3.1" class="section-number selfRef">3.1. </a><a href="#name-rfc-2616-http-v11" class="section-name selfRef">RFC 2616 HTTP v1.1 <span class="cite xref">[RFC2616]</span></a>
        </h3>
<p id="section-3.1-1">This document specifies how data is transferred using HTTP.<a href="#section-3.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="rfc-1847-mime-security-multiparts-rfc1847">
<section id="section-3.2">
        <h3 id="name-rfc-1847-mime-security-mult">
<a href="#section-3.2" class="section-number selfRef">3.2. </a><a href="#name-rfc-1847-mime-security-mult" class="section-name selfRef">RFC 1847 MIME Security Multiparts <span class="cite xref">[RFC1847]</span></a>
        </h3>
<p id="section-3.2-1">This document defines security multipart for MIME:
   multipart/encrypted and multipart/signed.<a href="#section-3.2-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="rfc-3462-multipartreport-rfc3462">
<section id="section-3.3">
        <h3 id="name-rfc-3462-multipart-report">
<a href="#section-3.3" class="section-number selfRef">3.3. </a><a href="#name-rfc-3462-multipart-report" class="section-name selfRef">RFC 3462 Multipart/Report <span class="cite xref">[RFC3462]</span></a>
        </h3>
<p id="section-3.3-1">This RFC defines the use of the multipart/report content type,
   something that the MDN RFC 3798 builds upon.<a href="#section-3.3-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="rfc-1767-edi-content-rfc1767">
<section id="section-3.4">
        <h3 id="name-rfc-1767-edi-content">
<a href="#section-3.4" class="section-number selfRef">3.4. </a><a href="#name-rfc-1767-edi-content" class="section-name selfRef">RFC 1767 EDI Content <span class="cite xref">[RFC1767]</span></a>
        </h3>
<p id="section-3.4-1">This RFC defines the use of content type "application" for ANSI X12
   (application/EDI-X12), EDIFACT (application/EDIFACT), and mutually
   defined EDI (application/EDI-Consent).<a href="#section-3.4-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="rfc-2045-2046-and-2049-mime-rfc2045-rfc2046-and-rfc2049">
<section id="section-3.5">
        <h3 id="name-rfc-2045-2046-and-2049-mime">
<a href="#section-3.5" class="section-number selfRef">3.5. </a><a href="#name-rfc-2045-2046-and-2049-mime" class="section-name selfRef">RFC 2045, 2046, and 2049 MIME   <span class="cite xref">[RFC2045]</span>, <span class="cite xref">[RFC2046]</span>, and <span class="cite xref">[RFC2049]</span></a>
        </h3>
<p id="section-3.5-1">These are the basic MIME standards, upon which all MIME related RFCs
   build, including this one. Key contributions include definitions of
   "content type", "sub-type", and "multipart", as well as encoding
   guidelines, which establish 7-bit US-ASCII as the canonical character
   set to be used in Internet messaging.<a href="#section-3.5-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="rfc-3798-message-disposition-notification-rfc3798">
<section id="section-3.6">
        <h3 id="name-rfc-3798-message-dispositio">
<a href="#section-3.6" class="section-number selfRef">3.6. </a><a href="#name-rfc-3798-message-dispositio" class="section-name selfRef">RFC 3798 Message Disposition Notification <span class="cite xref">[RFC3798]</span></a>
        </h3>
<p id="section-3.6-1">This Internet RFC defines how an MDN is requested, and the format and
   syntax of the MDN. The MDN is the basis upon which receipts and
   signed receipts are defined in this specification.<a href="#section-3.6-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="rfc-3851-and-3852-smime-version-31-message-specifications-and-cryptographic-message-syntax-cms-rfc3851-rfc3852">
<section id="section-3.7">
        <h3 id="name-rfc-3851-and-3852-s-mime-ve">
<a href="#section-3.7" class="section-number selfRef">3.7. </a><a href="#name-rfc-3851-and-3852-s-mime-ve" class="section-name selfRef">RFC 3851 and 3852 S/MIME Version 3.1 Message Specifications and Cryptographic Message Syntax (CMS) <span class="cite xref">[RFC3851]</span> / <span class="cite xref">[RFC3852]</span></a>
        </h3>
<p id="section-3.7-1">This specification describes how S/MIME will carry CMS Objects.<a href="#section-3.7-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="rfc-3023-xml-media-types-rfc3023">
<section id="section-3.8">
        <h3 id="name-rfc-3023-xml-media-types">
<a href="#section-3.8" class="section-number selfRef">3.8. </a><a href="#name-rfc-3023-xml-media-types" class="section-name selfRef">RFC 3023 XML Media Types <span class="cite xref">[RFC3023]</span></a>
        </h3>
<p id="section-3.8-1">This RFC defines the use of content type "application" for XML
   (application/xml).<a href="#section-3.8-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="rfc-3274-compressed-data-content-type-for-cryptographic-message-syntax-cms-rfc3274">
<section id="section-3.9">
        <h3 id="name-rfc-3274-compressed-data-co">
<a href="#section-3.9" class="section-number selfRef">3.9. </a><a href="#name-rfc-3274-compressed-data-co" class="section-name selfRef">RFC 3274 Compressed Data Content Type for Cryptographic Message Syntax (CMS) <span class="cite xref">[RFC3274]</span></a>
        </h3>
<p id="section-3.9-1">This RFC defines a mechanism for compressing data within the Cryptographic Message Syntax (CMS),
   which is the foundation for Secure/Multipurpose Internet Mail Extensions (S/MIME).
   It specifies a CompressedData content type that allows data to be compressed prior to being
   signed or encrypted. This reduces the size of transmitted messages and improves efficiency without
   altering the security services provided by signing or encryption.
   AS2-Version 1.1 incorporated the compression capability described in RFC 3274, enabling trading partners
   to optionally apply compression to message payloads before signing and/or encrypting.
   Most modern AS2 implementations support this feature to reduce bandwidth usage and improve transmission
   performance, particularly for large payloads.<a href="#section-3.9-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="structure-of-an-as2-message">
<section id="section-4">
      <h2 id="name-structure-of-an-as2-message">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-structure-of-an-as2-message" class="section-name selfRef">Structure of an AS2 Message</a>
      </h2>
<div id="introduction-1">
<section id="section-4.1">
        <h3 id="name-introduction-2">
<a href="#section-4.1" class="section-number selfRef">4.1. </a><a href="#name-introduction-2" class="section-name selfRef">Introduction</a>
        </h3>
<p id="section-4.1-1">The basic structure of an AS2 message consists of MIME format inside
   an HTTP message with a few additional specific AS2 headers. The
   structures below are described hierarchically in terms of which RFCs
   are applied to form the specific structure. For details on how to
   code in compliance with all RFCs involved, refer to the specific RFCs.
   Any difference between AS2 implementations and RFCs are mentioned
   specifically in the sections below.<a href="#section-4.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="structure-of-an-internet-edi-mime-message">
<section id="section-4.2">
        <h3 id="name-structure-of-an-internet-ed">
<a href="#section-4.2" class="section-number selfRef">4.2. </a><a href="#name-structure-of-an-internet-ed" class="section-name selfRef">Structure of an Internet EDI MIME Message</a>
        </h3>
<div class="breakable lang-text sourcecode" id="section-4.2-1">
<pre>
   No encryption, no signature, no compression
      - RFC2616/2045
        - RFC1767/RFC3023 (application/EDIxxxx or /xml)

   No encryption, signature, no compression
      - RFC2616/2045
        - RFC1847 (multipart/signed)
          - RFC1767/RFC3023 (application/EDIxxxx or /xml)
          - RFC3851 (application/pkcs7-signature)

   Encryption, no signature, no compression
      - RFC2616/2045
        - RFC3851 (application/pkcs7-mime)
          - RFC1767/RFC3023  (application/EDIxxxx or /xml) (encrypted)

   Encryption, signature, no compression
      - RFC2616/2045
        - RFC3851 (application/pkcs7-mime)
          - RFC1847 (multipart/signed)(encrypted)
            - RFC1767/RFC3023  (application/EDIxxxx or /xml) (encrypted)
            - RFC3851 (application/pkcs7-signature)(encrypted)

   No encryption, no signature (with optional compression)
      - RFC2616/2045
        - RFC3274 (application/pkcs7-mime; CompressedData) [optional]
          - RFC1767/RFC3023 (application/EDIxxxx or /xml)

   No encryption, signature (compression may occur before or after signing)
      - RFC2616/2045
        - [optional RFC3274 (CompressedData) if compress-before-sign]
          - RFC1847 (multipart/signed)
            - [optional RFC3274 (CompressedData) if compress-after-sign]
              - RFC1767/RFC3023 (application/EDIxxxx or /xml)
              - RFC3851 (application/pkcs7-signature)

   Encryption, no signature (with optional compression)
       - RFC2616/2045
         - RFC3851 (application/pkcs7-mime)
           - [optional RFC3274 (CompressedData)]
             - RFC1767/RFC3023 (application/EDIxxxx or /xml) (encrypted)

   Encryption, signature (compression may occur before or after signing)
      - RFC2616/2045
        - RFC3851 (application/pkcs7-mime)
          - [optional RFC3274 (CompressedData) if compress-before-sign]
            - RFC1847 (multipart/signed) (encrypted)
              - [optional RFC3274 (CompressedData) if compress-after-sign]
              - RFC1767/RFC3023 (application/EDIxxxx or /xml) (encrypted)
              - RFC3851 (application/pkcs7-signature) (encrypted)

   MDN over HTTP, no signature
      - RFC2616/2045
        - RFC3798 (message/disposition-notification)

   MDN over HTTP, signature
      - RFC2616/2045
        - RFC1847 (multipart/signed)
         - RFC3798 (message/disposition-notification)
         - RFC3851 (application/pkcs7-signature)
</pre><a href="#section-4.2-1" class="pilcrow">¶</a>
</div>
<p id="section-4.2-2"><strong>Key Notes</strong><a href="#section-4.2-2" class="pilcrow">¶</a></p>
<p id="section-4.2-3">o RFC 3274 (CompressedData) is the normative reference for compression.<a href="#section-4.2-3" class="pilcrow">¶</a></p>
<p id="section-4.2-4">o Compression MAY be combined with signing and/or encryption in either order,
    but the choice affects what the digital signature covers.<a href="#section-4.2-4" class="pilcrow">¶</a></p>
<p id="section-4.2-5">o Many implementations compress before signing and encrypting to maximize size
    reduction, but compression after signing and before encrypting MUST also be supported.<a href="#section-4.2-5" class="pilcrow">¶</a></p>
<p id="section-4.2-6">o Although all MIME content types SHOULD be supported, the following
    MIME content types MUST be supported:<a href="#section-4.2-6" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.2-7">
<pre>
         Content-type: multipart/signed
         Content-Type: multipart/report
         Content-type: message/disposition-notification
         Content-Type: application/PKCS7-signature
         Content-Type: application/PKCS7-mime
         Content-Type: application/EDI-X12
         Content-Type: application/EDIFACT
         Content-Type: application/edi-consent
         Content-Type: application/XML
</pre><a href="#section-4.2-7" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
<div id="http-considerations">
<section id="section-5">
      <h2 id="name-http-considerations">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-http-considerations" class="section-name selfRef">HTTP Considerations</a>
      </h2>
<p id="section-5-1">This specification permits but does not require the use of HTTP/2 or
HTTP/3 as transport protocols. Interoperability testing and
certification are scoped to HTTP/1.1 unless otherwise agreed upon between
trading partners.<a href="#section-5-1" class="pilcrow">¶</a></p>
<div id="sending-edi-in-http-post-requests">
<section id="section-5.1">
        <h3 id="name-sending-edi-in-http-post-re">
<a href="#section-5.1" class="section-number selfRef">5.1. </a><a href="#name-sending-edi-in-http-post-re" class="section-name selfRef">Sending EDI in HTTP POST Requests</a>
        </h3>
<p id="section-5.1-1">The request line will have the form: "POST Request-URI HTTP/1.1",
   with spaces and followed by a CRLF. The Request URI is typically
   exchanged out of band, as part of setting up a bilateral trading
   partner agreement. Applications SHOULD be prepared to deal with an
   initial reply containing a status indicating a need for
   authentication of the usual types used for authorizing access to the
   Request-URI (<span>[<a href="#RFC2616" class="cite xref">RFC2616</a>]</span>, Section 10.4.2 and elsewhere).<a href="#section-5.1-1" class="pilcrow">¶</a></p>
<p id="section-5.1-2">The request line is followed by entity headers specifying content
   length (<span>[<a href="#RFC2616" class="cite xref">RFC2616</a>]</span>, Section 14.14) and content type (<span>[<a href="#RFC2616" class="cite xref">RFC2616</a>]</span>, Section 14.18).
   The Host request header (<span>[<a href="#RFC2616" class="cite xref">RFC2616</a>]</span>, Sections 9 and 14.23) is also included.<a href="#section-5.1-2" class="pilcrow">¶</a></p>
<p id="section-5.1-3">When using Transport Layer Security (TLS), the request-URI MUST
   indicate the appropriate scheme value, HTTPS. Implementations MUST
   support TLS 1.2 or higher and SHOULD follow the guidance in <a href="#https-tls-reqs" class="internal xref">Section 10.1</a>.
   Encrypted message bodies MAY be used in addition to TLS when required
   by business policy.<a href="#section-5.1-3" class="pilcrow">¶</a></p>
<p id="section-5.1-4">The receiving AS2 system MAY disconnect from the sending AS2 system
   before completing the reception of the entire entity if it determines
   that the entity being sent is too large to process.<a href="#section-5.1-4" class="pilcrow">¶</a></p>
<p id="section-5.1-5">For HTTP version 1.1, TCP persistent connections are the default,
   (<span>[<a href="#RFC2616" class="cite xref">RFC2616</a>]</span> Sections 8.1.2, 8.2, and 19.7.1). A number of other differences
   exist because HTTP does not conform to MIME <span>[<a href="#RFC2616" class="cite xref">RFC2616</a>]</span> as used in SMTP
   transport.  Relevant differences are summarized below.<a href="#section-5.1-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="unused-mime-headers-and-operations">
<section id="section-5.2">
        <h3 id="name-unused-mime-headers-and-ope">
<a href="#section-5.2" class="section-number selfRef">5.2. </a><a href="#name-unused-mime-headers-and-ope" class="section-name selfRef">Unused MIME Headers and Operations</a>
        </h3>
<div id="content-transfer-encoding-not-used-in-http-transport">
<section id="section-5.2.1">
          <h4 id="name-content-transfer-encoding-n">
<a href="#section-5.2.1" class="section-number selfRef">5.2.1. </a><a href="#name-content-transfer-encoding-n" class="section-name selfRef">Content-Transfer-Encoding Not Used in HTTP Transport</a>
          </h4>
<p id="section-5.2.1-1">HTTP can handle binary data and so there is no need to use the
   content transfer encodings of MIME <span>[<a href="#RFC2616" class="cite xref">RFC2616</a>]</span>. This difference is discussed
   in <span>[<a href="#RFC2616" class="cite xref">RFC2616</a>]</span>, Section 19.4.5. However, a content transfer encoding value
   of binary or 8-bit is permissible but not required. The absence of
   this header MUST NOT result in transaction failure. Content transfer
   encoding of MIME bodyparts within the AS2 message body is also
   allowed.<a href="#section-5.2.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="message-bodies">
<section id="section-5.2.2">
          <h4 id="name-message-bodies">
<a href="#section-5.2.2" class="section-number selfRef">5.2.2. </a><a href="#name-message-bodies" class="section-name selfRef">Message Bodies</a>
          </h4>
<p id="section-5.2.2-1">In <span>[<a href="#RFC2616" class="cite xref">RFC2616</a>]</span>, Section 3.7.2, it is explicitly noted that multiparts MUST
   have null epilogues.<a href="#section-5.2.2-1" class="pilcrow">¶</a></p>
<p id="section-5.2.2-2">For HTTP transport, large files SHOULD be handled correctly by the TCP layer.
   In addition, <span>[<a href="#RFC2616" class="cite xref">RFC2616</a>]</span>, Sections 3.5 and 3.6 describe options for compressing or
   chunking entities to be transferred, and Section 8.1.2.2 describes a pipelining
   option that is useful for segmenting large amounts of data.
   These clarifications are consistent with existing AS2 practice and maintain full
   backward compatibility (see <a href="#backward-compatibility-and-interoperability" class="internal xref">Section 1.2</a>).<a href="#section-5.2.2-2" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="modification-of-mime-or-other-headers-or-parameters-used">
<section id="section-5.3">
        <h3 id="name-modification-of-mime-or-oth">
<a href="#section-5.3" class="section-number selfRef">5.3. </a><a href="#name-modification-of-mime-or-oth" class="section-name selfRef">Modification of MIME or Other Headers or Parameters Used</a>
        </h3>
<div id="content-length">
<section id="section-5.3.1">
          <h4 id="name-content-length">
<a href="#section-5.3.1" class="section-number selfRef">5.3.1. </a><a href="#name-content-length" class="section-name selfRef">Content-Length</a>
          </h4>
<p id="section-5.3.1-1">The use of the content-length header MUST follow the guidelines of
   <span>[<a href="#RFC2616" class="cite xref">RFC2616</a>]</span>, specifically Sections 4.4 and 14.13.<a href="#section-5.3.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="final-recipient-and-original-recipient">
<section id="section-5.3.2">
          <h4 id="name-final-recipient-and-origina">
<a href="#section-5.3.2" class="section-number selfRef">5.3.2. </a><a href="#name-final-recipient-and-origina" class="section-name selfRef">Final Recipient and Original Recipient</a>
          </h4>
<p id="section-5.3.2-1">The final and original recipient values SHOULD be the same value.
   These values MUST NOT be aliases or mailing lists.<a href="#section-5.3.2-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="message-id-and-original-message-id">
<section id="section-5.3.3">
          <h4 id="name-message-id-and-original-mes">
<a href="#section-5.3.3" class="section-number selfRef">5.3.3. </a><a href="#name-message-id-and-original-mes" class="section-name selfRef">Message-Id and Original-Message-Id</a>
          </h4>
<p id="section-5.3.3-1">The <code>Message-Id</code> and <code>Original-Message-Id</code> headers identify a message
   uniquely and are formatted as defined in <span>[<a href="#RFC5322" class="cite xref">RFC5322</a>]</span>, Section 3.6.4:<a href="#section-5.3.3-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-5.3.3-2">
<pre>
      "&lt;" id-left "@" id-right "&gt;"
</pre><a href="#section-5.3.3-2" class="pilcrow">¶</a>
</div>
<p id="section-5.3.3-3">The length of a <code>Message-Id</code> value MUST NOT exceed 998 characters.
   For maximum interoperability, the length SHOULD be 255 characters or less.<a href="#section-5.3.3-3" class="pilcrow">¶</a></p>
<p id="section-5.3.3-4">The <code>Message-Id</code> value MUST be globally unique, and the <code>id-right</code>
   portion SHOULD be something unique to the sending host environment
   (for example, a fully qualified domain name).<a href="#section-5.3.3-4" class="pilcrow">¶</a></p>
<p id="section-5.3.3-5">Implementations that generate <code>Message-Id</code> values MUST NOT include
   spaces or control characters. Implementations SHOULD remove spaces
   rather than substitute another character when constructing identifiers
   from other message attributes such as <code>AS2-From</code> or <code>AS2-To</code>.<a href="#section-5.3.3-5" class="pilcrow">¶</a></p>
<p id="section-5.3.3-6">Receivers are not required to accept malformed identifiers. If a
   message is received with a <code>Message-Id</code> that contains spaces or
   control characters, the implementation SHOULD treat it as
   syntactically invalid and SHOULD return an MDN with a disposition of
   <code>processed/error</code> and a human-readable explanation such as
   "invalid-message-id" (see <span>[<a href="#RFC8098" class="cite xref">RFC8098</a>]</span>). If an implementation chooses
   to proceed despite the malformed identifier, it MUST NOT propagate or
   generate a new message using that malformed value.<a href="#section-5.3.3-6" class="pilcrow">¶</a></p>
<p id="section-5.3.3-7">When sending a message, the <code>Message-Id</code> field value MUST be enclosed
   in angle brackets (“&lt;” and “&gt;”). The brackets are not part of the
   actual identifier value. For backward compatibility, receiving
   implementations SHOULD NOT reject a message that omits angle brackets.<a href="#section-5.3.3-7" class="pilcrow">¶</a></p>
<p id="section-5.3.3-8">When creating the <code>Original-Message-Id</code> header in an MDN, always use
   the exact syntax as received on the original message; do not strip or
   add angle brackets.<a href="#section-5.3.3-8" class="pilcrow">¶</a></p>
<p id="section-5.3.3-9">See <span>[<a href="#RFC5322" class="cite xref">RFC5322</a>]</span>, Section 3.6.4.<a href="#section-5.3.3-9" class="pilcrow">¶</a></p>
</section>
</div>
<div id="host-header">
<section id="section-5.3.4">
          <h4 id="name-host-header">
<a href="#section-5.3.4" class="section-number selfRef">5.3.4. </a><a href="#name-host-header" class="section-name selfRef">Host Header</a>
          </h4>
<p id="section-5.3.4-1">The host request header field MUST be included in the POST request
   made when sending business data. This field is intended to allow one
   server IP address to service multiple hostnames, and potentially to
   conserve IP addresses. See <span>[<a href="#RFC2616" class="cite xref">RFC2616</a>]</span>, Sections 14.23 and 19.5.1.<a href="#section-5.3.4-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="http-response-status-codes">
<section id="section-5.4">
        <h3 id="name-http-response-status-codes">
<a href="#section-5.4" class="section-number selfRef">5.4. </a><a href="#name-http-response-status-codes" class="section-name selfRef">HTTP Response Status Codes</a>
        </h3>
<p id="section-5.4-1">Implementations MUST use standard HTTP response codes to signal the
   outcome of the message transfer.  The meaning of the HTTP status code is
   limited to the success or failure of the transport operation itself,
   not the semantic processing of the AS2 message content. For
   example, the status code 401, together with the WWW-Authenticate
   header, is used to challenge the client to repeat the request with an
   Authorization header. Other explicit status codes are documented in
   <span>[<a href="#RFC2616" class="cite xref">RFC2616</a>]</span>, Section 6.1.1 and throughout Section 10.<a href="#section-5.4-1" class="pilcrow">¶</a></p>
<p id="section-5.4-2">Receiving implementations MAY send an interim 102 (Processing)
   response <span>[<a href="#RFC4918" class="cite xref">RFC4918</a>]</span> under HTTP/1.1 to indicate that the inbound
   message has been fully received and that processing is underway. The
   102 response can help prevent sender-side network timeouts for large
   synchronous transfers by signaling progress while decryption,
   signature verification, or storage continues.<a href="#section-5.4-2" class="pilcrow">¶</a></p>
<p id="section-5.4-3">Use of 102 (Processing) is OPTIONAL.  It has been deprecated in later
   HTTP specifications and <strong>MUST NOT</strong> be used with HTTP/2 or HTTP/3,
   where interim responses have different semantics.  Implementations
   Implementations that do not receive a 102 response MUST NOT assume that
   a failure has occurred solely because no interim status was returned.
   They SHOULD continue waiting for the final status response for at least
   the duration of their configured HTTP read timeout or any timeout agreed
   upon between trading partners.<a href="#section-5.4-3" class="pilcrow">¶</a></p>
<p id="section-5.4-4">To minimize the risk of network timeouts during lengthy message
   processing, receivers SHOULD return an appropriate transfer-layer
   response as quickly as possible after receiving the full message
   content. For asynchronous message exchanges, the preferred response is
   <code>204 No Content</code>, which indicates that the message has been received
   successfully and that an asynchronous MDN will follow once processing has
   completed. This convention is maintained for interoperability with
   existing AS2 products and certification profiles.<a href="#section-5.4-4" class="pilcrow">¶</a></p>
<p id="section-5.4-5">Some implementations MAY instead use <code>202 Accepted</code> to indicate
   successful receipt and deferred processing; however, <code>204 No Content</code>
   remains the recommended and most widely deployed response for asynchronous workflows.<a href="#section-5.4-5" class="pilcrow">¶</a></p>
<p id="section-5.4-6">Implementations MAY close the connection immediately after sending this
   response if persistent connections are not required by configuration.<a href="#section-5.4-6" class="pilcrow">¶</a></p>
<p id="section-5.4-7">After processing completes, the receiver MUST return a final HTTP
   status code indicating the success or failure of the message transfer.
   The sender MUST use this final response to determine whether retry is appropriate.<a href="#section-5.4-7" class="pilcrow">¶</a></p>
<p id="section-5.4-8">Retry <strong>MUST NOT</strong> be attempted when:<a href="#section-5.4-8" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-5.4-9">
<pre>
 o the final HTTP response indicates successful receipt (e.g., `200 OK` or
   `204 No Content` for asynchronous transfers, or `202 Accepted` for
   implementations that use deferred processing semantics) **and** a
   valid MDN has been received confirming the message disposition; or
 o a permanent-failure status code is returned (4xx other than 408), or
</pre><a href="#section-5.4-9" class="pilcrow">¶</a>
</div>
<p id="section-5.4-10">Retry <strong>MAY</strong> be attempted when:<a href="#section-5.4-10" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-5.4-11">
<pre>
 o the HTTP connection fails before the final status is received,
 o a transient error such as 408 (Request Timeout) or 5xx (Server Error)
   occurs, or
 o no response is received within the configured timeout.
</pre><a href="#section-5.4-11" class="pilcrow">¶</a>
</div>
<p id="section-5.4-12">Implementations SHOULD refer to Section 5.5 for additional guidance on
   retry logic, back-off behavior, and use of partial-transfer recovery.
   The 102 (Processing) status code, if used, MUST NOT be treated as a
   trigger for retry.<a href="#section-5.4-12" class="pilcrow">¶</a></p>
</section>
</div>
<div id="http-error-recovery-and-reliability">
<section id="section-5.5">
        <h3 id="name-http-error-recovery-and-rel">
<a href="#section-5.5" class="section-number selfRef">5.5. </a><a href="#name-http-error-recovery-and-rel" class="section-name selfRef">HTTP Error Recovery and Reliability</a>
        </h3>
<p id="section-5.5-1">When an AS2 message transfer fails due to a transient transport-layer
   condition (for example, an HTTP 408 Request Timeout, 425 Too Early,
   500 Internal Server Error, 503 Service Unavailable or network interruption
   before the final response), the sending system SHOULD attempt an automatic retry.<a href="#section-5.5-1" class="pilcrow">¶</a></p>
<p id="section-5.5-2">Each retry attempt MUST reuse the same Message-ID value so that the
   receiving system can identify duplicate transmissions and prevent
   double-processing.  A receiving system detecting a duplicate
   Message-ID MUST NOT treat the message as new and SHOULD return the
   previously generated MDN, if available.<a href="#section-5.5-2" class="pilcrow">¶</a></p>
<p id="section-5.5-3">Implementations SHOULD permit configuration of retry behavior rather
   than enforcing fixed intervals or limits.  The following guidelines
   are RECOMMENDED but not required:<a href="#section-5.5-3" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-5.5-4">
<pre>
 o **Retry intervals** SHOULD increase exponentially (e.g., 5 min,
   10 min, 20 min, 40 min, …) to reduce congestion.
 o **Retry duration** SHOULD be configurable based on business
   requirements; some environments may continue for several days, while
   others may terminate after one or two attempts.
 o **Maximum attempts** SHOULD be limited to prevent indefinite
   retries when persistent errors occur.
</pre><a href="#section-5.5-4" class="pilcrow">¶</a>
</div>
<p id="section-5.5-5">Implementations SHOULD NOT retry when:<a href="#section-5.5-5" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-5.5-6">
<pre>
 o A final 2xx response and/or valid MDN has been received;
 o The HTTP response indicates a permanent failure (e.g., 400, 401,
   403, 404);
 o The partner has explicitly rejected the message by sending a signed
   MDN with a "failed" disposition.
</pre><a href="#section-5.5-6" class="pilcrow">¶</a>
</div>
<p id="section-5.5-7">The HTTP 102 (Processing) interim status MAY be used under
   HTTP/1.1 to indicate progress on long-running synchronous operations.
   It MUST NOT be used as a signal to initiate or suppress retries.
   Implementations MUST ignore 102 responses when determining whether a
   retry is required.  The 102 response MUST NOT be used with HTTP/2 or
   HTTP/3.<a href="#section-5.5-7" class="pilcrow">¶</a></p>
<p id="section-5.5-8">Implementations MAY also support <strong>AS2 Restart</strong>, which allows a
   partially uploaded message to resume from the point of interruption
   rather than retransmitting the entire payload.  This optional feature
   is defined in <span>[<a href="#I-D.draft-harding-as2-restart-02" class="cite xref">I-D.draft-harding-as2-restart-02</a>]</span>.  Implementations supporting
   Restart MUST ensure message integrity through signature or checksum
   validation of all resumed segments.<a href="#section-5.5-8" class="pilcrow">¶</a></p>
<p id="section-5.5-9">Additional guidance for retry management, error classification, and
   duplicate detection is described in <span>[<a href="#I-D.draft-duker-as2-reliability-16" class="cite xref">I-D.draft-duker-as2-reliability-16</a>]</span>.
   While both of these drafts are expired, they remain widely referenced
   in AS2 interoperability testing and provide a useful operational baseline
   for error-recovery behavior.<a href="#section-5.5-9" class="pilcrow">¶</a></p>
<p id="section-5.5-10">The objective of error recovery is reliability, not speed.  Systems
   SHOULD favor successful delivery over strict timing, provided that
   duplicate protection and security requirements are preserved.<a href="#section-5.5-10" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="additional-as2-specific-http-headers">
<section id="section-6">
      <h2 id="name-additional-as2-specific-htt">
<a href="#section-6" class="section-number selfRef">6. </a><a href="#name-additional-as2-specific-htt" class="section-name selfRef">Additional AS2-Specific HTTP Headers</a>
      </h2>
<p id="section-6-1">The following headers are to be included in all AS2 messages and all
AS2 MDNs. <span>[<a href="#RFC3335" class="cite xref">RFC3335</a>]</span>.<a href="#section-6-1" class="pilcrow">¶</a></p>
<div id="as2-version-header">
<section id="section-6.1">
        <h3 id="name-as2-version-header">
<a href="#section-6.1" class="section-number selfRef">6.1. </a><a href="#name-as2-version-header" class="section-name selfRef">AS2 Version Header</a>
        </h3>
<p id="section-6.1-1">To promote backward compatibility, AS2 includes a version header. The
   major version digit indicates wire-level compatibility; minor version
   digits designate feature sets, clarifications, or extensions that
   remain compatible within the same major version. Thus, all values in
   the "1.x" range are compatible with AS2-Version 1.0, while a future
   "2.0" would indicate a non-backward-compatible revision.<a href="#section-6.1-1" class="pilcrow">¶</a></p>
<p id="section-6.1-2">Receiving systems MUST NOT fail due to the absence of the AS2-Version
   header. Its absence MUST be assumed to be equivalent to the default
   AS2-Version value of 1.0.<a href="#section-6.1-2" class="pilcrow">¶</a></p>
<div class="lang-text sourcecode" id="section-6.1-3">
<pre>
   AS2-Version: 1.0  - All implementations of this specification MUST support and
                       advertise "AS2-Version: 1.0". Versions in the range "1.0"
                       through "1.9" MAY be used. All implementations MUST interpret
                       any value in that range as conforming to this specification,
                       with no differences in baseline behavior. In other words, only
                       the major version digit ("1") defines compatibility for implementations
                       that do not support additional, non-AS2-specified functionality.

                       Implementations MAY use "1.1" through "1.9" to signal extensions of
                       this specification. Any such extensions MUST be fully transparent to
                       implementations that recognize only "AS2-Version: 1.0".

   AS2-Version: 1.1  - Designates those implementations that MUST support compression as
                       defined by RFC 3274.

   AS2-Version: 1.2  - Indicates those implementations that include an EDIINT-Features header
                       as defined in RFC 6017. The values in an EDIINT-Features header specify
                       the features supported by the AS2 implementation. Examples may include
                       CEM, AS2-Reliability and multiple-attachments, however others may also be included.
                       A receiving implementation MUST NOT fail if it does not support or understand
                       any of the supported values contained within an EDIINT-Features header.

   AS2-Version: 1.3  - Indicates those implementations that support the modernization defined
                       by this specification, including updated algorithm requirements (e.g.,
                       SHA-256 for MIC/signatures; AES as the encryption baseline per [RFC8551]),
                       alignment with MDN handling as specified in [RFC8098], and support for
                       multiple-recipient encryption as described in [Section 7.2](#encryption-algorithms){:format="none"}
                       of this specification.

                       When both partners are configured for AS2 version 1.3, weak algorithms (e.g., SHA-1,
                       3DES, RC2, MD5) MUST NOT be generated by conformant implementations. When interoperating
                       with a legacy partner that operates at AS2 version 1.2 or lower, implementations MAY apply
                       the legacy interoperability clarifications described in Appendix B (non-normative).

                       Future minor versions (1.x) may designate additional extensions or clarifications
                       that remain backward-compatible with AS2 version 1.0. A major version update
                       (2.0 or higher) would indicate a non-backward-compatible revision.
</pre><a href="#section-6.1-3" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="as2-product-header">
<section id="section-6.2">
        <h3 id="name-as2-product-header">
<a href="#section-6.2" class="section-number selfRef">6.2. </a><a href="#name-as2-product-header" class="section-name selfRef">AS2 Product header</a>
        </h3>
<p id="section-6.2-1">The <code>AS2-Product</code> header value identifies the AS2 product and version
   used by the sender.  This information enables interoperability testing,
   certification, and troubleshooting by allowing trading partners to
   detect known product-specific behaviors or version-related quirks.<a href="#section-6.2-1" class="pilcrow">¶</a></p>
<p id="section-6.2-2">The <code>AS2-Product</code> header value is OPTIONAL for AS2-Version 1.x systems
   but MUST be included in messages generated by implementations
   declaring <strong>AS2-Version: 1.3 or 2.0</strong> (or later).<a href="#section-6.2-2" class="pilcrow">¶</a></p>
<p id="section-6.2-3">The header field value MUST follow the format:<a href="#section-6.2-3" class="pilcrow">¶</a></p>
<div class="lang-text sourcecode" id="section-6.2-4">
<pre>
     * &lt;product-name&gt;: lowercase alphanumeric and hyphen characters (a–z,
        0–9, "-") without spaces.
     * &lt;major.minor[.patch]&gt;: version string consistent with the product’s
        release version, with one or more numeric components separated by dots.

   Examples:

      AS2-Product: biztalk:2025.1
      AS2-Product: drummond-connect:4.2.3
</pre><a href="#section-6.2-4" class="pilcrow">¶</a>
</div>
<p id="section-6.2-5">Implementations <strong>MUST NOT</strong> use arbitrary identifiers or vendor aliases
   that do not reflect the actual product in use.  The value is static and
   determined at build time.  If a product supports multiple AS2 variants,
   the version portion MAY include an implementation-specific suffix
   (e.g., "1.2-drummond").<a href="#section-6.2-5" class="pilcrow">¶</a></p>
<p id="section-6.2-6">Implementations MAY use the <code>AS2-Product</code> value for automated
   interoperability tuning or to apply compatibility workarounds for known
   product versions.  However, this field is not intended for
   feature-negotiation purposes; supported feature tokens belong in the
   <code>EDIINT-Features</code> header.<a href="#section-6.2-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="as2-system-identifiers">
<section id="section-6.3">
        <h3 id="name-as2-system-identifiers">
<a href="#section-6.3" class="section-number selfRef">6.3. </a><a href="#name-as2-system-identifiers" class="section-name selfRef">AS2 System Identifiers</a>
        </h3>
<p id="section-6.3-1">To aid the receiving system in identifying the sending system,
   AS2-From and AS2-To headers are used.<a href="#section-6.3-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-6.3-2">
<pre>
      AS2-From: &lt; AS2-name &gt;
      AS2-To: &lt; AS2-name &gt;
</pre><a href="#section-6.3-2" class="pilcrow">¶</a>
</div>
<p id="section-6.3-3">These AS2 headers contain textual values, as described below,
   identifying the sender/receiver of a data exchange. Their values may
   be company specific, such as Data Universal Numbering System (DUNS)
   numbers, or they may be simply identification strings agreed upon
   between the trading partners.<a href="#section-6.3-3" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-6.3-4">
<pre>
  AS2-text = "!" /           ; printable ASCII characters
             %d35-91 /       ; except double-quote (%d34)
             %d93-126        ; or backslash (%d92)

  AS2-qtext = AS2-text / SP  ; allow space only in quoted text

  AS2-quoted-pair = "\" DQUOTE /  ; \" or
                    "\" "\"       ; \\

  AS2-quoted-name = DQUOTE 1*128( AS2-qtext /
                                  AS2-quoted-pair) DQUOTE

  AS2-atomic-name = 1*128AS2-text

  AS2-name = AS2-atomic-name / AS2-quoted-name
</pre><a href="#section-6.3-4" class="pilcrow">¶</a>
</div>
<p id="section-6.3-5">The AS2-From header value and the AS2-To header value:<a href="#section-6.3-5" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-6.3-6">
<pre>
 o  MUST each be an AS2-name,
 o  MUST each be comprised of from 1 to 128 printable ASCII characters, and
 o  MUST NOT be folded
 o  The value in each of these headers is **case-sensitive**.
</pre><a href="#section-6.3-6" class="pilcrow">¶</a>
</div>
<p id="section-6.3-7">The string definitions given above are in ABNF format <span>[<a href="#RFC2234" class="cite xref">RFC2234</a>]</span>.<a href="#section-6.3-7" class="pilcrow">¶</a></p>
<p id="section-6.3-8">The AS2-quoted-name SHOULD be used only if the AS2-name does not
   conform to AS2-atomic-name. This explicitly includes situations where
   embedded spaces are part of the AS2-name.<a href="#section-6.3-8" class="pilcrow">¶</a></p>
<p id="section-6.3-9">The AS2-To and AS2-From header fields MUST be present in all AS2
   messages and AS2 MDNs whether they are synchronous or asynchronous in nature.<a href="#section-6.3-9" class="pilcrow">¶</a></p>
<p id="section-6.3-10">The AS2-name for the AS2-To header in a response or MDN MUST match
   the AS2-name of the AS2-From header in the corresponding request
   message. Likewise, the AS2-name for the AS2-From header in a
   response or MDN MUST match the AS2-name of the AS2-To header in the
   corresponding AS2 request message.<a href="#section-6.3-10" class="pilcrow">¶</a></p>
<p id="section-6.3-11">The sending system may choose to limit the possible AS2-To/AS2-From
   textual values but MUST not exceed them. The receiving system MUST
   make no restrictions on the textual values and SHOULD handle all
   possible implementations. However, implementers must be aware that
   older AS2 products may not adhere to this convention. Trading
   partner agreements should be made to ensure that older products can
   support the system identifiers that are used.<a href="#section-6.3-11" class="pilcrow">¶</a></p>
<p id="section-6.3-12">There is no required response to a client request containing invalid
   or unknown AS2-From or AS2-To header values. The receiving AS2
   system MAY return an unsigned MDN with an explanation of the error,
   such as an MDN error disposition value of "unknown-trading-relationship",
   if the sending system requested an MDN.<a href="#section-6.3-12" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="algorithm-requirements">
<section id="section-7">
      <h2 id="name-algorithm-requirements">
<a href="#section-7" class="section-number selfRef">7. </a><a href="#name-algorithm-requirements" class="section-name selfRef">Algorithm Requirements</a>
      </h2>
<p id="section-7-1">This section defines the normative requirements for cryptographic
   algorithms used in AS2. These requirements apply to all conformant
   implementations. Guidance on interoperability with legacy AS2 systems
   that continue to use older algorithms is provided separately in
   Appendix B.<a href="#section-7-1" class="pilcrow">¶</a></p>
<div id="hash-algorithms">
<section id="section-7.1">
        <h3 id="name-hash-algorithms">
<a href="#section-7.1" class="section-number selfRef">7.1. </a><a href="#name-hash-algorithms" class="section-name selfRef">Hash Algorithms</a>
        </h3>
<p id="section-7.1-1">Implementations MUST support SHA-256 for message integrity check (MIC)
   calculations and digital signatures. Implementations SHOULD support
   SHA-384 or stronger algorithms. SHA-1 and MD5 are deprecated due to
   known weaknesses and MUST NOT be generated by conformant implementations.<a href="#section-7.1-1" class="pilcrow">¶</a></p>
<p id="section-7.1-2">See Appendix B for clarifications on handling legacy algorithms when
   interoperating with RFC 4130 systems.<a href="#section-7.1-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="encryption-algorithms">
<section id="section-7.2">
        <h3 id="name-encryption-algorithms">
<a href="#section-7.2" class="section-number selfRef">7.2. </a><a href="#name-encryption-algorithms" class="section-name selfRef">Encryption Algorithms</a>
        </h3>
<p id="section-7.2-1">Implementations MUST support AES encryption algorithms as defined in
   S/MIME Version 4.0 <span>[<a href="#RFC8551" class="cite xref">RFC8551</a>]</span>. At a minimum, AES-128-CBC MUST be
   supported, and AES-256-CBC SHOULD be supported. Implementations are
   also RECOMMENDED to support AES-128-GCM and AES-256-GCM. Support for
   AES-CCM is also RECOMMENDED for environments requiring authenticated
   encryption.<a href="#section-7.2-1" class="pilcrow">¶</a></p>
<p id="section-7.2-2">Triple DES (3DES) and RC2 are deprecated and MUST NOT be generated by
   conformant implementations.<a href="#section-7.2-2" class="pilcrow">¶</a></p>
<p id="section-7.2-3">To support recoverable decryption and regulatory requirements,
   implementations SHOULD support multiple-recipient encryption of the
   content-encryption key (CEK), consistent with <span>[<a href="#RFC8551" class="cite xref">RFC8551</a>]</span> Section 3.3.
   A copy of the CEK encrypted for the originator SHOULD also be included in
   the EnvelopedData, and the same principle applies to AuthEnvelopedData
   when using AES-CCM or AES-GCM.<a href="#section-7.2-3" class="pilcrow">¶</a></p>
<p id="section-7.2-4">See Appendix B for guidance on handling 3DES and other weak algorithms
   when interoperating with legacy AS2 systems.<a href="#section-7.2-4" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="structure-and-processing-of-an-mdn-message">
<section id="section-8">
      <h2 id="name-structure-and-processing-of">
<a href="#section-8" class="section-number selfRef">8. </a><a href="#name-structure-and-processing-of" class="section-name selfRef">Structure and Processing of an MDN Message</a>
      </h2>
<p id="section-8-1">This document aligns MDN behavior with RFC 8098, clarifying semantics
for interoperability. It does not redefine the MDN format.
Implementations MUST be able to parse historic MDN forms as described in
RFC 3798 for backward compatibility.<a href="#section-8-1" class="pilcrow">¶</a></p>
<div id="introduction-2">
<section id="section-8.1">
        <h3 id="name-introduction-3">
<a href="#section-8.1" class="section-number selfRef">8.1. </a><a href="#name-introduction-3" class="section-name selfRef">Introduction</a>
        </h3>
<p id="section-8.1-1">In order to support non-repudiation of receipt, a signed receipt,
   based on digitally signing a message disposition notification, is to
   be implemented by a receiving trading partner's UA. The message
   disposition notification, specified by RFC 3798, is digitally signed
   by a receiving trading partner as part of a multipart/signed MIME
   message.<a href="#section-8.1-1" class="pilcrow">¶</a></p>
<p id="section-8.1-2">The requirements in this section update but do not alter the compatibility
   of MDN formats with existing AS2 implementations (see <a href="#backward-compatibility-and-interoperability" class="internal xref">Section 1.2</a>).
   This ensures interoperability with both RFC 3798 and RFC 8098 implementations.<a href="#section-8.1-2" class="pilcrow">¶</a></p>
<p id="section-8.1-3">The following support for signed receipts is REQUIRED:<a href="#section-8.1-3" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-8.1-4">
<pre>
  1. The ability to create a multipart/report; where the
     report-type = disposition-notification.

  2. The ability to calculate a message integrity check (MIC) on the
     received message. The calculated MIC value will be returned to
     the sender of the message inside the signed receipt.

  3. The ability to create a multipart/signed content with the
     message disposition notification as the first body part, and
     the signature as the second body part.

  4. The ability to return the signed receipt to the sending trading
     partner.

  5. The ability to return either a synchronous or an asynchronous
     receipt as the sending party requests.
</pre><a href="#section-8.1-4" class="pilcrow">¶</a>
</div>
<p id="section-8.1-5">The signed receipt is used to notify a sending trading partner that
   requested the signed receipt that:<a href="#section-8.1-5" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-8.1-6">
<pre>
  1. The receiving trading partner acknowledges receipt of the sent
     EC Interchange.

  2. If the sent message was signed, then the receiving trading
     partner has authenticated the sender of the EC Interchange.

  3. If the sent message was signed, then the receiving trading
     partner has verified the integrity of the sent EC Interchange.
</pre><a href="#section-8.1-6" class="pilcrow">¶</a>
</div>
<p id="section-8.1-7">Regardless of whether the EDI/EC Interchange was sent in S/MIME
   format, the receiving trading partner's UA MUST provide the following
   basic processing:<a href="#section-8.1-7" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-8.1-8">
<pre>
  1. If the sent EDI/EC Interchange is encrypted, then the encrypted
     symmetric key and initialization vector (if applicable) is
     decrypted using the receiver's private key.

  2. The decrypted symmetric encryption key is then used to decrypt
     the EDI/EC Interchange.

  3. The receiving trading partner authenticates signatures in a
     message using the sender's public key. The authentication
     algorithm performs the following:

     a. The message integrity check (MIC or Message Digest), is
        decrypted using the sender's public key.

     b. A MIC on the signed contents (the MIME header and encoded
        EDI object, as per RFC 1767) in the message received is
        calculated using the same one-way hash function that the
        sending trading partner used.

     c. The MIC extracted from the message that was sent and the MIC
        calculated using the same one-way hash function that the
        sending trading partner used are compared for equality.

  4. The receiving trading partner formats the MDN and sets the
     calculated MIC into the "Received-content-MIC" extension field.

  5. The receiving trading partner creates a multipart/signed MIME
     message according to RFC 1847.

  6. The MDN is the first part of the multipart/signed message, and
     the digital signature is created over this MDN, including its
     MIME headers.

  7. The second part of the multipart/signed message contains the
     digital signature. The "protocol" option specified in the
     second part of the multipart/signed is as follows:

           S/MIME: protocol = "application/pkcs7-signature"

  8. The signature information is formatted according to S/MIME
     specifications.
</pre><a href="#section-8.1-8" class="pilcrow">¶</a>
</div>
<p id="section-8.1-9">The EC Interchange and the RFC 1767 MIME EDI content header can
   actually be part of a multi-part MIME content-type. When the EDI
   Interchange is part of a multi-part MIME content-type, the MIC MUST
   be calculated across the entire multi-part content, including the
   MIME headers contained within the multi-part MIME content.<a href="#section-8.1-9" class="pilcrow">¶</a></p>
<p id="section-8.1-10">The signed MDN, when received by the sender of the EDI Interchange,
   can be used by the sender as follows:<a href="#section-8.1-10" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-8.1-11">
<pre>
    o  As an acknowledgement that the EDI Interchange sent was
       delivered and acknowledged by the receiving trading partner.
       The receiver does this by returning the original-message-id
       of the sent message in the MDN portion of the signed receipt.

    o  As an acknowledgement that the integrity of the EDI
       Interchange was verified by the receiving trading partner.
       The receiver does this by returning the calculated MIC of the
       received EC Interchange (and 1767 MIME headers) in the
       "Received-content-MIC" field of the signed MDN.

    o  As an acknowledgement that the receiving trading partner has
       authenticated the sender of the EDI Interchange.

    o  As a non-repudiation of receipt when the signed MDN is
       successfully verified by the sender with the receiving
       trading partner's public key and the returned MIC value
       inside the MDN is the same as the digest of the original
       message.
</pre><a href="#section-8.1-11" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="synchronous-and-asynchronous-mdns">
<section id="section-8.2">
        <h3 id="name-synchronous-and-asynchronou">
<a href="#section-8.2" class="section-number selfRef">8.2. </a><a href="#name-synchronous-and-asynchronou" class="section-name selfRef">Synchronous and Asynchronous MDNs</a>
        </h3>
<p id="section-8.2-1">The AS2-MDN exists in two varieties: synchronous and asynchronous.<a href="#section-8.2-1" class="pilcrow">¶</a></p>
<p id="section-8.2-2">The synchronous AS2-MDN is sent as an HTTP response to an HTTP POST
   or as an HTTPS response to an HTTPS POST. This form of AS2-MDN is
   called synchronous because the AS2-MDN is returned to the originator
   of the POST on the same TCP/IP connection.<a href="#section-8.2-2" class="pilcrow">¶</a></p>
<p id="section-8.2-3">The synchronous response MUST indicate transfer-layer success or
   failure, such as <code>200 OK</code> or <code>202 Accepted</code>.  The format of this
   response MAY be identical to that used when no AS2-MDN is requested.<a href="#section-8.2-3" class="pilcrow">¶</a></p>
<p id="section-8.2-4">The asynchronous AS2-MDN is sent on a separate HTTP or HTTPS
   TCP/IP connection. Logically, the asynchronous AS2-MDN is a response
   to an AS2 message. However, at the transfer-protocol layer, assuming
   that no HTTP pipelining is utilized, the asynchronous AS2-MDN is
   delivered on a unique TCP/IP connection, distinct from that used to
   deliver the original AS2 message.<a href="#section-8.2-4" class="pilcrow">¶</a></p>
<p id="section-8.2-5">When handling an asynchronous request, the receiving system <strong>SHOULD</strong>
   return a transfer-layer response (typically <code>202 Accepted</code> or <code>204 No Content</code>)
   as soon as the last byte of the inbound message has been received, without waiting
   for decryption, signature verification, or message persistence.  This
   minimizes the risk of network timeouts and ensures that the sender can
   begin awaiting the asynchronous MDN promptly. The asynchronous MDN MUST be
   transmitted as an independent HTTP message, separate from the original
   connection used to submit the AS2 message.<a href="#section-8.2-5" class="pilcrow">¶</a></p>
<p id="section-8.2-6">Implementations <strong>MAY</strong> use persistent (keep-alive) HTTP connections.
   Closing the TCP connection immediately after sending the response is
   <strong>RECOMMENDED</strong> for simplicity, but not required.  Some application
   servers and frameworks manage connection lifecycles automatically and
   may keep the socket open.  The AS2 specification does not mandate that
   the AS2 layer explicitly close the connection.<a href="#section-8.2-6" class="pilcrow">¶</a></p>
<p id="section-8.2-7">The following diagram illustrates the synchronous versus asynchronous
   varieties of AS2-MDN delivery using HTTP:<a href="#section-8.2-7" class="pilcrow">¶</a></p>
<div class="lang-text sourcecode" id="section-8.2-8">
<pre>
   Synchronous AS2-MDN

   {Peer1} ----( connect )----&gt; {Peer2}
   {Peer1} -----( send )------&gt; {Peer2}   HTTP Request {AS2-Message}
   {Peer1} &lt;---( receive )----- {Peer2}   HTTP Response {AS2-MDN}

   Asynchronous AS2-MDN

   {Peer1} ----( connect )----&gt; {Peer2}
   {Peer1} -----( send )------&gt; {Peer2}   HTTP Request {AS2-Message}
   {Peer1} &lt;---( receive )----- {Peer2}   HTTP Response (e.g., "200 OK" or "204 No Content")
   {Peer1}*&lt;---( connect )----- {Peer2}
   {Peer1} &lt;--- ( send )------- {Peer2}   HTTP Request {AS2-MDN}
   {Peer1} ----( receive )----&gt; {Peer2}   HTTP Response
</pre><a href="#section-8.2-8" class="pilcrow">¶</a>
</div>
<ul class="normal">
<li class="normal" id="section-8.2-9.1">
            <p id="section-8.2-9.1.1">Note: An AS2-MDN may be directed to a host different from that of
   the sender of the AS2 message. It may also utilize a transfer protocol
   different from that used to send the original AS2 message.<a href="#section-8.2-9.1.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-8.2-10">The advantage of the synchronous MDN is that it provides the
   sender of the AS2 message with a verifiable confirmation of
   delivery within a single synchronous logic flow. However, if the
   message is large, the time required to process it and return the
   AS2-MDN on the same connection may exceed the maximum configured
   time permitted for maintaining an open connection.<a href="#section-8.2-10" class="pilcrow">¶</a></p>
<p id="section-8.2-11">The advantage of the asynchronous MDN is that it provides for the
   rapid return of a transfer-layer acknowledgment from the receiver,
   confirming receipt of data, while allowing full processing to occur
   later. This reduces connection duration and timeout risk.  However,
   the asynchronous AS2-MDN MUST include sufficient identifying
   information (for example, <code>Original-Message-ID</code> and <code>Final-Recipient</code>)
   so that the message originator can correlate the MDN with its original
   message and update the processing status accordingly.<a href="#section-8.2-11" class="pilcrow">¶</a></p>
<p id="section-8.2-12">Synchronous and asynchronous HTTP or HTTPS MDNs are both valid under
   this specification.  Implementations MUST support receiving both
   types and SHOULD support sending both.<a href="#section-8.2-12" class="pilcrow">¶</a></p>
</section>
</div>
<div id="requesting-a-signed-receipt">
<section id="section-8.3">
        <h3 id="name-requesting-a-signed-receipt">
<a href="#section-8.3" class="section-number selfRef">8.3. </a><a href="#name-requesting-a-signed-receipt" class="section-name selfRef">Requesting a Signed Receipt</a>
        </h3>
<p id="section-8.3-1">Message disposition notifications are requested as per RFC 3798. A
   request that the receiving user agent issue a message disposition
   notification is made by placing the following header into the message
   to be sent:<a href="#section-8.3-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-8.3-2">
<pre>
    MDN-request-header = "Disposition-notification-to"
                        ":"  mail-address
</pre><a href="#section-8.3-2" class="pilcrow">¶</a>
</div>
<p id="section-8.3-3">The following example is for requesting an MDN:<a href="#section-8.3-3" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-8.3-4">
<pre>
    Disposition-notification-to: xxx@example.com
</pre><a href="#section-8.3-4" class="pilcrow">¶</a>
</div>
<p id="section-8.3-5">The "Disposition-notification-to" header field is retained for compatibility
   with the MDN specification <span>[<a href="#RFC3798" class="cite xref">RFC3798</a>]</span>, but its value is not used by AS2 implementations
   to determine where to return the MDN. Its presence just indicates that an MDN receipt is
   to be returned to the originator. In AS2, the field value may be an email address, a URL,
   a fully qualified domain name, an AS2 identifier, or any other implementation-specific string.
   Implementations MUST NOT reject a message based on the syntax of this field. This document
   relaxes the original requirement from RFC 4130, which mandated an email address, in order to
   reflect current AS2 practice while maintaining backward compatibility (see <a href="#backward-compatibility-and-interoperability" class="internal xref">Section 1.2</a>).<a href="#section-8.3-5" class="pilcrow">¶</a></p>
<p id="section-8.3-6">When requesting MDN-based receipts, the originator supplies
   additional extension headers that precede the message body.  These
   header "tags" are as follows:<a href="#section-8.3-6" class="pilcrow">¶</a></p>
<p id="section-8.3-7">A Message-ID header is added to support message reconciliation, so
   that an Original-Message-Id value can be returned in the body part of
   MDN. Other headers, especially "Subject" and "Date", SHOULD be
   supplied; the values of these headers are often mentioned in the
   human-readable section of a MDN to aid in identifying the original
   message.<a href="#section-8.3-7" class="pilcrow">¶</a></p>
<p id="section-8.3-8">MDNs will be returned in the HTTP response when requested, unless an
   asynchronous MDN is requested.<a href="#section-8.3-8" class="pilcrow">¶</a></p>
<p id="section-8.3-9">To request an asynchronous message disposition notification, the
   following header is placed into the message that is sent:<a href="#section-8.3-9" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-8.3-10">
<pre>
    Receipt-Delivery-Option: return-URL
</pre><a href="#section-8.3-10" class="pilcrow">¶</a>
</div>
<p id="section-8.3-11">This is an example requesting that the MDN be asynchronous:<a href="#section-8.3-11" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-8.3-12">
<pre>
    Receipt-Delivery-Option: http://www.example.com/Path
</pre><a href="#section-8.3-12" class="pilcrow">¶</a>
</div>
<p id="section-8.3-13">Receipt-delivery-option syntax allows the return-url to use some schemes
   other than HTTP using the POST method.<a href="#section-8.3-13" class="pilcrow">¶</a></p>
<p id="section-8.3-14">The "receipt-delivery-option: return-url" string indicates the URL to
   use for an asynchronous MDN. This header is NOT present if the
   receipt is to be synchronous. The email value in Disposition-
   notification-to is not used in this specification because it was
   limited to RFC 2822 addresses (now replaced by <span>[<a href="#RFC5322" class="cite xref">RFC5322</a>]</span>); the extension
   header "Receipt-delivery-option" has been introduced to provide a
   URL for the MDN return by several transfer options.<a href="#section-8.3-14" class="pilcrow">¶</a></p>
<p id="section-8.3-15">The receipt-delivery-option's value MUST be a URL indicating the
   delivery transport destination for the receipt.<a href="#section-8.3-15" class="pilcrow">¶</a></p>
<p id="section-8.3-16">An example request for an asynchronous MDN via an HTTP transport:<a href="#section-8.3-16" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-8.3-17">
<pre>
    Receipt-delivery-option: http://www.example.com
</pre><a href="#section-8.3-17" class="pilcrow">¶</a>
</div>
<p id="section-8.3-18">An example request for an asynchronous MDN via an HTTP/S transport:<a href="#section-8.3-18" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-8.3-19">
<pre>
    Receipt-delivery-option: https://www.example.com
</pre><a href="#section-8.3-19" class="pilcrow">¶</a>
</div>
<p id="section-8.3-20">Finally, the header, Disposition-notification-options, identifies
   characteristics of message disposition notification as in <span>[<a href="#RFC3798" class="cite xref">RFC3798</a>]</span>. The
   most important of these options is for indicating the signing options
   for the MDN, as in the following example:<a href="#section-8.3-20" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-8.3-21">
<pre>
    Disposition-notification-options:
         signed-receipt-protocol=optional,pkcs7-signature;
         signed-receipt-micalg=optional,sha-256,sha1
</pre><a href="#section-8.3-21" class="pilcrow">¶</a>
</div>
<p id="section-8.3-22">For signing options, consider the disposition-notification-options
   syntax:<a href="#section-8.3-22" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-8.3-23">
<pre>
    Disposition-notification-options =
             "Disposition-Notification-Options" ":"
              disposition-notification-parameters
where
         disposition-notification-parameters =
                           parameter *(";" parameter)

where
         parameter = attribute "=" importance ", " 1#value"

where
         importance = "required" | "optional"
</pre><a href="#section-8.3-23" class="pilcrow">¶</a>
</div>
<p id="section-8.3-24">So the Disposition-notification-options string could be:<a href="#section-8.3-24" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-8.3-25">
<pre>
    signed-receipt-protocol=optional, &lt;protocol symbol&gt;;
    signed-receipt-micalg=optional, &lt;micalg1&gt;, &lt;micalg2&gt;,...;
</pre><a href="#section-8.3-25" class="pilcrow">¶</a>
</div>
<p id="section-8.3-26">The currently used value for &lt;protocol symbol&gt; is "pkcs7-signature"
   for the S/MIME detached signature format.<a href="#section-8.3-26" class="pilcrow">¶</a></p>
<p id="section-8.3-27">The currently supported values for MIC algorithm &lt;micalg&gt; values are:<a href="#section-8.3-27" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-8.3-28">
<pre>
    Algorithm   Value Used
    ---------    ---------
     SHA-256      sha-256
     SHA-384      sha-384
     SHA-512      sha-512
     SHA-1        sha-1 or sha1 (should *only* be used in legacy deployments that
                                 cannot support SHA-256 or greater)
</pre><a href="#section-8.3-28" class="pilcrow">¶</a>
</div>
<p id="section-8.3-29">The semantics of the "signed-receipt-protocol" and the "signed-receipt-micalg"
   parameters are as follows:<a href="#section-8.3-29" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-8.3-30">
<li id="section-8.3-30.1">
            <p id="section-8.3-30.1.1">The "signed-receipt-protocol" parameter is used to request a
signed receipt from the recipient trading partner. The "signed-receipt-protocol"
parameter also specifies the format in which the signed receipt SHOULD be returned
to the requester.<a href="#section-8.3-30.1.1" class="pilcrow">¶</a></p>
<p id="section-8.3-30.1.2">
The "signed-receipt-micalg" parameter identifies one or more message
integrity check (MIC) algorithms, in order of preference, that the
requester supports for signing the returned receipt. Although multiple
values MAY be listed to indicate fallback options, only a single MIC
algorithm is used in the returned MDN because the "Received-content-MIC"
field conveys exactly one digest value.<a href="#section-8.3-30.1.2" class="pilcrow">¶</a></p>
<p id="section-8.3-30.1.3">
Recipients MUST select the first algorithm in the list that they also
support and MUST compute the Received-content-MIC using that algorithm.
Senders SHOULD list the strongest algorithm first. Modern
implementations SHOULD include only a single value unless multiple
values are needed to support phased migration away from weaker
algorithms. Implementations MUST accept messages that contain multiple
values and MUST ignore unsupported values.<a href="#section-8.3-30.1.3" class="pilcrow">¶</a></p>
<p id="section-8.3-30.1.4">
When a sender lists multiple algorithms, recipients MUST NOT fall back
to an algorithm that is not explicitly listed by the sender.
Trading partners typically pre-configure acceptable MIC algorithms
through bilateral agreement, and runtime negotiation is not needed.
If none of the algorithms listed is supported, the recipient SHOULD
reject the message and MAY return an unsigned MDN indicating
"unsupported-mic-algorithm" rather than silently selecting a weaker
algorithm.  When the header is absent (e.g., unsigned messages), an
implementation MUST use a locally configured default algorithm; SHA-256
SHOULD be preferred, but SHA-1 MAY be used when required for legacy partners.<a href="#section-8.3-30.1.4" class="pilcrow">¶</a></p>
<p id="section-8.3-30.1.5"><strong>The following algorithm requirements apply to all implementations:</strong><a href="#section-8.3-30.1.5" class="pilcrow">¶</a></p>
<p id="section-8.3-30.1.6">
o Implementations <strong>MUST</strong> support SHA-256.<a href="#section-8.3-30.1.6" class="pilcrow">¶</a></p>
<p id="section-8.3-30.1.7">
o Implementations <strong>SHOULD</strong> support SHA-384 or stronger.<a href="#section-8.3-30.1.7" class="pilcrow">¶</a></p>
<p id="section-8.3-30.1.8">
o SHA-1 <strong>MAY</strong> be accepted only when required for interoperability with
    legacy partners and MUST NOT be generated for new deployments once
    both parties support stronger algorithms.<a href="#section-8.3-30.1.8" class="pilcrow">¶</a></p>
<p id="section-8.3-30.1.9">
o MD5 is obsolete and MUST NOT be generated.<a href="#section-8.3-30.1.9" class="pilcrow">¶</a></p>
<p id="section-8.3-30.1.10">
See <a href="#security-considerations" class="internal xref">Section 10</a> for additional algorithm requirements
and deprecation timelines.<a href="#section-8.3-30.1.10" class="pilcrow">¶</a></p>
<p id="section-8.3-30.1.11">
Both the "signed-receipt-protocol" and the "signed-receipt-micalg"
option parameters are REQUIRED when requesting a signed receipt.<a href="#section-8.3-30.1.11" class="pilcrow">¶</a></p>
<p id="section-8.3-30.1.12">
The lack of the presence of the "Receipt-Delivery-Option"
indicates that a receipt is synchronous in nature. The presence
of the "Receipt-Delivery-Option: return-url" indicates that an
asynchronous receipt is requested and SHOULD be sent to the
"return-url".<a href="#section-8.3-30.1.12" class="pilcrow">¶</a></p>
</li>
          <li id="section-8.3-30.2">
            <p id="section-8.3-30.2.1">The "importance" attribute of "Optional" is defined in RFC 3798,
Section 2.2, and has the following meaning:<a href="#section-8.3-30.2.1" class="pilcrow">¶</a></p>
<p id="section-8.3-30.2.2">
Parameters with an importance of "Optional" permit a UA that does
not understand the particular options parameter to still generate
an MDN in response to a request for a MDN.<a href="#section-8.3-30.2.2" class="pilcrow">¶</a></p>
<p id="section-8.3-30.2.3">
A UA that does not understand the "signed-receipt-protocol"
parameter or the "signed-receipt-micalg" will obviously not return
a signed receipt.<a href="#section-8.3-30.2.3" class="pilcrow">¶</a></p>
<p id="section-8.3-30.2.4">
The importance of "Optional" is used for the signed receipt
parameters because it is RECOMMENDED that an MDN be returned to
the requesting trading partner even if the recipient could not
sign it.<a href="#section-8.3-30.2.4" class="pilcrow">¶</a></p>
<p id="section-8.3-30.2.5">
The returned MDN will contain information on the disposition of
the message and on why the MDN could not be signed. See the
Disposition field in <a href="#disposition-mode-type-and-modifier" class="internal xref">Section 8.5</a>
for more information.<a href="#section-8.3-30.2.5" class="pilcrow">¶</a></p>
<p id="section-8.3-30.2.6">
Within an EDI trading relationship, if a signed receipt is
expected and is not returned, then the validity of the transaction
is up to the trading partners to resolve.<a href="#section-8.3-30.2.6" class="pilcrow">¶</a></p>
<p id="section-8.3-30.2.7">
In general, if a signed receipt is required in the trading
relationship and is not received, the transaction will likely
be considered invalid.<a href="#section-8.3-30.2.7" class="pilcrow">¶</a></p>
</li>
        </ol>
<div id="signed-receipt-considerations">
<section id="section-8.3.1">
          <h4 id="name-signed-receipt-consideratio">
<a href="#section-8.3.1" class="section-number selfRef">8.3.1. </a><a href="#name-signed-receipt-consideratio" class="section-name selfRef">Signed Receipt Considerations</a>
          </h4>
<p id="section-8.3.1-1">The method used to request a receipt or a signed receipt is defined
   in RFC 3798, "An Extensible Message Format for Message Disposition
   Notifications".<a href="#section-8.3.1-1" class="pilcrow">¶</a></p>
<p id="section-8.3.1-2">The "rules" are as follows:<a href="#section-8.3.1-2" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-8.3.1-3">
<li id="section-8.3.1-3.1">
              <p id="section-8.3.1-3.1.1">When a receipt is requested, explicitly specifying that the
receipt be signed, then the receipt MUST be returned with a
signature.<a href="#section-8.3.1-3.1.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-8.3.1-3.2">
              <p id="section-8.3.1-3.2.1">When a receipt is requested, explicitly specifying that the
receipt be signed, but the recipient cannot support either the
requested protocol format or the requested MIC algorithms, then
either a signed or unsigned receipt SHOULD be returned.<a href="#section-8.3.1-3.2.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-8.3.1-3.3">
              <p id="section-8.3.1-3.3.1">When a signature is not explicitly requested, or if the signed
receipt request parameter is not recognized by the UA, then no
receipt, an unsigned receipt, or a signed receipt MAY be returned
by the recipient.<a href="#section-8.3.1-3.3.1" class="pilcrow">¶</a></p>
</li>
          </ol>
<p id="section-8.3.1-4">NOTE: For Internet EDI, it is RECOMMENDED that when a signature is
   not explicitly requested, or if parameters are not recognized, the UA
   send back, at a minimum, an unsigned receipt. If, however, a signed
   receipt was always returned as a policy, whether requested or not,
   then any false unsigned receipts can be repudiated.<a href="#section-8.3.1-4" class="pilcrow">¶</a></p>
<p id="section-8.3.1-5">When a request for a signed receipt is made, but there is an error in
   processing the contents of the message, a signed receipt MUST still
   be returned. The request for a signed receipt SHALL still be
   honored, though the transaction itself may not be valid. The reason
   why the contents could not be processed MUST be set in the
   "disposition-field".<a href="#section-8.3.1-5" class="pilcrow">¶</a></p>
<p id="section-8.3.1-6">When a signed receipt request is made, the "Received-content-MIC"
   MUST always be returned to the requester (except when corruption
   prevents computation of the digest in accordance with the following
   specification). The "Received-content-MIC" MUST be calculated as
   follows:<a href="#section-8.3.1-6" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-8.3.1-7">
<pre>
  o  For any signed messages, the MIC to be returned is calculated
     on the RFC1767/RFC3023 MIME header and content.
     Canonicalization on the MIME headers MUST be performed before
     the MIC is calculated, since the sender requesting the signed
     receipt was also REQUIRED to canonicalize.

  o  For encrypted, unsigned messages, the MIC to be returned is
     calculated on the decrypted RFC 1767/RFC3023 MIME header and
     content. The content after decryption MUST be canonicalized
     before the MIC is calculated.

  o  For unsigned, unencrypted messages, the MIC MUST be calculated
     over the message contents without the outer MIME or any other RFC
     5322 headers, since these may sometimes be altered or reordered by
     intermediary user agents or proxies.
</pre><a href="#section-8.3.1-7" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
<div id="mdn-format-and-values">
<section id="section-8.4">
        <h3 id="name-mdn-format-and-values">
<a href="#section-8.4" class="section-number selfRef">8.4. </a><a href="#name-mdn-format-and-values" class="section-name selfRef">MDN Format and Values</a>
        </h3>
<p id="section-8.4-1">This section defines the format of the AS2 Message Disposition
   Notification (AS2-MDN).<a href="#section-8.4-1" class="pilcrow">¶</a></p>
<div id="as2-mdn-general-formats">
<section id="section-8.4.1">
          <h4 id="name-as2-mdn-general-formats">
<a href="#section-8.4.1" class="section-number selfRef">8.4.1. </a><a href="#name-as2-mdn-general-formats" class="section-name selfRef">AS2-MDN General Formats</a>
          </h4>
<div class="lang-abnf sourcecode" id="section-8.4.1-1">
<pre>
AS2-MDN = AS2-sync-MDN | AS2-async-http-MDN

AS2-sync-MDN =
   Status-Line
   *(( general-header | response-header | entity-header )
     CRLF )
   CRLF
   AS2-MDN-body

Status-Line =
   HTTP-Version SP Status-Code SP Reason-Phrase CRLF

AS2-async-http-MDN =
   Request-Line
   *(( general-header | request-header | entity-header )
     CRLF )
   CRLF
   AS2-MDN-body

Request-Line =
   Method SP Request-URI SP HTTP-Version CRLF

AS2-MDN-body =
   AS2-signed-MDN-body | AS2-unsigned-MDN-body
</pre><a href="#section-8.4.1-1" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="as2-mdn-construction">
<section id="section-8.4.2">
          <h4 id="name-as2-mdn-construction">
<a href="#section-8.4.2" class="section-number selfRef">8.4.2. </a><a href="#name-as2-mdn-construction" class="section-name selfRef">AS2-MDN Construction</a>
          </h4>
<p id="section-8.4.2-1">The AS2-MDN-body is formatted as a MIME multipart/report with a
   report-type of "disposition-notification". When the message is
   unsigned, the transfer-layer ("outermost") entity-headers of the
   AS2-MDN contain the content-type header that specifies a content-type
   of "multipart/report" and parameters indicating the report-type, and
   the value of the outermost multipart boundary.<a href="#section-8.4.2-1" class="pilcrow">¶</a></p>
<p id="section-8.4.2-2">When the AS2-MDN is signed, the transfer-layer ("outermost") entity-
   headers of the AS2-MDN contain a content-type header that specifies a
   content-type of "multipart/signed" and parameters indicating the
   algorithm used to compute the message digest, the signature-
   formatting protocol (e.g., pkcs7-signature), and the value of the
   outermost multipart boundary. The first part of the MIME
   multipart/signed message is an embedded MIME multipart/report of type
   "disposition-notification". The second part of the multipart/signed
   message contains a MIME application/pkcs7-signature message.<a href="#section-8.4.2-2" class="pilcrow">¶</a></p>
<p id="section-8.4.2-3">The first part of the MIME multipart/report is a "human-readable"
   portion containing a general description of the message
   disposition. The second part of the MIME multipart/report is a
   "machine-readable" portion that is defined as:<a href="#section-8.4.2-3" class="pilcrow">¶</a></p>
<div class="lang-abnf sourcecode" id="section-8.4.2-4">
<pre>
AS2-disposition-notification-content =
    reporting-ua-field CRLF
    mdn-gateway-field CRLF
    final-recipient-field CRLF
    original-message-id-field CRLF
    AS2-disposition-field CRLF
    *( failure-field CRLF )
    *( error-field CRLF )
    *( warning-field CRLF )
    *( extension-field CRLF )
    AS2-received-content-MIC-field CRLF
</pre><a href="#section-8.4.2-4" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="as2-mdn-fields">
<section id="section-8.4.3">
          <h4 id="name-as2-mdn-fields">
<a href="#section-8.4.3" class="section-number selfRef">8.4.3. </a><a href="#name-as2-mdn-fields" class="section-name selfRef">AS2-MDN Fields</a>
          </h4>
<p id="section-8.4.3-1">The rules for constructing the AS2-disposition-notification content
   are identical to the disposition-notification-content rules provided
   in Section 7 of RFC 3798 <span>[<a href="#RFC3798" class="cite xref">RFC3798</a>]</span>, except that the RFC 3798 disposition-
   field has been replaced with the AS2-disposition-field and that the
   AS2-received-content-MIC field has been added. The differences
   between the RFC 3798 disposition-field and the AS2-disposition-field
   are described below. Where there are differences between this
   document and RFC 3798, those entity names have been changed by
   pre-pending "AS2-". Entities that do not differ from RFC 3798 are not
   necessarily further defined in this document; refer to RFC 3798,
   Section 7, "Collected Grammar", for the original grammar.<a href="#section-8.4.3-1" class="pilcrow">¶</a></p>
<div class="breakable lang-abnf sourcecode" id="section-8.4.3-2">
<pre>
AS2-disposition-field =
    "Disposition" ":" disposition-mode ";"
    AS2-disposition-type "/" AS2-disposition-modifier

disposition-mode =
    action-mode "/" sending-mode

action-mode =
    "manual-action" | "automatic-action"

sending-mode =
    "MDN-sent-manually" | "MDN-sent-automatically"

AS2-disposition-type =
    "processed" | "failed"

AS2-disposition-modifier =
    ( "error" | "warning" ) | AS2-disposition-modifier-extension

AS2-disposition-modifier-extension =
    "error: authentication-failed" |
    "error: decompression-failed" |
    "error: decryption-failed" |
    "error: duplicate-filename" |
    "error: illegal-filename" |
    "error: insufficient-message-security" |
    "error: integrity-check-failed" |
    "error: invalid-message-id" |
    "error: unexpected-processing-error" |
    "error: unknown-trading-relationship" |
    "warning: " AS2-MDN-warning-description |
    "failure: " AS2-MDN-failure-description

AS2-MDN-warning-description = *( TEXT )

AS2-MDN-failure-description = *( TEXT )

AS2-received-content-MIC-field =
    "Received-content-MIC" ":" encoded-message-digest ","
    digest-alg-id CRLF

encoded-message-digest =
    1*( 'A'-'Z' | 'a'-'z' | '0'-'9' | '/' | '+' | '=' )
    ; i.e., base64(message-digest)

digest-alg-id = "sha-256" | "sha-384" | "sha-512" | "sha-1" | "sha1"
                 ; The "sha1" is a legacy spelling of the "sha-1" defined hash in the IANA Textual Names Registry
                 ; It should be maintained for backwards compatibility
                 ; sha1 | sha-1 should only be used by legacy deployments that cannot support sha-256 or greater
</pre><a href="#section-8.4.3-2" class="pilcrow">¶</a>
</div>
<p id="section-8.4.3-3">To improve error reporting and interoperability, this specification
   introduces additional standardized disposition modifiers beyond those
   defined in <span>[<a href="#RFC4130" class="cite xref">RFC4130</a>]</span> and <span>[<a href="#RFC8098" class="cite xref">RFC8098</a>]</span>.<a href="#section-8.4.3-3" class="pilcrow">¶</a></p>
<p id="section-8.4.3-4">These modifiers are used to indicate specific failure conditions that
   cannot be adequately represented by the existing error codes and may
   not be compatible with earlier implementations of AS2
   Implementations MUST include a human-readable explanation in the MDN
   <code>Explanation</code> field when returning these modifiers.<a href="#section-8.4.3-4" class="pilcrow">¶</a></p>
<p id="section-8.4.3-5">Future modifiers may be registered through the IANA registry for
   AS2 Disposition Values and Modifiers (see Section 11).<a href="#section-8.4.3-5" class="pilcrow">¶</a></p>
<p id="section-8.4.3-6">The "Received-content-MIC" extension field is set when the integrity
   of the received message is verified. The MIC is the base64-encoded
   message-digest computed over the received message using a hash
   function. This field is required for signed receipts but optional
   for unsigned receipts. For details defining the specific content
   over which the message digest is to be computed, see <a href="#signed-receipt-considerations" class="internal xref">Section 8.3.1</a>
   of this document.<a href="#section-8.4.3-6" class="pilcrow">¶</a></p>
<p id="section-8.4.3-7">For signed messages, the algorithm used to calculate the MIC MUST be
   the same as that used on the message that was signed. If the message
   is not signed, then the SHA-256 algorithm SHOULD be used. SHA-1 MAY be
   used only for legacy interoperability (see Appendix B). This field
   is set only when the contents of the message are processed
   successfully. This field is used in conjunction with the recipient's
   signature on the MDN so that the sender can verify non-repudiation of
   receipt.<a href="#section-8.4.3-7" class="pilcrow">¶</a></p>
<p id="section-8.4.3-8">AS2-MDN field names (e.g., "Disposition:", "Final-Recipient:") are
   case insensitive (cf. RFC 3798, Section 3.1.1). AS2-MDN action-
   modes, sending-modes, AS2-disposition-types, and AS2-disposition-
   modifier values, which are defined above, and user-supplied *( TEXT )
   values are also case-insensitive. AS2 implementations MUST NOT make
   assumptions regarding the values supplied for AS2-MDN-warning-
   description or AS2-MDN-failure-description, or for the values of any
   (optional) error, warning, or failure fields.<a href="#section-8.4.3-8" class="pilcrow">¶</a></p>
</section>
</div>
<div id="as2-mdn-field-requirements">
<section id="section-8.4.4">
          <h4 id="name-as2-mdn-field-requirements">
<a href="#section-8.4.4" class="section-number selfRef">8.4.4. </a><a href="#name-as2-mdn-field-requirements" class="section-name selfRef">AS2-MDN Field Requirements</a>
          </h4>
<p id="section-8.4.4-1">The following fields have clarified requirements for interoperability:<a href="#section-8.4.4-1" class="pilcrow">¶</a></p>
<p id="section-8.4.4-2">o <strong>Final-Recipient</strong> — This field <strong>MUST</strong> always be present in an MDN
     and MUST identify the AS2-To value of the original message.<a href="#section-8.4.4-2" class="pilcrow">¶</a></p>
<p id="section-8.4.4-3">o <strong>Original-Message-ID</strong> — This field is <strong>REQUIRED</strong> and MUST exactly
     match the <code>Message-ID</code> of the original message as transmitted.
     <code>Message-ID</code> in the MDN itself is optional.<a href="#section-8.4.4-3" class="pilcrow">¶</a></p>
<p id="section-8.4.4-4">o <strong>Disposition-Notification-To</strong> — Implementations <strong>MAY</strong> include this
     field using an email address, URL, hostname, or other identifier as
     appropriate to the system.  However, as specified in <span>[<a href="#RFC4130" class="cite xref">RFC4130</a>]</span>, receiving
     applications <strong>MUST</strong> ignore this field and <strong>MUST NOT</strong> reject a message
     due to syntax or address format violations.  The field is retained for
     compatibility with prior implementations.<a href="#section-8.4.4-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="additional-as2-mdn-programming-notes">
<section id="section-8.4.5">
          <h4 id="name-additional-as2-mdn-programm">
<a href="#section-8.4.5" class="section-number selfRef">8.4.5. </a><a href="#name-additional-as2-mdn-programm" class="section-name selfRef">Additional AS2-MDN Programming Notes</a>
          </h4>
<p id="section-8.4.5-1">o  For HTTP transactions, Original-Recipient and Final-Recipient
      SHOULD not be different.  The value in Original-Message-ID SHOULD
      match the original Message-ID header value.<a href="#section-8.4.5-1" class="pilcrow">¶</a></p>
<p id="section-8.4.5-2">o  Refer to RFC 3798 for the formatting of the MDN, except for the
      specific deviations mentioned above.<a href="#section-8.4.5-2" class="pilcrow">¶</a></p>
<p id="section-8.4.5-3">o  Refer to RFC 3462 and RFC 3798 for the formatting of the content-
      type entity-headers for the MDN.<a href="#section-8.4.5-3" class="pilcrow">¶</a></p>
<p id="section-8.4.5-4">o  Use an action-mode of "automatic-action" when the disposition
      described by the disposition type was a result of an automatic
      action rather than that of an explicit instruction by the user for
      this message.<a href="#section-8.4.5-4" class="pilcrow">¶</a></p>
<p id="section-8.4.5-5">o  Use an action-mode of "manual-action" when the disposition
      described by the disposition type was a result of an explicit
      instruction by the user rather than some sort of automatically
      performed action.<a href="#section-8.4.5-5" class="pilcrow">¶</a></p>
<p id="section-8.4.5-6">o  Use a sending-mode of "MDN-sent-automatically" when the MDN is
      sent because the UA had previously been configured to do so.<a href="#section-8.4.5-6" class="pilcrow">¶</a></p>
<p id="section-8.4.5-7">o  Use a sending-mode of "MDN-sent-manually" when the user explicitly
      gave permission for this particular MDN to be sent.<a href="#section-8.4.5-7" class="pilcrow">¶</a></p>
<p id="section-8.4.5-8">o  The sending-mode "MDN-sent-manually" is meaningful ONLY with
      "manual-action", not with "automatic-action".<a href="#section-8.4.5-8" class="pilcrow">¶</a></p>
<p id="section-8.4.5-9">o  The "failed" disposition type MUST NOT be used for the situation
      in which there is some problem in processing the message other
      than interpreting the request for an MDN. The "processed" or
      other disposition type with appropriate disposition modifiers is
      to be used in such situations.<a href="#section-8.4.5-9" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="disposition-mode-type-and-modifier">
<section id="section-8.5">
        <h3 id="name-disposition-mode-type-and-m">
<a href="#section-8.5" class="section-number selfRef">8.5. </a><a href="#name-disposition-mode-type-and-m" class="section-name selfRef">Disposition Mode, Type, and Modifier</a>
        </h3>
<div id="disposition-mode-overview">
<section id="section-8.5.1">
          <h4 id="name-disposition-mode-overview">
<a href="#section-8.5.1" class="section-number selfRef">8.5.1. </a><a href="#name-disposition-mode-overview" class="section-name selfRef">Disposition Mode Overview</a>
          </h4>
<p id="section-8.5.1-1">This section provides a brief overview of how "processed", "error",
   "failure", and "warning" are used.<a href="#section-8.5.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="successful-processing-status-indication">
<section id="section-8.5.2">
          <h4 id="name-successful-processing-statu">
<a href="#section-8.5.2" class="section-number selfRef">8.5.2. </a><a href="#name-successful-processing-statu" class="section-name selfRef">Successful Processing Status Indication</a>
          </h4>
<p id="section-8.5.2-1">When the request for a receipt or signed receipt, and the received
   message contents are successfully processed by the receiving EDI UA,
   a receipt or MDN SHOULD be returned with the disposition-type set to
   "processed". When the MDN is sent automatically by the EDI UA, and
   there is no explicit way for a user to control the sending of the
   MDN, then the first part of the "disposition-mode" SHOULD be set to
   "automatic-action". When the MDN is being sent under user-
   configurable control, then the first part of the "disposition-mode"
   SHOULD be set to "manual-action". Since a request for a signed
   receipt should always be honored, the user MUST not be allowed to
   configure the UA to disallow sending of a signed receipt when the sender
   requests one.<a href="#section-8.5.2-1" class="pilcrow">¶</a></p>
<p id="section-8.5.2-2">The second part of the disposition-mode is set to "MDN-sent-manually"
   if the user gave explicit permission for the MDN to be sent. Again,
   the user MUST not be allowed to explicitly refuse to send a signed
   receipt when the sender requests one. The second part of the
   "disposition-mode" is set to "MDN-sent-automatically" whenever the
   EDI UA sends the MDN automatically, regardless of whether the sending
   was under the control of a user, administrator, or the software.<a href="#section-8.5.2-2" class="pilcrow">¶</a></p>
<p id="section-8.5.2-3">Because EDI content is generally handled automatically by the EDI UA,
   a request for a receipt or signed receipt will generally return the
   following in the "disposition-field":<a href="#section-8.5.2-3" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-8.5.2-4">
<pre>
   Disposition: automatic-action/MDN-sent-automatically; processed
</pre><a href="#section-8.5.2-4" class="pilcrow">¶</a>
</div>
<p id="section-8.5.2-5">Note that this specification does not restrict the use of the
   "disposition-mode" just to automatic actions. Manual actions are
   valid as long as it is kept in mind that a request for a signed
   receipt MUST be honored.<a href="#section-8.5.2-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="unsuccessful-processed-content">
<section id="section-8.5.3">
          <h4 id="name-unsuccessful-processed-cont">
<a href="#section-8.5.3" class="section-number selfRef">8.5.3. </a><a href="#name-unsuccessful-processed-cont" class="section-name selfRef">Unsuccessful Processed Content</a>
          </h4>
<p id="section-8.5.3-1">The request for a signed receipt requires the use of two
   "disposition-notification-options", which specify the protocol format
   of the returned signed receipt, and the MIC algorithm used to
   calculate the MIC over the message content. The "disposition-field"
   values that should be used if the message content is being rejected
   or ignored (for instance, if the EDI UA determines that a signed
   receipt cannot be returned because it does not support the requested
   protocol format, the EDI UA chooses not to process the message
   contents itself) MUST be specified in the MDN "disposition-field" as
   follows:<a href="#section-8.5.3-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-8.5.3-2">
<pre>
   Disposition: "disposition-mode";  failed/Failure: unsupported format
</pre><a href="#section-8.5.3-2" class="pilcrow">¶</a>
</div>
<p id="section-8.5.3-3">The "failed" AS2-disposition-type MUST be used when a failure occurs
   that prevents the proper generation of an MDN. For example, this
   disposition-type would apply if the sender of the message requested
   the application of an unsupported message-integrity-check (MIC)
   algorithm.<a href="#section-8.5.3-3" class="pilcrow">¶</a></p>
<p id="section-8.5.3-4">The "failure:" AS2-disposition-modifier-extension SHOULD be used with
   an implementation-defined description of the failure. Further
   information about the failure may be contained in a failure-field.<a href="#section-8.5.3-4" class="pilcrow">¶</a></p>
<p id="section-8.5.3-5">The syntax of the "failed" disposition-type is general, allowing the
   sending of any textual information along with the "failed"
   disposition-type. Implementations MUST support any printable textual
   characters after the Failure disposition-type. For use in Internet
   EDI, the following "failed" values are pre-defined and MUST be
   supported:<a href="#section-8.5.3-5" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-8.5.3-6">
<pre>
   "Failure: unsupported format"
   "Failure: unsupported MIC-algorithms"
</pre><a href="#section-8.5.3-6" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="unsuccessful-non-content-processing">
<section id="section-8.5.4">
          <h4 id="name-unsuccessful-non-content-pr">
<a href="#section-8.5.4" class="section-number selfRef">8.5.4. </a><a href="#name-unsuccessful-non-content-pr" class="section-name selfRef">Unsuccessful Non-Content Processing</a>
          </h4>
<p id="section-8.5.4-1">When errors occur in processing the received message (other than
   content), the "disposition-field" MUST be set to the "processed"
   value for disposition-type and the "error" value for disposition-
   modifier.<a href="#section-8.5.4-1" class="pilcrow">¶</a></p>
<p id="section-8.5.4-2">The "error" AS2-disposition-modifier with the "processed"
   disposition-type MUST be used to indicate that an error of some sort
   occurred that prevented successful processing of the message.
   Further information may be contained in an error-field.<a href="#section-8.5.4-2" class="pilcrow">¶</a></p>
<p id="section-8.5.4-3">An "error:" AS2-disposition-modifier-extension SHOULD be used to
   combine the indication of an error with a predefined description of a
   specific, well-known error. Further information about the error may
   be contained in an error field.<a href="#section-8.5.4-3" class="pilcrow">¶</a></p>
<p id="section-8.5.4-4">For internet EDI use, the following "error" AS2-disposition-modifier
   values are defined:<a href="#section-8.5.4-4" class="pilcrow">¶</a></p>
<div class="lang-text sourcecode" id="section-8.5.4-5">
<pre>
   o "Error: authentication-failed"         - the receiver could not
                                              authenticate the sender.

   o "Error: decompression-failed"          - the receiver could not
                                              decompress the message
                                              contents.

   o "Error: decryption-failed"             - the receiver could not
                                              decrypt the message
                                              contents.
   o "Error: duplicate-filename"            - the message payload contained
                                              a filename already received
                                              by the backend server.

   o "Error: illegal-filename"              - the message payload contained
                                              a filename that could nor be
                                              processed by the backend server.

   o "Error: insufficient-message-security" - the content of the message
                                              was not appropriately enveloped
                                              according to the agreed-upon
                                              message security.

   o "Error: integrity-check-failed"        - the receiver could not
                                              verify content integrity.

   o "Error: invalid-message-id"            - the receiver could not
                                              parse the value of the
                                              Message-ID header because it
                                              was not syntactically correct.

   o "Error: unexpected-processing-error"   - a catch-all for any
                                              additional processing
                                              errors.

   o "Error: unknown-trading-relationship"   - the receiver could not
                                              correlate the AS2-To/AS2-From
                                              header values to values known
                                              to the system.
</pre><a href="#section-8.5.4-5" class="pilcrow">¶</a>
</div>
<p id="section-8.5.4-6">An example of how the "disposition-field" would look when errors
   other than those in content processing are detected is as follows:<a href="#section-8.5.4-6" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-8.5.4-7">
<pre>
   Disposition: "disposition-mode"; processed/Error: decryption-failed
</pre><a href="#section-8.5.4-7" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="processing-warnings">
<section id="section-8.5.5">
          <h4 id="name-processing-warnings">
<a href="#section-8.5.5" class="section-number selfRef">8.5.5. </a><a href="#name-processing-warnings" class="section-name selfRef">Processing Warnings</a>
          </h4>
<p id="section-8.5.5-1">Situations arise in EDI when, even if a trading partner cannot be
   authenticated correctly, the trading partners still agree to continue
   processing the EDI transactions. Transaction reconciliation is done
   between the trading partners at a later time. In the content
   processing warning situations as described above, the "disposition-
   field" MUST be set to the "processed" disposition-type value, and the
   "warning" to the "disposition-modifier" value.<a href="#section-8.5.5-1" class="pilcrow">¶</a></p>
<p id="section-8.5.5-2">The "warning" AS2-disposition-modifier MUST be used with the
   "processed" disposition-type to indicate that the message was
   successfully processed but that an exceptional condition occurred.
   Further information may be contained in a warning-field.<a href="#section-8.5.5-2" class="pilcrow">¶</a></p>
<p id="section-8.5.5-3">A "warning:" AS2-disposition-modifier-extension SHOULD be used to
   combine the indication of a warning with an implementation-defined
   description of the warning.  Further information about the warning
   may be contained in a warning-field.<a href="#section-8.5.5-3" class="pilcrow">¶</a></p>
<p id="section-8.5.5-4">For use in Internet EDI, the following "warning"
   disposition-modifier-extension value is defined:<a href="#section-8.5.5-4" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-8.5.5-5">
<pre>
   "Warning: authentication-failed, processing continued"
</pre><a href="#section-8.5.5-5" class="pilcrow">¶</a>
</div>
<p id="section-8.5.5-6">An example of how the "disposition-field" would look when warning
   other than those for content processing are detected is as follows:<a href="#section-8.5.5-6" class="pilcrow">¶</a></p>
<p id="section-8.5.5-7">Example:<a href="#section-8.5.5-7" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-8.5.5-8">
<pre>
   Disposition: "disposition-mode"; processed/Warning:
     authentication-failed, processing continued
</pre><a href="#section-8.5.5-8" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="backward-compatibility-with-disposition-type-modifier-and-extension">
<section id="section-8.5.6">
          <h4 id="name-backward-compatibility-with">
<a href="#section-8.5.6" class="section-number selfRef">8.5.6. </a><a href="#name-backward-compatibility-with" class="section-name selfRef">Backward Compatibility with Disposition Type, Modifier, and Extension</a>
          </h4>
<p id="section-8.5.6-1">The following set of examples represents typical constructions of the
   Disposition field that have been in use by AS2 implementations.  This
   is NOT an exhaustive list of possible constructions. However, AS2
   implementations MUST accept constructions of this type to be backward
   compatible with earlier AS2 versions.<a href="#section-8.5.6-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-8.5.6-2">
<pre>
  Disposition: automatic-action/MDN-sent-automatically; processed

  Disposition: automatic-action/MDN-sent-automatically;
  processed/error: authentication-failed

  Disposition: automatic-action/MDN-sent-automatically;
  processed/warning: duplicate-document

  Disposition: automatic-action/MDN-sent-automatically;
  failed/failure: sender-equals-receiver
</pre><a href="#section-8.5.6-2" class="pilcrow">¶</a>
</div>
<p id="section-8.5.6-3">The following set of examples represents allowable constructions of
   the Disposition field that combine the historic constructions above
   with optional RFC 3798 error, warning, and failure fields. AS2
   implementations MAY produce these constructions. However, AS2
   servers are not required to recognize or process optional error,
   warning, or failure fields at this time. Note that the use of the
   multiple error fields in the second example below provides for the
   indication of multiple error conditions.<a href="#section-8.5.6-3" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-8.5.6-4">
<pre>
  Disposition: automatic-action/MDN-sent-automatically; processed

  Disposition: automatic-action/MDN-sent-automatically;
    processed/error: decryption-failed
  Error: The signature did not decrypt into a valid PKCS#1
    Type-2 block.
  Error: The length of the decrypted key does not equal the
    octet length of the modulus.

  Disposition: automatic-action/MDN-sent-automatically;
    processed/warning: duplicate-document
  Warning: An identical message already exists at the
    destination server.

  Disposition: automatic-action/MDN-sent-automatically;
    failed/failure: sender-equals-receiver
  Failure: The AS2-To name is identical to the AS2-From name.
</pre><a href="#section-8.5.6-4" class="pilcrow">¶</a>
</div>
<p id="section-8.5.6-5">The following set of examples represents allowable constructions of
   the Disposition field that employ pure RFC 3798 Disposition-modifiers
   with optional error, warning, and failure fields. These examples are
   provided as informational only. These constructions are not
   guaranteed to be backward compatible with AS2 implementations prior
   to version 1.1.<a href="#section-8.5.6-5" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-8.5.6-6">
<pre>
  Disposition: automatic-action/MDN-sent-automatically; processed

  Disposition: automatic-action/MDN-sent-automatically; processed/error
  Error: authentication-failed
  Error: The signature did not decrypt into a valid PKCS#1 Type-2 block.
  Error: The length of the decrypted key does not equal the octet length of the modulus.

  Disposition: automatic-action/MDN-sent-automatically; processed/warning
  Warning: duplicate-document

  Disposition: automatic-action/MDN-sent-automatically; failed
  Failure: sender-equals-receiver
</pre><a href="#section-8.5.6-6" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
<div id="receipt-reply-considerations-in-an-http-post">
<section id="section-8.6">
        <h3 id="name-receipt-reply-consideration">
<a href="#section-8.6" class="section-number selfRef">8.6. </a><a href="#name-receipt-reply-consideration" class="section-name selfRef">Receipt Reply Considerations in an HTTP POST</a>
        </h3>
<p id="section-8.6-1">The details of the response to the POST command vary depending upon
   whether a receipt has been requested.<a href="#section-8.6-1" class="pilcrow">¶</a></p>
<p id="section-8.6-2">With no extended header requesting a receipt, and with no errors
   accessing the request-URI specified processing, the status line in
   the Response to the POST request SHOULD be in the 200 range. Status
   codes in the 200 range SHOULD also be used when an entity is returned
   (a signed receipt in a multipart/signed content type or an unsigned
   receipt in a multipart/report). Even when the disposition of the
   data was an error condition at the authentication, decryption or
   other higher level, the HTTP status code SHOULD indicate success at
   the HTTP level.<a href="#section-8.6-2" class="pilcrow">¶</a></p>
<p id="section-8.6-3">The HTTP server application may respond with an unsolicited
   multipart/report as a message body that the HTTP client might not
   have solicited, but the client may discard this. Applications SHOULD
   avoid emitting unsolicited receipt replies because bandwidth or
   processing limitations might have led administrators to suspend
   asking for acknowledgements.<a href="#section-8.6-3" class="pilcrow">¶</a></p>
<p id="section-8.6-4">Message Disposition Notifications, when used in the HTTP reply context,
   follow the same semantics as those defined in <span>[<a href="#RFC3798" class="cite xref">RFC3798</a>]</span>. For example, the
   disposition field is a required element in the machine-readable
   second part of a multipart/report for a MDN. The final-recipient-
   field (<span>[<a href="#RFC3798" class="cite xref">RFC3798</a>]</span>, Section 3.1) value SHOULD be derived from the entity
   headers of the request.<a href="#section-8.6-4" class="pilcrow">¶</a></p>
<p id="section-8.6-5">In an MDN, the first part of the multipart/report (the human-readable
   portion) SHOULD include items such as the subject, the date, and other
   information when those fields are present in entity header fields
   following the POST request. An application MUST report the Message-
   ID of the request in the second part of the multipart/report (the
   machine-readable portion). Also, an MDN SHOULD have its own unique
   Message-ID HTTP header. The HTTP reply SHOULD normally omit the
   third optional part of the multipart/report (this was historically
   used to return the original message or its headers within the SMTP context).<a href="#section-8.6-5" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="public-key-certificate-handling">
<section id="section-9">
      <h2 id="name-public-key-certificate-hand">
<a href="#section-9" class="section-number selfRef">9. </a><a href="#name-public-key-certificate-hand" class="section-name selfRef">Public Key Certificate Handling</a>
      </h2>
<p id="section-9-1">The initial exchange and certification of public keys are essential
   steps in establishing a secure trading partnership.  This process MAY
   occur manually during partner onboarding or automatically through
   supported mechanisms such as the <strong>AS2 GET</strong> method (see Section 9.2).
   Implementations MUST maintain a database of public keys used for encryption
   and signature verification, together with the mapping between the EDI
   trading partner identifier and its associated RFC 5322 <span>[<a href="#RFC5322" class="cite xref">RFC5322</a>]</span> email
   address and HTTP URL/URI. The exact procedures for establishing and
   configuring secure AS2 messaging can vary among trading partners and
   software implementations.<a href="#section-9-1" class="pilcrow">¶</a></p>
<p id="section-9-2">X.509 certificates are REQUIRED. It is RECOMMENDED that trading
   partners self-certify each other if an agreed-upon certification
   authority is not used. This applicability statement does NOT require
   the use of a certification authority (CA) and the use of a CA
   is therefore OPTIONAL. Certificates MAY be self-signed.<a href="#section-9-2" class="pilcrow">¶</a></p>
<p id="section-9-3">It is RECOMMENDED that when trading partners are using S/MIME they
   also exchange public key certificates, considering the advice provided in
   <span>[<a href="#RFC3850" class="cite xref">RFC3850</a>]</span>.<a href="#section-9-3" class="pilcrow">¶</a></p>
<p id="section-9-4">The message formats useful for certificate exchange are found in <span>[<a href="#RFC3851" class="cite xref">RFC3851</a>]</span>
   and <span>[<a href="#RFC3852" class="cite xref">RFC3852</a>]</span>.<a href="#section-9-4" class="pilcrow">¶</a></p>
<div id="certificate-roles-and-requirements">
<section id="section-9.1">
        <h3 id="name-certificate-roles-and-requi">
<a href="#section-9.1" class="section-number selfRef">9.1. </a><a href="#name-certificate-roles-and-requi" class="section-name selfRef">Certificate Roles and Requirements</a>
        </h3>
<p id="section-9.1-1">While TLS certificates and AS2 message-signing certificates both use the
   X.509 standard, they serve distinct purposes and MUST be managed
   separately:<a href="#section-9.1-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-9.1-2.1">
            <p id="section-9.1-2.1.1"><strong>TLS Certificates</strong> are used solely to secure the HTTPS transport
channel. They establish session-level confidentiality and integrity and
SHOULD be issued by a trusted certification authority (CA) in production
environments. Self-signed TLS certificates MAY be used for testing or by
explicit agreement between trading partners, provided they include a
<strong>Subject Alternative Name (SAN)</strong> extension containing the hostname
and/or IP address. The SAN extension MUST be marked as non-critical.<a href="#section-9.1-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-9.1-2.2">
            <p id="section-9.1-2.2.1"><strong>AS2 Certificates</strong> are used for signing and encrypting AS2 messages
and SHOULD NOT be the same as the TLS certificate. Separation ensures that
a compromise of the transport layer does not affect message-level
security. AS2 certificates MAY be CA-issued or self-signed, depending on
organizational policy and trading-partner agreements.<a href="#section-9.1-2.2.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-9.1-3">AS2 certificates MUST use a key length of at least <strong>2048 bits for RSA
   keys</strong>.  For elliptic-curve certificates, the selected curve MUST provide
   equivalent or stronger security (e.g., P-256 or higher).<a href="#section-9.1-3" class="pilcrow">¶</a></p>
<p id="section-9.1-4">Although short certificate lifetimes are now common in the TLS ecosystem
   due to CA/Browser Forum requirements and industry regulations, AS2 certificates
   generally do not require the same frequency of renewal. AS2 systems handle far fewer
   encrypted transactions than high-volume web servers, and certificate
   rollover can be operationally complex.  Implementations SHOULD allow
   independent lifetime policies for AS2 and TLS certificates.<a href="#section-9.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="certificate-exchange-and-renewal">
<section id="section-9.2">
        <h3 id="name-certificate-exchange-and-re">
<a href="#section-9.2" class="section-number selfRef">9.2. </a><a href="#name-certificate-exchange-and-re" class="section-name selfRef">Certificate Exchange and Renewal</a>
        </h3>
<p id="section-9.2-1">Automated certificate management significantly reduces operational risk.
   Implementations SHOULD support <strong>Certificate Exchange Messaging (CEM)</strong>
          <span>[<a href="#RFC6017" class="cite xref">RFC6017</a>]</span> to enable secure, automated exchange of AS2 certificates between
   trading partners.  When CEM is not available, manual exchange processes
   MUST ensure integrity and authentication of keys prior to activation.<a href="#section-9.2-1" class="pilcrow">¶</a></p>
<p id="section-9.2-2">The <strong>AS2 GET</strong> method MAY be used for initial retrieval of partner
   certificates if protected by appropriate authentication (for example,
   Basic Authentication). Implementations using AS2 GET MUST ensure that
   certificate delivery is integrity-protected and that access is restricted
   to authorized partners.<a href="#section-9.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="operational-guidance">
<section id="section-9.3">
        <h3 id="name-operational-guidance">
<a href="#section-9.3" class="section-number selfRef">9.3. </a><a href="#name-operational-guidance" class="section-name selfRef">Operational Guidance</a>
        </h3>
<ul class="normal">
<li class="normal" id="section-9.3-1.1">
            <p id="section-9.3-1.1.1">TLS and AS2 certificates MUST be managed separately.<a href="#section-9.3-1.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-9.3-1.2">
            <p id="section-9.3-1.2.1">CEM SHOULD be supported to reduce manual errors and configuration drift.<a href="#section-9.3-1.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-9.3-1.3">
            <p id="section-9.3-1.3.1">Self-signed certificates SHOULD include SAN extensions for clarity and
validation consistency.<a href="#section-9.3-1.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-9.3-1.4">
            <p id="section-9.3-1.4.1">Implementations SHOULD support configurable expiration and notification
mechanisms for certificate renewal.<a href="#section-9.3-1.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-9.3-1.5">
            <p id="section-9.3-1.5.1">Administrators SHOULD avoid reusing TLS certificates as AS2 certificates,
even when technically possible.<a href="#section-9.3-1.5.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-9.3-2">For security and algorithm lifecycle considerations, see
   <span><a href="#algorithm-requirements" class="internal xref">Section 7</a> (<a href="#algorithm-requirements" class="auto internal xref">Section 7</a>)</span> and
   <span><a href="#security-considerations" class="internal xref">Section 10</a> (<a href="#security-considerations" class="auto internal xref">Section 10</a>)</span>.<a href="#section-9.3-2" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="security-considerations">
<section id="section-10">
      <h2 id="name-security-considerations">
<a href="#section-10" class="section-number selfRef">10. </a><a href="#name-security-considerations" class="section-name selfRef">Security Considerations</a>
      </h2>
<p id="section-10-1">This entire document is concerned with secure transport of business data,
   covering confidentiality, authentication, and non-repudiation.<a href="#section-10-1" class="pilcrow">¶</a></p>
<p id="section-10-2">Cryptographic algorithms used for signatures, MIC calculations, and
   encryption are subject to modernization and deprecation guidance.
   The definitive algorithm requirements (for hash functions and
   encryption) are specified in <a href="#algorithm-requirements" class="internal xref">Section 7</a>.
   This section provides security rationale and additional guidance.<a href="#section-10-2" class="pilcrow">¶</a></p>
<p id="section-10-3">Legacy algorithms such as SHA-1, MD5, 3DES, and RC2 are deprecated
   due to known weaknesses. Implementations MUST NOT generate these
   algorithms in new deployments. However, legacy use cases may still be
   encountered when interoperating with older systems conforming to
   <span>[<a href="#RFC4130" class="cite xref">RFC4130</a>]</span>. See Appendix B for clarifications on legacy interoperability.<a href="#section-10-3" class="pilcrow">¶</a></p>
<p id="section-10-4">Modern implementations are expected to support strong algorithms such
   as SHA-256 or stronger for MIC calculations, and AES (128-bit or
   greater) for encryption. Implementations SHOULD also support advanced
   AES modes such as AES-GCM and AES-CCM for improved efficiency and
   authenticated encryption. See <span>[<a href="#RFC8551" class="cite xref">RFC8551</a>]</span> for details.<a href="#section-10-4" class="pilcrow">¶</a></p>
<p id="section-10-5">Implementations must ensure robust handling of all cryptographic
   failures. Administrators are encouraged to monitor IETF and NIST
   publications for algorithm lifecycle updates and to update deployed
   systems accordingly. These compatibility allowances are described in more detail in
   <a href="#backward-compatibility-and-interoperability" class="internal xref">Section 1.2</a> and
   <a href="#legacy-interoperability-non-normative" class="internal xref">Appendix B</a>.<a href="#section-10-5" class="pilcrow">¶</a></p>
<p id="section-10-6">When processing certificates, failures such as expired, revoked, or
   untrusted certificates MUST result in immediate and noticeable error
   reporting. See <span>[<a href="#RFC3280" class="cite xref">RFC3280</a>]</span> and <span>[<a href="#RFC8551" class="cite xref">RFC8551</a>]</span> for guidance on certificate
   path validation. For guidance on certificate management, key exchange,
   and renewal, including use of Certificate Exchange Messaging (CEM) and
   AS2 GET, see <span><a href="#public-key-certificate-handling" class="internal xref">Section 9</a> (<a href="#public-key-certificate-handling" class="auto internal xref">Section 9</a>)</span>.<a href="#section-10-6" class="pilcrow">¶</a></p>
<div id="https-tls-reqs">
<section id="section-10.1">
        <h3 id="name-https-and-tls-requirements">
<a href="#section-10.1" class="section-number selfRef">10.1. </a><a href="#name-https-and-tls-requirements" class="section-name selfRef">HTTPS and TLS Requirements</a>
        </h3>
<p id="section-10.1-1"><strong>Consensus Update:</strong>
   Implementations <strong>MUST</strong> support TLS 1.2 or higher and <strong>SHOULD</strong> support TLS 1.3.
   TLS 1.3 is strongly encouraged as the default where platform support allows, but TLS 1.2
   remains the mandatory baseline to ensure interoperability with older environments (e.g., legacy JVMs).
   Products SHOULD allow administrators to configure which TLS versions are enabled, so that TLS 1.3 can be
   mandated by policy where required. Future revisions of this specification are expected to mandate TLS 1.3
   as the minimum required version once deployment is widespread.<a href="#section-10.1-1" class="pilcrow">¶</a></p>
<p id="section-10.1-2">Administrators SHOULD use only cipher suites listed as “Recommended (Y)” in the
   <a href="https://www.iana.org/assignments/tls-parameters">IANA TLS Parameters</a> registry.
   Implementations SHOULD provide configurable cipher selection rather than hardcoding cipher lists.<a href="#section-10.1-2" class="pilcrow">¶</a></p>
<p id="section-10.1-3">New implementations of AS2 <strong>SHOULD</strong> use HTTPS as the default transport
   protocol to provide confidentiality and integrity in transit. Plain HTTP
   remains permitted to support message-level encryption and backward
   compatibility with existing deployments.<a href="#section-10.1-3" class="pilcrow">¶</a></p>
<p id="section-10.1-4">This guidance promotes strong encryption, aligns with current best practices,
   and ensures that AS2 remains interoperable with existing deployments while
   allowing administrators to phase out weaker protocols and cipher suites over time.<a href="#section-10.1-4" class="pilcrow">¶</a></p>
<p id="section-10.1-5"><strong>Future Considerations</strong>
   Per BCP 195/RFC 7525bis, new IETF protocols and major revisions are expected to mandate TLS 1.3.
   AS2-bis is a backward-compatible revision, and therefore specifies MUST support of TLS 1.2 and SHOULD
   support of TLS 1.3 to preserve interoperability with existing implementations. At the same time, implementers
   are strongly encouraged to deploy TLS 1.3 as the default for all new products and configurations.
   Future versions of AS2 (for example, a potential AS2-Version 1.3 or subsequent update) are expected to raise
   the baseline to MUST support TLS 1.3 or higher, and may deprecate TLS 1.2 once widespread deployment
   makes this feasible. Implementers are encouraged to prepare for a future revision of this specification
   that will mandate TLS 1.3 as the minimum required version.<a href="#section-10.1-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="tls-server-certificates">
<section id="section-10.2">
        <h3 id="name-tls-server-certificates">
<a href="#section-10.2" class="section-number selfRef">10.2. </a><a href="#name-tls-server-certificates" class="section-name selfRef">TLS Server Certificates</a>
        </h3>
<p id="section-10.2-1">The following certificate types MUST be supported for TLS server
   certificates:<a href="#section-10.2-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-10.2-2">
<pre>
  o  with URL in the Distinguished Name Common Name attribute

  o  without URL in the Distinguished Name Common Name attribute

  o  self-signed (self-issued)

  o  issued by a certification authority (CA)
</pre><a href="#section-10.2-2" class="pilcrow">¶</a>
</div>
<p id="section-10.2-3">The URL, which matches the source server identity, SHOULD be carried
   in the certificate. However, it is not required that DNS checks or
   reverse lookups to vouch for the accuracy of the URL or server value.<a href="#section-10.2-3" class="pilcrow">¶</a></p>
<p id="section-10.2-4">The complete certification chain MUST be included in all
   certificates.  All certificate verifications MUST "chain to root" or
   to an accepted trust anchor. Additionally, the certificate hash
   SHOULD match the hash recomputed by the receiver.<a href="#section-10.2-4" class="pilcrow">¶</a></p>
<p id="section-10.2-5">Because server certificates are exchanged, and also trust is
   established during the configuration of the trading partner
   relationship, runtime validation (including hostname matching and
   certificate path validation) SHOULD be performed unless an out-of-band
   trust model has been explicitly agreed upon by trading partners.
   If a self-signed TLS certificate is used, it SHOULD contain a Subject Alternative Name (SAN)
   extension that includes the hostname and/or IP address of the sender.
   If included, this certificate extension MUST be marked as non-critical.<a href="#section-10.2-5" class="pilcrow">¶</a></p>
<p id="section-10.2-6"><strong>Note:</strong> Although not restricted by this specification, self-signed TLS certificates should
   be used with great care, especially in production environments.<a href="#section-10.2-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="nrr-cautions">
<section id="section-10.3">
        <h3 id="name-nrr-cautions">
<a href="#section-10.3" class="section-number selfRef">10.3. </a><a href="#name-nrr-cautions" class="section-name selfRef">NRR Cautions</a>
        </h3>
<p id="section-10.3-1">This specification seeks to provide multiple mechanisms that can be
   combined in accordance with local policies to achieve a wide range of
   security needs as determined by threat and risk analyses of the
   business peers. It is required that all these mechanisms be
   implemented by AS2 software so that the software has capabilities
   that promote strong interoperability, no matter what policies are
   adopted.<a href="#section-10.3-1" class="pilcrow">¶</a></p>
<p id="section-10.3-2">One strong cluster of mechanisms (the secure transmission loop) can
   provide good support for meeting the evidentiary needs of non-
   repudiation of receipt by the original sender and by a third party
   supplied with all stated evidence. However, this specification does
   not itself define non-repudiation of receipt nor enumerate its
   essential properties because NRR is a business analysis and/or legal
   requirement, and not relevantly defined by a technical applicability
   statement.<a href="#section-10.3-2" class="pilcrow">¶</a></p>
<p id="section-10.3-3">Some analyses observe that non-repudiation of receipt presupposes
   that non-repudiation of the sender of the original message is
   obtained, and further that non-repudiation should be implemented by
   means of digital signature on the original message. To satisfy
   strict NRR evidence, authentication and integrity MUST be provided by
   some mechanism, and the RECOMMENDED mechanism is digital signatures
   on both the original message and the receipt message.<a href="#section-10.3-3" class="pilcrow">¶</a></p>
<p id="section-10.3-4">Given that this specification has selected several mechanisms that
   can be combined in several ways, it is important to realize that if a
   digital signature is omitted from the original message, in order to
   satisfy the preceding analysis of NRR requirements, some
   authentication mechanism MUST accompany the request for a signed
   receipt and its included Received-content-MIC value. This
   authentication might come from using client-side SSL, authentication
   via IPsec, or HTTP authentication (while using SSL). In any case,
   records of the message content, its security basis, and the digest
   value need to be retained for the NRR process.<a href="#section-10.3-4" class="pilcrow">¶</a></p>
<p id="section-10.3-5">Therefore, if NRR is one of the goals of the policy that is adopted,
   by using the mechanisms of the secure transmission loop mentioned
   above and by retaining appropriate records of authentication at the
   original message sender site, strong evidentiary requirements
   proposed for NRR can be fulfilled.<a href="#section-10.3-5" class="pilcrow">¶</a></p>
<p id="section-10.3-6">Other ways of proceeding may fall short of fulfilling the most
   stringent sets of evidence required for NRR to obtain, but may
   nevertheless be part of a commercial trading agreement and, as such,
   are good enough for the parties involved. However, if MDNs are
   returned unsigned, evidentiary requirements for NRR are weak; some
   authentication of the identity of the receiver is needed.<a href="#section-10.3-6" class="pilcrow">¶</a></p>
<p id="section-10.3-7">If TLS is used for transport, the guidance in <a href="#https-tls-reqs" class="internal xref">Section 10.1</a> applies.<a href="#section-10.3-7" class="pilcrow">¶</a></p>
</section>
</div>
<div id="replay-remark">
<section id="section-10.4">
        <h3 id="name-replay-remark">
<a href="#section-10.4" class="section-number selfRef">10.4. </a><a href="#name-replay-remark" class="section-name selfRef">Replay Remark</a>
        </h3>
<p id="section-10.4-1">Because business data documents normally contain transaction ids,
   replays (such as resends of not-yet-acknowledged messages) are
   discarded as part of the normal process of duplicate detection.
   Detection of duplicates by Message-Id or by business transaction
   identifiers is recommended.<a href="#section-10.4-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="iana-considerations">
<section id="section-11">
      <h2 id="name-iana-considerations">
<a href="#section-11" class="section-number selfRef">11. </a><a href="#name-iana-considerations" class="section-name selfRef">IANA Considerations</a>
      </h2>
<p id="section-11-1">IANA is requested to update the following registries:<a href="#section-11-1" class="pilcrow">¶</a></p>
<p id="section-11-2">o MDN Disposition Modifier Names
     https://www.iana.org/assignments/mdn/mdn.xhtml#disposition-modifier<a href="#section-11-2" class="pilcrow">¶</a></p>
<p id="section-11-3">o Message Disposition Notification Parameters
     https://www.iana.org/assignments/mdn/mdn.xhtml#parameters<a href="#section-11-3" class="pilcrow">¶</a></p>
<div id="registration">
<section id="section-11.1">
        <h3 id="name-registration">
<a href="#section-11.1" class="section-number selfRef">11.1. </a><a href="#name-registration" class="section-name selfRef">Registration</a>
        </h3>
<p id="section-11.1-1">RFC 4130 originally defined an extension to the Message Disposition Notification (MDN)
   protocol for a disposition-modifier in the Disposition field of a body of
   content-type "message/disposition-notification".<a href="#section-11.1-1" class="pilcrow">¶</a></p>
<p id="section-11.1-2">This document updates that definition, and IANA is requested to replace RFC 4130 with this
   document as the reference for the MDN Disposition Modifier Names registry.<a href="#section-11.1-2" class="pilcrow">¶</a></p>
<div id="disposition-modifier-warning">
<section id="section-11.1.1">
          <h4 id="name-disposition-modifier-warnin">
<a href="#section-11.1.1" class="section-number selfRef">11.1.1. </a><a href="#name-disposition-modifier-warnin" class="section-name selfRef">Disposition Modifier 'warning'</a>
          </h4>
<div class="lang-text sourcecode" id="section-11.1.1-1">
<pre>
   Parameter-name:  warning
   Semantics: See [Section 8.4.3](#as2-mdn-fields){:format="none"} and
   [Section 8.5.5](#processing-warnings){:format="none"} in this document.
</pre><a href="#section-11.1.1-1" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="acknowledgments">
<section id="section-12">
      <h2 id="name-acknowledgments">
<a href="#section-12" class="section-number selfRef">12. </a><a href="#name-acknowledgments" class="section-name selfRef">Acknowledgments</a>
      </h2>
<p id="section-12-1">Carl Hage, Karen Rosenfeld, Chuck Fenton, and many others
   provided valuable suggestions during the initial review of RFC 4130
   that improved that applicability statement and this bis specification.
   The authors would also like to thank the past and current vendors who
   have participated in the Drummond AS2 interoperability testing.
   Their contributions have ultimately led to great improvement in the clarity
   of this document.<a href="#section-12-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sec-combined-references">
<section id="section-13">
      <h2 id="name-references">
<a href="#section-13" class="section-number selfRef">13. </a><a href="#name-references" class="section-name selfRef">References</a>
      </h2>
<div id="sec-normative-references">
<section id="section-13.1">
        <h3 id="name-normative-references">
<a href="#section-13.1" class="section-number selfRef">13.1. </a><a href="#name-normative-references" class="section-name selfRef">Normative References</a>
        </h3>
<dl class="references">
<dt id="RFC1767">[RFC1767]</dt>
        <dd>
<span class="refAuthor">Crocker, D.</span>, <span class="refTitle">"MIME Encapsulation of EDI Objects"</span>, <span class="seriesInfo">RFC 1767</span>, <span class="seriesInfo">DOI 10.17487/RFC1767</span>, <time datetime="1995-03" class="refDate">March 1995</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc1767">https://www.rfc-editor.org/rfc/rfc1767</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC1847">[RFC1847]</dt>
        <dd>
<span class="refAuthor">Galvin, J.</span>, <span class="refAuthor">Murphy, S.</span>, <span class="refAuthor">Crocker, S.</span>, and <span class="refAuthor">N. Freed</span>, <span class="refTitle">"Security Multiparts for MIME: Multipart/Signed and Multipart/Encrypted"</span>, <span class="seriesInfo">RFC 1847</span>, <span class="seriesInfo">DOI 10.17487/RFC1847</span>, <time datetime="1995-10" class="refDate">October 1995</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc1847">https://www.rfc-editor.org/rfc/rfc1847</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2026">[RFC2026]</dt>
        <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"The Internet Standards Process -- Revision 3"</span>, <span class="seriesInfo">BCP 9</span>, <span class="seriesInfo">RFC 2026</span>, <span class="seriesInfo">DOI 10.17487/RFC2026</span>, <time datetime="1996-10" class="refDate">October 1996</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc2026">https://www.rfc-editor.org/rfc/rfc2026</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2045">[RFC2045]</dt>
        <dd>
<span class="refAuthor">Freed, N.</span> and <span class="refAuthor">N. Borenstein</span>, <span class="refTitle">"Multipurpose Internet Mail Extensions (MIME) Part One: Format of Internet Message Bodies"</span>, <span class="seriesInfo">RFC 2045</span>, <span class="seriesInfo">DOI 10.17487/RFC2045</span>, <time datetime="1996-11" class="refDate">November 1996</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc2045">https://www.rfc-editor.org/rfc/rfc2045</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2046">[RFC2046]</dt>
        <dd>
<span class="refAuthor">Freed, N.</span> and <span class="refAuthor">N. Borenstein</span>, <span class="refTitle">"Multipurpose Internet Mail Extensions (MIME) Part Two: Media Types"</span>, <span class="seriesInfo">RFC 2046</span>, <span class="seriesInfo">DOI 10.17487/RFC2046</span>, <time datetime="1996-11" class="refDate">November 1996</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc2046">https://www.rfc-editor.org/rfc/rfc2046</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2049">[RFC2049]</dt>
        <dd>
<span class="refAuthor">Freed, N.</span> and <span class="refAuthor">N. Borenstein</span>, <span class="refTitle">"Multipurpose Internet Mail Extensions (MIME) Part Five: Conformance Criteria and Examples"</span>, <span class="seriesInfo">RFC 2049</span>, <span class="seriesInfo">DOI 10.17487/RFC2049</span>, <time datetime="1996-11" class="refDate">November 1996</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc2049">https://www.rfc-editor.org/rfc/rfc2049</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2119">[RFC2119]</dt>
        <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time datetime="1997-03" class="refDate">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc2119">https://www.rfc-editor.org/rfc/rfc2119</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2234">[RFC2234]</dt>
        <dd>
<span class="refAuthor">Crocker, D., Ed.</span> and <span class="refAuthor">P. Overell</span>, <span class="refTitle">"Augmented BNF for Syntax Specifications: ABNF"</span>, <span class="seriesInfo">RFC 2234</span>, <span class="seriesInfo">DOI 10.17487/RFC2234</span>, <time datetime="1997-11" class="refDate">November 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc2234">https://www.rfc-editor.org/rfc/rfc2234</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2616">[RFC2616]</dt>
        <dd>
<span class="refAuthor">Fielding, R.</span>, <span class="refAuthor">Gettys, J.</span>, <span class="refAuthor">Mogul, J.</span>, <span class="refAuthor">Frystyk, H.</span>, <span class="refAuthor">Masinter, L.</span>, <span class="refAuthor">Leach, P.</span>, and <span class="refAuthor">T. Berners-Lee</span>, <span class="refTitle">"Hypertext Transfer Protocol -- HTTP/1.1"</span>, <span class="seriesInfo">RFC 2616</span>, <span class="seriesInfo">DOI 10.17487/RFC2616</span>, <time datetime="1999-06" class="refDate">June 1999</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc2616">https://www.rfc-editor.org/rfc/rfc2616</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC3023">[RFC3023]</dt>
        <dd>
<span class="refAuthor">Murata, M.</span>, <span class="refAuthor">St. Laurent, S.</span>, and <span class="refAuthor">D. Kohn</span>, <span class="refTitle">"XML Media Types"</span>, <span class="seriesInfo">RFC 3023</span>, <span class="seriesInfo">DOI 10.17487/RFC3023</span>, <time datetime="2001-01" class="refDate">January 2001</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc3023">https://www.rfc-editor.org/rfc/rfc3023</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC3274">[RFC3274]</dt>
        <dd>
<span class="refAuthor">Gutmann, P.</span>, <span class="refTitle">"Compressed Data Content Type for Cryptographic Message Syntax (CMS)"</span>, <span class="seriesInfo">RFC 3274</span>, <span class="seriesInfo">DOI 10.17487/RFC3274</span>, <time datetime="2002-06" class="refDate">June 2002</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc3274">https://www.rfc-editor.org/rfc/rfc3274</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC3280">[RFC3280]</dt>
        <dd>
<span class="refAuthor">Housley, R.</span>, <span class="refAuthor">Polk, W.</span>, <span class="refAuthor">Ford, W.</span>, and <span class="refAuthor">D. Solo</span>, <span class="refTitle">"Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile"</span>, <span class="seriesInfo">RFC 3280</span>, <span class="seriesInfo">DOI 10.17487/RFC3280</span>, <time datetime="2002-04" class="refDate">April 2002</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc3280">https://www.rfc-editor.org/rfc/rfc3280</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC3335">[RFC3335]</dt>
        <dd>
<span class="refAuthor">Harding, T.</span>, <span class="refAuthor">Drummond, R.</span>, and <span class="refAuthor">C. Shih</span>, <span class="refTitle">"MIME-based Secure Peer-to-Peer Business Data Interchange over the Internet"</span>, <span class="seriesInfo">RFC 3335</span>, <span class="seriesInfo">DOI 10.17487/RFC3335</span>, <time datetime="2002-09" class="refDate">September 2002</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc3335">https://www.rfc-editor.org/rfc/rfc3335</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC3462">[RFC3462]</dt>
        <dd>
<span class="refAuthor">Vaudreuil, G.</span>, <span class="refTitle">"The Multipart/Report Content Type for the Reporting of Mail System Administrative Messages"</span>, <span class="seriesInfo">RFC 3462</span>, <span class="seriesInfo">DOI 10.17487/RFC3462</span>, <time datetime="2003-01" class="refDate">January 2003</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc3462">https://www.rfc-editor.org/rfc/rfc3462</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC3798">[RFC3798]</dt>
        <dd>
<span class="refAuthor">Hansen, T., Ed.</span> and <span class="refAuthor">G. Vaudreuil, Ed.</span>, <span class="refTitle">"Message Disposition Notification"</span>, <span class="seriesInfo">RFC 3798</span>, <span class="seriesInfo">DOI 10.17487/RFC3798</span>, <time datetime="2004-05" class="refDate">May 2004</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc3798">https://www.rfc-editor.org/rfc/rfc3798</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC3850">[RFC3850]</dt>
        <dd>
<span class="refAuthor">Ramsdell, B., Ed.</span>, <span class="refTitle">"Secure/Multipurpose Internet Mail Extensions (S/MIME) Version 3.1 Certificate Handling"</span>, <span class="seriesInfo">RFC 3850</span>, <span class="seriesInfo">DOI 10.17487/RFC3850</span>, <time datetime="2004-07" class="refDate">July 2004</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc3850">https://www.rfc-editor.org/rfc/rfc3850</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC3851">[RFC3851]</dt>
        <dd>
<span class="refAuthor">Ramsdell, B., Ed.</span>, <span class="refTitle">"Secure/Multipurpose Internet Mail Extensions (S/MIME) Version 3.1 Message Specification"</span>, <span class="seriesInfo">RFC 3851</span>, <span class="seriesInfo">DOI 10.17487/RFC3851</span>, <time datetime="2004-07" class="refDate">July 2004</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc3851">https://www.rfc-editor.org/rfc/rfc3851</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC3852">[RFC3852]</dt>
        <dd>
<span class="refAuthor">Housley, R.</span>, <span class="refTitle">"Cryptographic Message Syntax (CMS)"</span>, <span class="seriesInfo">RFC 3852</span>, <span class="seriesInfo">DOI 10.17487/RFC3852</span>, <time datetime="2004-07" class="refDate">July 2004</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc3852">https://www.rfc-editor.org/rfc/rfc3852</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4130">[RFC4130]</dt>
        <dd>
<span class="refAuthor">Moberg, D.</span> and <span class="refAuthor">R. Drummond</span>, <span class="refTitle">"MIME-Based Secure Peer-to-Peer Business Data Interchange Using HTTP, Applicability Statement 2 (AS2)"</span>, <span class="seriesInfo">RFC 4130</span>, <span class="seriesInfo">DOI 10.17487/RFC4130</span>, <time datetime="2005-07" class="refDate">July 2005</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc4130">https://www.rfc-editor.org/rfc/rfc4130</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5322">[RFC5322]</dt>
        <dd>
<span class="refAuthor">Resnick, P., Ed.</span>, <span class="refTitle">"Internet Message Format"</span>, <span class="seriesInfo">RFC 5322</span>, <span class="seriesInfo">DOI 10.17487/RFC5322</span>, <time datetime="2008-10" class="refDate">October 2008</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc5322">https://www.rfc-editor.org/rfc/rfc5322</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6017">[RFC6017]</dt>
        <dd>
<span class="refAuthor">Meadors, K., Ed.</span>, <span class="refTitle">"Electronic Data Interchange - Internet Integration (EDIINT) Features Header Field"</span>, <span class="seriesInfo">RFC 6017</span>, <span class="seriesInfo">DOI 10.17487/RFC6017</span>, <time datetime="2010-09" class="refDate">September 2010</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc6017">https://www.rfc-editor.org/rfc/rfc6017</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8098">[RFC8098]</dt>
        <dd>
<span class="refAuthor">Hansen, T., Ed.</span> and <span class="refAuthor">A. Melnikov, Ed.</span>, <span class="refTitle">"Message Disposition Notification"</span>, <span class="seriesInfo">STD 85</span>, <span class="seriesInfo">RFC 8098</span>, <span class="seriesInfo">DOI 10.17487/RFC8098</span>, <time datetime="2017-02" class="refDate">February 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8098">https://www.rfc-editor.org/rfc/rfc8098</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8174">[RFC8174]</dt>
        <dd>
<span class="refAuthor">Leiba, B.</span>, <span class="refTitle">"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 8174</span>, <span class="seriesInfo">DOI 10.17487/RFC8174</span>, <time datetime="2017-05" class="refDate">May 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8174">https://www.rfc-editor.org/rfc/rfc8174</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8551">[RFC8551]</dt>
      <dd>
<span class="refAuthor">Schaad, J.</span>, <span class="refAuthor">Ramsdell, B.</span>, and <span class="refAuthor">S. Turner</span>, <span class="refTitle">"Secure/Multipurpose Internet Mail Extensions (S/MIME) Version 4.0 Message Specification"</span>, <span class="seriesInfo">RFC 8551</span>, <span class="seriesInfo">DOI 10.17487/RFC8551</span>, <time datetime="2019-04" class="refDate">April 2019</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8551">https://www.rfc-editor.org/rfc/rfc8551</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</div>
<div id="sec-informative-references">
<section id="section-13.2">
        <h3 id="name-informative-references">
<a href="#section-13.2" class="section-number selfRef">13.2. </a><a href="#name-informative-references" class="section-name selfRef">Informative References</a>
        </h3>
<dl class="references">
<dt id="I-D.draft-duker-as2-reliability-16">[I-D.draft-duker-as2-reliability-16]</dt>
        <dd>
<span class="refAuthor">Duker, J.</span> and <span class="refAuthor">dale.moberg@gmail.com</span>, <span class="refTitle">"Operational Reliability for EDIINT AS2"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-duker-as2-reliability-16</span>, <time datetime="2014-10-21" class="refDate">21 October 2014</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-duker-as2-reliability-16">https://datatracker.ietf.org/doc/html/draft-duker-as2-reliability-16</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.draft-harding-as2-restart-02">[I-D.draft-harding-as2-restart-02]</dt>
        <dd>
<span class="refAuthor">Harding, T.</span>, <span class="refTitle">"AS2 Restart for Very Large Messages"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-harding-as2-restart-02</span>, <time datetime="2011-01-26" class="refDate">26 January 2011</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-harding-as2-restart-02">https://datatracker.ietf.org/doc/html/draft-harding-as2-restart-02</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2246">[RFC2246]</dt>
        <dd>
<span class="refAuthor">Dierks, T.</span> and <span class="refAuthor">C. Allen</span>, <span class="refTitle">"The TLS Protocol Version 1.0"</span>, <span class="seriesInfo">RFC 2246</span>, <span class="seriesInfo">DOI 10.17487/RFC2246</span>, <time datetime="1999-01" class="refDate">January 1999</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc2246">https://www.rfc-editor.org/rfc/rfc2246</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4918">[RFC4918]</dt>
      <dd>
<span class="refAuthor">Dusseault, L., Ed.</span>, <span class="refTitle">"HTTP Extensions for Web Distributed Authoring and Versioning (WebDAV)"</span>, <span class="seriesInfo">RFC 4918</span>, <span class="seriesInfo">DOI 10.17487/RFC4918</span>, <time datetime="2007-06" class="refDate">June 2007</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc4918">https://www.rfc-editor.org/rfc/rfc4918</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</div>
</section>
</div>
<div id="message-examples">
<section id="appendix-A">
      <h2 id="name-message-examples">
<a href="#appendix-A" class="section-number selfRef">Appendix A. </a><a href="#name-message-examples" class="section-name selfRef">Message Examples</a>
      </h2>
<p id="appendix-A-1">Note to Readers: All examples are provided for illustration only, and are not
   part of the protocol specification. If an example conflicts with the
   protocol definitions, the example is wrong. Email addresses in the
   examples (e.g., in the <code>Disposition-Notification-To</code> field) reflect
   one valid option but are not required. In AS2, this field may also
   contain a URL, a fully qualified host name, an AS2 identifier, or
   another implementation-specific string, as described in <a href="#requesting-a-signed-receipt" class="internal xref">Section 8.3</a>.<a href="#appendix-A-1" class="pilcrow">¶</a></p>
<div id="signed-message-requesting-a-signed-synchronous-receipt">
<section id="appendix-A.1">
        <h3 id="name-signed-message-requesting-a">
<a href="#appendix-A.1" class="section-number selfRef">A.1. </a><a href="#name-signed-message-requesting-a" class="section-name selfRef">Signed Message Requesting a Signed, Synchronous Receipt</a>
        </h3>
<div class="lang-text sourcecode" id="appendix-A.1-1">
<pre>
   POST /receive HTTP/1.1
   Host: 10.234.160.12:80
   User-Agent: AS2 Company Server
   Date: Wed, 31 Jul 2025 13:34:50 GMT
   AS2-Version: 1.3
   AS2-From: "as2 Name"
   AS2-To: 0123456780000
   Subject: Test Case
   Message-Id: &lt;200207310834482A70BF63@\"~~foo~~\"&gt;
   Disposition-Notification-To: mrAS2@example.com
   Disposition-Notification-Options: signed-receipt-protocol=optional,
        pkcs7-signature; signed-receipt-micalg=optional,sha-256
   Content-Type: multipart/signed; boundary="as2BouNdary1as2";
        protocol="application/pkcs7-signature"; micalg=sha-256
   Content-Length: 2464

   --as2BouNdary1as2
   Content-Type: application/edi-x12
   Content-Disposition: attachment; filename=rfc1767.dat

     {ISA ...EDI transaction data...IEA...}

   --as2BouNdary1as2
   Content-Type: application/pkcs7-signature

     {omitted binary pkcs7 signature data}

   --as2BouNdary1as2--
</pre><a href="#appendix-A.1-1" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="mdn-for-message-in-a1-above">
<section id="appendix-A.2">
        <h3 id="name-mdn-for-message-in-a1-above">
<a href="#appendix-A.2" class="section-number selfRef">A.2. </a><a href="#name-mdn-for-message-in-a1-above" class="section-name selfRef">MDN for Message in A.1, Above</a>
        </h3>
<div class="breakable lang-text sourcecode" id="appendix-A.2-1">
<pre>
   HTTP/1.1 200 OK
   AS2-From: 0123456780000
   AS2-To: "as2 Name"
   AS2-Version: 1.3
   Message-ID: &lt;709700825.1028122454671.JavaMail@ediXchange&gt;
   Content-Type: multipart/signed; micalg=sha-256;
        protocol="application/pkcs7-signature";
        boundary="----=_Part_57_648441049.1028122454671"
   Connection: Close
   Content-Length: 1980

   ------=_Part_57_648441049.1028122454671

   &amp; Content-Type: multipart/report;
   &amp;    report-type=disposition-notification;
   &amp;    boundary="----=_Part_56_1672293592.1028122454656"
   &amp;
   &amp;------=_Part_56_1672293592.1028122454656
   &amp;Content-Type: text/plain
   &amp;Content-Transfer-Encoding: 7bit
   &amp;
   &amp;MDN for -
   &amp; Message ID: &lt;200207310834482A70BF63@\"~~foo~~\"&gt;
   &amp;  From: "as2 Name"
   &amp;  To: 0123456780000
   &amp;  Received on: 2025-07-31 at 09:34:14 (EDT)
   &amp; Status: processed
   &amp; Comment: This is not a guarantee that the message has
   &amp;  been completely processed or &amp;understood by the receiving
   &amp;  translator
   &amp;
   &amp;------=_Part_56_1672293592.1028122454656
   &amp;Content-Type: message/disposition-notification
   &amp;Content-Transfer-Encoding: 7bit
   &amp;
   &amp;Reporting-UA: AS2 Server
   &amp;Original-Recipient: rfc822; 0123456780000
   &amp;Final-Recipient: rfc822; 0123456780000
   &amp;Original-Message-ID: &lt;200207310834482A70BF63@\"~~foo~~\"&gt;
   &amp;Received-content-MIC: 43d9tGY3gNSGuFaut4PAGvuc+48VgW6USgXLDPTxsBU=, sha-256
   &amp;Disposition: automatic-action/MDN-sent-automatically; processed
   &amp;
   &amp;------=_Part_56_1672293592.1028122454656--

   ------=_Part_57_648441049.1028122454671
   Content-Type: application/pkcs7-signature; name=smime.p7s
   Content-Transfer-Encoding: base64
   Content-Disposition: attachment; filename=smime.p7s

   MIAGCSqGSIb3DQEHAqCAMIACAQExCzAJBgUrDgMCGgUAMIAGCSqGSIb3DQ
   cp24hMJNbxDKHnlB9jTiQzLwSwo+/90Pc87x+Sc6EpFSUYWGAAAAAAAA
   ------=_Part_57_648441049.1028122454671--

   Notes:

   1. The lines proceeded with "&amp;" are what the signature is calculated
      over.

   2. For details on how to prepare the multipart/signed with protocol =
      "application/pkcs7-signature", see the "S/MIME Message
      Specification, PKCS Security Services for MIME".

   3. Note that the textual first body part of the multipart/report can
      be used to include a more detailed explanation of the error
      conditions reported by the disposition headers. The first body
      part of the multipart/report, when used in this way, allows a
      person to better diagnose a problem in detail.

   4. As specified by RFC 3462 [RFC3462], returning the original or portions
      of the original message in the third body part of the
      multipart/report is not required.  This is an optional body part.
      However, it is RECOMMENDED that this body part be omitted or left
      blank.
</pre><a href="#appendix-A.2-1" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="signed-encrypted-message-requesting-a-signed-asynchronous-receipt">
<section id="appendix-A.3">
        <h3 id="name-signed-encrypted-message-re">
<a href="#appendix-A.3" class="section-number selfRef">A.3. </a><a href="#name-signed-encrypted-message-re" class="section-name selfRef">Signed, Encrypted Message Requesting a Signed, Asynchronous Receipt</a>
        </h3>
<div class="lang-text sourcecode" id="appendix-A.3-1">
<pre>
   POST /trading_partner HTTP/1.1
   Host: 10.240.1.2:58101
   User-Agent: AS2 Company Server
   Message-ID: &lt;#as2_company#01#a4260as2_companyout#&gt;
   Date: Thu, 19 Dec 2024 15:04:18 GMT
   Subject: Signed and encrypted message with async MDN request
   Mime-Version: 1.0
   Content-Type: application/pkcs7-mime;
       smime-type=enveloped-data; name=smime.p7m
   Content-Transfer-Encoding: binary
   Content-Disposition: attachment; filename=smime.p7m
   Recipient-Address: 10.240.1.2//
   Disposition-Notification-To: http://10.240.1.2:58201/exchange/as2_company
   Disposition-Notification-Options: signed-receipt-protocol=optional,
        pkcs7-signature; signed-receipt-micalg=optional,sha-256
   Receipt-Delivery-Option: http://10.240.1.2:58201/exchange/as2_company
   AS2-From: as2_company
   AS2-To: "AS2 Test"
   AS2-Version: 1.3
   Connection: close
   Content-Length: 3428

     {omitted binary encrypted data}
</pre><a href="#appendix-A.3-1" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="asynchronous-mdn-for-message-in-a3-above">
<section id="appendix-A.4">
        <h3 id="name-asynchronous-mdn-for-messag">
<a href="#appendix-A.4" class="section-number selfRef">A.4. </a><a href="#name-asynchronous-mdn-for-messag" class="section-name selfRef">Asynchronous MDN for Message in A.3, Above</a>
        </h3>
<div class="breakable lang-text sourcecode" id="appendix-A.4-1">
<pre>
   POST / HTTP/1.1
   Host: 10.234.160.12:80
   Connection: close, TE
   TE: trailers, deflate, gzip, compress
   User-Agent: AS2 Company Server
   Date: Thu, 19 Dec 2024 15:05:38 GMT
   Message-ID: &lt;AS2-20021219_030338@as2_company.dgi_th&gt;
   AS2-Version: 1.3
   Mime-Version: 1.0
   Recipient-Address: http://10.240.1.2:58201/exchange/as2_company
   AS2-To: as2_company
   AS2-From: "AS2 Test"
   Subject: Your Requested MDN Response
   From: as2debug@example.com
   Accept-Encoding: deflate, gzip, x-gzip, compress, x-compress
   Content-Type: multipart/signed; micalg=sha-256;
        protocol="application/pkcs7-signature";
        boundary="----=_Part_337_6452266.1040310218750"
   Content-Length: 3103

   ------=_Part_337_6452266.1040310218750
   Content-Type: multipart/report;
        report-type=disposition-notification;
        boundary="----=_Part_336_6069110.1040310218718"

   ------=_Part_336_6069110.1040310218718
   Content-Type: text/plain; charset=us-ascii
   Content-Transfer-Encoding: 7bit

   The message &lt;x12.edi&gt; sent to Recipient &lt;AS2 Test&gt; on Thu, 19 Dec
   2024 15:04:18 GMT with Subject &lt;Signed and encrypted message with async
   MDN request&gt; has been received. The EDI Interchange was successfully
   decrypted, and its integrity was verified. In addition, the sender of
   the message, Sender &lt;as2_company&gt; at Location http://10.240.1.2:58201/exchange/as2_company
   was authenticated as the originator of the message. There is no
   guarantee, however, that the EDI interchange was syntactically
   correct, or that it was received by the EDI application/translator.

   ------=_Part_336_6069110.1040310218718
   Content-Type: message/disposition-notification
   Content-Transfer-Encoding: 7bit

   Reporting-UA: AS2@test:8101
   Original-Recipient: rfc822; "AS2 Test"
   Final-Recipient: rfc822; "AS2 Test"
   Original-Message-ID: &lt;#as2_company#01#a4260as2_companyout#&gt;
   Disposition: automatic-action/MDN-sent-automatically; processed
   Received-Content-MIC: Hes6my+vIxIYxmvsA+MNpEOTPAc=, sha1

   ------=_Part_336_6069110.1040310218718--

   ------=_Part_337_6452266.1040310218750
   Content-Type: application/pkcs7-signature; name=smime.p7s
   Content-Transfer-Encoding: base64
   Content-Disposition: attachment; filename=smime.p7s

   BhbWjEfbyXoTAS/H0zpnEqLqbaBh29y2v82b8bdeGw8pipBQWmf53hIcqHGM
   4ZBF3CHw5Wrf1JIE+8TwOzdbal30zeChw88WfRfD7c/j1fIA8sxsujvf2d9j
   UxCUga8BVdVB9kH0Geexytyt0KvWQXfaEEcgZGUAAAAAAAA=

   ------=_Part_337_6452266.1040310218750-
</pre><a href="#appendix-A.4-1" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
<div id="legacy-interoperability-non-normative">
<section id="appendix-B">
      <h2 id="name-legacy-interoperability-non">
<a href="#appendix-B" class="section-number selfRef">Appendix B. </a><a href="#name-legacy-interoperability-non" class="section-name selfRef">Legacy Interoperability (Non-Normative)</a>
      </h2>
<p id="appendix-B-1">This appendix records clarifications for interoperability with
   legacy AS2 implementations conforming to <span>[<a href="#RFC4130" class="cite xref">RFC4130</a>]</span>. These provisions
   apply only when a modern AS2 implementation communicates with a
   partner that has not migrated to this specification. In such cases,
   both parties are effectively operating under <span>[<a href="#RFC4130" class="cite xref">RFC4130</a>]</span>, not this
   document.<a href="#appendix-B-1" class="pilcrow">¶</a></p>
<p id="appendix-B-2">These notes are provided to reduce ambiguity and ensure consistent
   behavior across implementations. They do not alter the algorithm
   requirements specified in Section 7, nor do they extend the use of
   deprecated algorithms.<a href="#appendix-B-2" class="pilcrow">¶</a></p>
<p id="appendix-B-3">Examples of legacy considerations include:<a href="#appendix-B-3" class="pilcrow">¶</a></p>
<p id="appendix-B-4">o  <strong>Message Integrity Checks (MICs):</strong> Implementations may continue
      to accept SHA-1 for MIC calculations when required by legacy
      partners. SHA-1 MUST NOT be generated by conformant modern
      implementations, but inbound SHA-1 values may be tolerated to
      maintain compatibility.<a href="#appendix-B-4" class="pilcrow">¶</a></p>
<p id="appendix-B-5">o  <strong>Encryption Algorithms:</strong> Implementations may accept inbound
      messages encrypted with 3DES from legacy partners. However, 3DES
      MUST NOT be generated by conformant implementations. AES (128-bit
      or stronger) remains the normative requirement in
      <a href="#encryption-algorithms" class="internal xref">Section 7.2</a>.<a href="#appendix-B-5" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-B-6">
<pre>
  Note: NIST withdrew the 3DES specification on 1 January 2024, and
  disallowed the two-key variant in 2017. Any residual use of 3DES is
  for backward compatibility only and MUST NOT be generated by
  conformant implementations.
</pre><a href="#appendix-B-6" class="pilcrow">¶</a>
</div>
<p id="appendix-B-7">o  <strong>Multiple-Recipient Encryption:</strong> RFC 4130 did not clearly
      specify expected behavior for multiple-recipient support. Modern
      implementations SHOULD support recoverable encryption by including
      a copy of the content-encryption key (CEK) for each recipient,
      and SHOULD include one for the originator when feasible. Legacy
      implementations may omit this; modern systems should tolerate it.<a href="#appendix-B-7" class="pilcrow">¶</a></p>
<p id="appendix-B-8">o  <strong>Error Handling:</strong> When encountering unsupported algorithms or
      malformed cryptographic structures in legacy exchanges,
      implementations SHOULD generate a clear error condition (e.g.,
      an unsigned MDN reporting "unsupported-mic-algorithm"). Silent
      fallback to weaker algorithms is NOT RECOMMENDED.<a href="#appendix-B-8" class="pilcrow">¶</a></p>
<p id="appendix-B-9">o  <strong>Profile Selection:</strong> Implementations may provide administrators
      the ability to select profiles (e.g., "AS2-1.2 legacy mode" versus
      "AS2-2.0 modern mode") for specific trading partner agreements,
      ensuring predictable behavior without runtime handshakes.<a href="#appendix-B-9" class="pilcrow">¶</a></p>
<p id="appendix-B-10">These clarifications are provided for reference and consistency
   across vendors. They are non-normative and are not intended to
   redefine <span>[<a href="#RFC4130" class="cite xref">RFC4130</a>]</span> or to weaken the algorithm requirements of this
   specification. see <a href="#backward-compatibility-and-interoperability" class="internal xref">Section 1.2</a>
   for discussion of backward compatibility principles, and Section 7
   for normative algorithm requirements.<a href="#appendix-B-10" class="pilcrow">¶</a></p>
</section>
</div>
<div id="change-log-non-normative">
<section id="appendix-C">
      <h2 id="name-change-log-non-normative">
<a href="#appendix-C" class="section-number selfRef">Appendix C. </a><a href="#name-change-log-non-normative" class="section-name selfRef">Change Log (Non-Normative)</a>
      </h2>
<p id="appendix-C-1">This appendix records the substantive changes made during the revision
from the original RFC 4130 draft toward the current version of this document.<a href="#appendix-C-1" class="pilcrow">¶</a></p>
<div id="general">
<section id="appendix-C.1">
        <h3 id="name-general">
<a href="#appendix-C.1" class="section-number selfRef">C.1. </a><a href="#name-general" class="section-name selfRef">General</a>
        </h3>
<ul class="normal">
<li class="normal" id="appendix-C.1-1.1">
            <p id="appendix-C.1-1.1.1">Removed all references to AS1/SMTP throughout the draft.<a href="#appendix-C.1-1.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-C.1-1.2">
            <p id="appendix-C.1-1.2.1">Included descriptions and references for compressed content, which was previously supported since AS2 version 1.1.<a href="#appendix-C.1-1.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-C.1-1.3">
            <p id="appendix-C.1-1.3.1">This draft explicitly allows negotiation of newer RFCs while retaining legacy support, where necessary.<a href="#appendix-C.1-1.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-C.1-1.4">
            <p id="appendix-C.1-1.4.1">Updated formatting and cross-references so that all internal "Section X.Y"
references are properly linked in HTML and XML output.<a href="#appendix-C.1-1.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-C.1-1.5">
            <p id="appendix-C.1-1.5.1">Moved legacy interoperability clarifications to Appendix B
to avoid confusion with normative text.<a href="#appendix-C.1-1.5.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-C.1-1.6">
            <p id="appendix-C.1-1.6.1">Clarified that appendices are non-normative unless otherwise indicated.<a href="#appendix-C.1-1.6.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="changes-affecting-section-12-backward-compatibility-and-interoperability">
<section id="appendix-C.2">
        <h3 id="name-changes-affecting-section-1">
<a href="#appendix-C.2" class="section-number selfRef">C.2. </a><a href="#name-changes-affecting-section-1" class="section-name selfRef">Changes affecting Section 1.2 - Backward Compatibility and Interoperability</a>
        </h3>
<ul class="normal">
<li class="normal" id="appendix-C.2-1.1">
            <p id="appendix-C.2-1.1.1">Expanded to explicitly state the dual-reference policy:<a href="#appendix-C.2-1.1.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-C.2-1.1.2.1">
                <p id="appendix-C.2-1.1.2.1.1">Implementations MAY interoperate with S/MIME v3.1 (RFC 3851/3852).<a href="#appendix-C.2-1.1.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="appendix-C.2-1.1.2.2">
                <p id="appendix-C.2-1.1.2.2.1">Conformant implementations MUST also support S/MIME v4.0 (RFC 8551).<a href="#appendix-C.2-1.1.2.2.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li class="normal" id="appendix-C.2-1.2">
            <p id="appendix-C.2-1.2.1">Added explicit pointer to Appendix B for legacy interoperability
clarifications.<a href="#appendix-C.2-1.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-C.2-1.3">
            <p id="appendix-C.2-1.3.1">Clarified that RFC 8551 forms the baseline for new implementations.<a href="#appendix-C.2-1.3.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="changes-affecting-section-51-as2-version-header">
<section id="appendix-C.3">
        <h3 id="name-changes-affecting-section-5">
<a href="#appendix-C.3" class="section-number selfRef">C.3. </a><a href="#name-changes-affecting-section-5" class="section-name selfRef">Changes affecting Section 5.1 - AS2-Version Header</a>
        </h3>
<ul class="normal">
<li class="normal" id="appendix-C.3-1.1">
            <p id="appendix-C.3-1.1.1">Retained definitions for AS2-Version 1.0, 1.1, and included the previously supported version 1.2.<a href="#appendix-C.3-1.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-C.3-1.2">
            <p id="appendix-C.3-1.2.1">Added <strong>AS2-Version: 1.3</strong>:<a href="#appendix-C.3-1.2.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-C.3-1.2.2.1">
                <p id="appendix-C.3-1.2.2.1.1">Defines modernization requirements (SHA-256, AES baseline per RFC 8551).<a href="#appendix-C.3-1.2.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="appendix-C.3-1.2.2.2">
                <p id="appendix-C.3-1.2.2.2.1">Aligns MDN behavior with RFC 8098.<a href="#appendix-C.3-1.2.2.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="appendix-C.3-1.2.2.3">
                <p id="appendix-C.3-1.2.2.3.1">Requires support for multiple-recipient encryption (Section 7.2).<a href="#appendix-C.3-1.2.2.3.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="appendix-C.3-1.2.2.4">
                <p id="appendix-C.3-1.2.2.4.1">States weak algorithms (SHA-1, MD5, 3DES, RC2) MUST NOT be generated
by conformant 1.3 implementations.<a href="#appendix-C.3-1.2.2.4.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="appendix-C.3-1.2.2.5">
                <p id="appendix-C.3-1.2.2.5.1">Points to Appendix B for legacy interoperability when communicating
with 1.2 or earlier partners.<a href="#appendix-C.3-1.2.2.5.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li class="normal" id="appendix-C.3-1.3">
            <p id="appendix-C.3-1.3.1">Added note about future versioning: minor versions (1.x) remain backward
compatible; major version (2.0+) would indicate non-backward-compatible
revisions.<a href="#appendix-C.3-1.3.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="changes-affecting-section-533-message-id-and-original-message-id">
<section id="appendix-C.4">
        <h3 id="name-changes-affecting-section-53">
<a href="#appendix-C.4" class="section-number selfRef">C.4. </a><a href="#name-changes-affecting-section-53" class="section-name selfRef">Changes affecting Section 5.3.3 — Message-Id and Original-Message-Id</a>
        </h3>
<ul class="normal">
<li class="normal" id="appendix-C.4-1.1">
            <p id="appendix-C.4-1.1.1">Prohibit spaces and control characters in newly generated <code>Message-Id</code>
values; recommend removal (not substitution) when constructing from
other attributes.<a href="#appendix-C.4-1.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-C.4-1.2">
            <p id="appendix-C.4-1.2.1">Clarify receiver behavior: implementations are not required to accept
malformed <code>Message-Id</code> values; they SHOULD return an MDN with
<code>processed/error</code> and a human-readable explanation (per <span>[<a href="#RFC8098" class="cite xref">RFC8098</a>]</span>).<a href="#appendix-C.4-1.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-C.4-1.3">
            <p id="appendix-C.4-1.3.1">Keep angle-bracket guidance; brackets are required on send and are not
part of the identifier value. Receivers SHOULD NOT reject solely for
missing brackets.<a href="#appendix-C.4-1.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-C.4-1.4">
            <p id="appendix-C.4-1.4.1">Update normative reference to <span>[<a href="#RFC5322" class="cite xref">RFC5322</a>]</span>.<a href="#appendix-C.4-1.4.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="changes-affecting-sections-54-and-55-reliability-and-restart">
<section id="appendix-C.5">
        <h3 id="name-changes-affecting-sections-">
<a href="#appendix-C.5" class="section-number selfRef">C.5. </a><a href="#name-changes-affecting-sections-" class="section-name selfRef">Changes affecting Sections 5.4 and 5.5 — Reliability and Restart</a>
        </h3>
<ul class="normal">
<li class="normal" id="appendix-C.5-1.1">
            <p id="appendix-C.5-1.1.1">Expanded Section 5.4 to clarify that HTTP 102 (Processing) MAY be used
under HTTP/1.1 for progress indication but MUST NOT be used under
HTTP/2 or 3.<a href="#appendix-C.5-1.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-C.5-1.2">
            <p id="appendix-C.5-1.2.1">Changed previous requirement to close connections before retry to
optional behavior; clarified that 102 is deprecated but still
permitted for backward compatibility.<a href="#appendix-C.5-1.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-C.5-1.3">
            <p id="appendix-C.5-1.3.1">Expanded Section 5.5 to reference the AS2 Reliability
(<span>[<a href="#I-D.draft-duker-as2-reliability-16" class="cite xref">I-D.draft-duker-as2-reliability-16</a>]</span>) and AS2 Restart (<span>[<a href="#I-D.draft-harding-as2-restart-02" class="cite xref">I-D.draft-harding-as2-restart-02</a>]</span>) drafts.<a href="#appendix-C.5-1.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-C.5-1.4">
            <p id="appendix-C.5-1.4.1">Clarified that implementations SHOULD support configurable retry logic
and MAY implement restart for large or interrupted transfers.<a href="#appendix-C.5-1.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-C.5-1.5">
            <p id="appendix-C.5-1.5.1">Added explicit normative language about duplicate detection using
Message-ID.<a href="#appendix-C.5-1.5.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="changes-affecting-section-6-additional-as2-specific-http-headers">
<section id="appendix-C.6">
        <h3 id="name-changes-affecting-section-6">
<a href="#appendix-C.6" class="section-number selfRef">C.6. </a><a href="#name-changes-affecting-section-6" class="section-name selfRef">Changes affecting Section 6 — Additional AS2-Specific HTTP Headers</a>
        </h3>
<ul class="normal">
<li class="normal" id="appendix-C.6-1.1">
            <p id="appendix-C.6-1.1.1">Added new <code>AS2-Product</code> header to identify the sending product and version.<a href="#appendix-C.6-1.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-C.6-1.2">
            <p id="appendix-C.6-1.2.1">Defined header format as <code>&lt;product-name&gt;:&lt;major.minor[.patch]&gt;</code>.<a href="#appendix-C.6-1.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-C.6-1.3">
            <p id="appendix-C.6-1.3.1">Required inclusion for AS2-Version 1.3 or 2.0 and later.<a href="#appendix-C.6-1.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-C.6-1.4">
            <p id="appendix-C.6-1.4.1">Clarified that the header enables interoperability diagnostics and
implementation-specific workarounds, not capability negotiation.<a href="#appendix-C.6-1.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-C.6-1.5">
            <p id="appendix-C.6-1.5.1">Explicitly stated that arbitrary or misleading product names MUST NOT be used.<a href="#appendix-C.6-1.5.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="changes-affecting-section-7-algorithm-requirements">
<section id="appendix-C.7">
        <h3 id="name-changes-affecting-section-7">
<a href="#appendix-C.7" class="section-number selfRef">C.7. </a><a href="#name-changes-affecting-section-7" class="section-name selfRef">Changes affecting Section 7 - Algorithm Requirements</a>
        </h3>
<ul class="normal">
<li class="normal" id="appendix-C.7-1.1">
            <p id="appendix-C.7-1.1.1">Introduced a new dedicated section consolidating algorithm requirements.<a href="#appendix-C.7-1.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-C.7-1.2">
            <p id="appendix-C.7-1.2.1"><strong>Hash Algorithms</strong>:<a href="#appendix-C.7-1.2.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-C.7-1.2.2.1">
                <p id="appendix-C.7-1.2.2.1.1">MUST support SHA-256.<a href="#appendix-C.7-1.2.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="appendix-C.7-1.2.2.2">
                <p id="appendix-C.7-1.2.2.2.1">SHOULD support SHA-384 or stronger.<a href="#appendix-C.7-1.2.2.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="appendix-C.7-1.2.2.3">
                <p id="appendix-C.7-1.2.2.3.1">SHA-1 and MD5 deprecated; MUST NOT be generated by conformant implementations.<a href="#appendix-C.7-1.2.2.3.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li class="normal" id="appendix-C.7-1.3">
            <p id="appendix-C.7-1.3.1"><strong>Encryption Algorithms</strong>:<a href="#appendix-C.7-1.3.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-C.7-1.3.2.1">
                <p id="appendix-C.7-1.3.2.1.1">MUST support AES-128-CBC; SHOULD support AES-256-CBC.<a href="#appendix-C.7-1.3.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="appendix-C.7-1.3.2.2">
                <p id="appendix-C.7-1.3.2.2.1">RECOMMENDED to support AES-GCM and AES-CCM modes.<a href="#appendix-C.7-1.3.2.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="appendix-C.7-1.3.2.3">
                <p id="appendix-C.7-1.3.2.3.1">3DES and RC2 deprecated; MUST NOT be generated.<a href="#appendix-C.7-1.3.2.3.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="appendix-C.7-1.3.2.4">
                <p id="appendix-C.7-1.3.2.4.1">SHOULD support multiple-recipient encryption (per RFC 8551 §3.3).<a href="#appendix-C.7-1.3.2.4.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li class="normal" id="appendix-C.7-1.4">
            <p id="appendix-C.7-1.4.1">Added explicit cross-references to Appendix B for legacy interoperability.<a href="#appendix-C.7-1.4.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="changes-affecting-section-8-mdn-processing">
<section id="appendix-C.8">
        <h3 id="name-changes-affecting-section-8">
<a href="#appendix-C.8" class="section-number selfRef">C.8. </a><a href="#name-changes-affecting-section-8" class="section-name selfRef">Changes affecting Section 8 - MDN Processing</a>
        </h3>
<ul class="normal">
<li class="normal" id="appendix-C.8-1.1">
            <p id="appendix-C.8-1.1.1">Updated to align MDN behavior with RFC 8098 (superseding RFC 3798).<a href="#appendix-C.8-1.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-C.8-1.2">
            <p id="appendix-C.8-1.2.1">Clarified semantics for signed-receipt-micalg:<a href="#appendix-C.8-1.2.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-C.8-1.2.2.1">
                <p id="appendix-C.8-1.2.2.1.1">Allow multiple algorithms in header for backward compatibility.<a href="#appendix-C.8-1.2.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="appendix-C.8-1.2.2.2">
                <p id="appendix-C.8-1.2.2.2.1">Conformance requires selecting one algorithm in Received-content-MIC.<a href="#appendix-C.8-1.2.2.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="appendix-C.8-1.2.2.3">
                <p id="appendix-C.8-1.2.2.3.1">SHA-256 set as the default minimum; SHA-1 only permitted for legacy use.<a href="#appendix-C.8-1.2.2.3.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li class="normal" id="appendix-C.8-1.3">
            <p id="appendix-C.8-1.3.1">Relaxed constraints on the content of the Disposition-notification-to header.<a href="#appendix-C.8-1.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-C.8-1.4">
            <p id="appendix-C.8-1.4.1">Definitions have been included for additional supported error dispositions.0<a href="#appendix-C.8-1.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-C.8-1.5">
            <p id="appendix-C.8-1.5.1">Clarified required MDN fields:<a href="#appendix-C.8-1.5.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-C.8-1.5.2.1">
                <p id="appendix-C.8-1.5.2.1.1"><code>Final-Recipient</code> — MUST always be present.<a href="#appendix-C.8-1.5.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="appendix-C.8-1.5.2.2">
                <p id="appendix-C.8-1.5.2.2.1"><code>Original-Message-ID</code> — REQUIRED and must match the original message exactly.<a href="#appendix-C.8-1.5.2.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="appendix-C.8-1.5.2.3">
                <p id="appendix-C.8-1.5.2.3.1"><code>Message-ID</code> in the MDN — optional.<a href="#appendix-C.8-1.5.2.3.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="appendix-C.8-1.5.2.4">
                <p id="appendix-C.8-1.5.2.4.1"><code>Disposition-Notification-To</code> — MAY use any format (email, URL, hostname);
receiving systems MUST ignore syntax issues per RFC 4130.<a href="#appendix-C.8-1.5.2.4.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li class="normal" id="appendix-C.8-1.6">
            <p id="appendix-C.8-1.6.1">Updated asynchronous MDN handling to reflect practical implementation realities:<a href="#appendix-C.8-1.6.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-C.8-1.6.2.1">
                <p id="appendix-C.8-1.6.2.1.1">HTTP 200-level responses SHOULD be sent immediately after receiving the last byte,
before full decryption or validation, to minimize timeout risk.<a href="#appendix-C.8-1.6.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="appendix-C.8-1.6.2.2">
                <p id="appendix-C.8-1.6.2.2.1">Persistent (keep-alive) connections MAY be used; closing is optional and
implementation-dependent.<a href="#appendix-C.8-1.6.2.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="appendix-C.8-1.6.2.3">
                <p id="appendix-C.8-1.6.2.3.1">Receipt of a 200-level response only acknowledges receipt, not successful processing.<a href="#appendix-C.8-1.6.2.3.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li class="normal" id="appendix-C.8-1.7">
            <p id="appendix-C.8-1.7.1">Emphasized that asynchronous MDNs are sent as independent HTTP messages per
Section 7.3, and clarified that connection handling should not be mandated at
the application layer.<a href="#appendix-C.8-1.7.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-C.8-1.8">
            <p id="appendix-C.8-1.8.1">Added standardized <code>disposition-modifier</code> extensions to improve error
reporting.<a href="#appendix-C.8-1.8.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-C.8-1.9">
            <p id="appendix-C.8-1.9.1">New recommended modifiers:<a href="#appendix-C.8-1.9.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-C.8-1.9.2.1">
                <p id="appendix-C.8-1.9.2.1.1"><code>error: decompression-failed</code><a href="#appendix-C.8-1.9.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="appendix-C.8-1.9.2.2">
                <p id="appendix-C.8-1.9.2.2.1"><code>error/duplicate-filename</code><a href="#appendix-C.8-1.9.2.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="appendix-C.8-1.9.2.3">
                <p id="appendix-C.8-1.9.2.3.1"><code>error/illegal-filename</code><a href="#appendix-C.8-1.9.2.3.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="appendix-C.8-1.9.2.4">
                <p id="appendix-C.8-1.9.2.4.1"><code>error: insufficient-message-security</code><a href="#appendix-C.8-1.9.2.4.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="appendix-C.8-1.9.2.5">
                <p id="appendix-C.8-1.9.2.5.1"><code>error/invalid-message-id</code><a href="#appendix-C.8-1.9.2.5.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="appendix-C.8-1.9.2.6">
                <p id="appendix-C.8-1.9.2.6.1"><code>error/unknown-trading-relationship</code><a href="#appendix-C.8-1.9.2.6.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li class="normal" id="appendix-C.8-1.10">
            <p id="appendix-C.8-1.10.1">Clarified that implementations returning these modifiers MUST include a
human-readable explanation in the MDN <code>Explanation</code> field.<a href="#appendix-C.8-1.10.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="changes-affecting-section-9-public-key-certificate-handling">
<section id="appendix-C.9">
        <h3 id="name-changes-affecting-section-9">
<a href="#appendix-C.9" class="section-number selfRef">C.9. </a><a href="#name-changes-affecting-section-9" class="section-name selfRef">Changes affecting Section 9 — Public Key Certificate Handling</a>
        </h3>
<ul class="normal">
<li class="normal" id="appendix-C.9-1.1">
            <p id="appendix-C.9-1.1.1">Revised the opening paragraph to reference the optional <strong>AS2 GET</strong> method,
in addition to manual partner onboarding.<a href="#appendix-C.9-1.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-C.9-1.2">
            <p id="appendix-C.9-1.2.1">Expanded the section to clarify separate roles and lifecycle management
for <strong>TLS certificates</strong> (transport security) and <strong>AS2 certificates</strong>
(message signing and encryption).<a href="#appendix-C.9-1.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-C.9-1.3">
            <p id="appendix-C.9-1.3.1">Stated that TLS and AS2 certificates <strong>SHOULD NOT</strong> be reused or shared to
prevent cross-impact if one certificate is compromised.<a href="#appendix-C.9-1.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-C.9-1.4">
            <p id="appendix-C.9-1.4.1">Required a <strong>minimum RSA key length of 2048 bits</strong> (or equivalent elliptic-curve
strength such as P-256).<a href="#appendix-C.9-1.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-C.9-1.5">
            <p id="appendix-C.9-1.5.1">Clarified that:<a href="#appendix-C.9-1.5.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-C.9-1.5.2.1">
                <p id="appendix-C.9-1.5.2.1.1"><strong>TLS certificates</strong> SHOULD be CA-signed in production; self-signed
certificates MAY be used in test environments or by partner agreement,
provided they include a <strong>Subject Alternative Name (SAN)</strong> extension
with hostname and/or IP address.<a href="#appendix-C.9-1.5.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="appendix-C.9-1.5.2.2">
                <p id="appendix-C.9-1.5.2.2.1"><strong>AS2 certificates</strong> MAY be CA-issued or self-signed per partner policy.<a href="#appendix-C.9-1.5.2.2.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li class="normal" id="appendix-C.9-1.6">
            <p id="appendix-C.9-1.6.1">Added guidance that <strong>AS2 certificate lifetimes</strong> need not mirror the
short renewal cycles of TLS certificates; renewal policies SHOULD be
independent.<a href="#appendix-C.9-1.6.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-C.9-1.7">
            <p id="appendix-C.9-1.7.1">Recommended <strong>CEM</strong> for automated certificate exchange between partners
to reduce manual errors and downtime.<a href="#appendix-C.9-1.7.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-C.9-1.8">
            <p id="appendix-C.9-1.8.1">Introduced optional support for <strong>AS2 GET</strong> to retrieve partner
certificates, provided retrieval is authenticated (for example, Basic Auth
or mutual TLS) and integrity-protected.<a href="#appendix-C.9-1.8.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-C.9-1.9">
            <p id="appendix-C.9-1.9.1">Added operational recommendations:<a href="#appendix-C.9-1.9.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-C.9-1.9.2.1">
                <p id="appendix-C.9-1.9.2.1.1">Maintain separate TLS / AS2 certificates.<a href="#appendix-C.9-1.9.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="appendix-C.9-1.9.2.2">
                <p id="appendix-C.9-1.9.2.2.1">Include SAN extensions in all self-signed certificates.<a href="#appendix-C.9-1.9.2.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="appendix-C.9-1.9.2.3">
                <p id="appendix-C.9-1.9.2.3.1">Support configurable expiry-notification mechanisms.<a href="#appendix-C.9-1.9.2.3.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="appendix-C.9-1.9.2.4">
                <p id="appendix-C.9-1.9.2.4.1">Avoid reusing TLS certificates for AS2 message security.<a href="#appendix-C.9-1.9.2.4.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
        </ul>
</section>
</div>
<div id="changes-affecting-section-10-security-considerations">
<section id="appendix-C.10">
        <h3 id="name-changes-affecting-section-10">
<a href="#appendix-C.10" class="section-number selfRef">C.10. </a><a href="#name-changes-affecting-section-10" class="section-name selfRef">Changes affecting Section 10 - Security Considerations</a>
        </h3>
<ul class="normal">
<li class="normal" id="appendix-C.10-1.1">
            <p id="appendix-C.10-1.1.1">Provided guidance for the usgae of HTTPS and the minimum and recommended usage of TLS versions.<a href="#appendix-C.10-1.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-C.10-1.2">
            <p id="appendix-C.10-1.2.1">Expanded discussion of algorithm lifecycle:<a href="#appendix-C.10-1.2.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-C.10-1.2.2.1">
                <p id="appendix-C.10-1.2.2.1.1">SHA-1 and MD5 deprecated; 3DES formally withdrawn by NIST (2024).<a href="#appendix-C.10-1.2.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="appendix-C.10-1.2.2.2">
                <p id="appendix-C.10-1.2.2.2.1">Implementations MUST NOT generate deprecated algorithms.<a href="#appendix-C.10-1.2.2.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="appendix-C.10-1.2.2.3">
                <p id="appendix-C.10-1.2.2.3.1">Migration guidance provided for interoperability.<a href="#appendix-C.10-1.2.2.3.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li class="normal" id="appendix-C.10-1.3">
            <p id="appendix-C.10-1.3.1">Added explicit references back to Section 7 (Algorithm Requirements) and
Appendix B (Legacy Interoperability).<a href="#appendix-C.10-1.3.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="changes-affecting-section-11-iana-considerations">
<section id="appendix-C.11">
        <h3 id="name-changes-affecting-section-11">
<a href="#appendix-C.11" class="section-number selfRef">C.11. </a><a href="#name-changes-affecting-section-11" class="section-name selfRef">Changes affecting Section 11 - IANA Considerations</a>
        </h3>
<ul class="normal">
<li class="normal" id="appendix-C.11-1.1">
            <p id="appendix-C.11-1.1.1">Clarified that IANA must update existing MDN registries to reference this
specification (replacing RFC 4130).<a href="#appendix-C.11-1.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-C.11-1.2">
            <p id="appendix-C.11-1.2.1">Added direct links to IANA registry pages for clarity.<a href="#appendix-C.11-1.2.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="appendices">
<section id="appendix-C.12">
        <h3 id="name-appendices">
<a href="#appendix-C.12" class="section-number selfRef">C.12. </a><a href="#name-appendices" class="section-name selfRef">Appendices</a>
        </h3>
<ul class="normal">
<li class="normal" id="appendix-C.12-1.1">
            <p id="appendix-C.12-1.1.1"><strong>Appendix A</strong>: Updated Message Examples with newer algorithms.<a href="#appendix-C.12-1.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-C.12-1.2">
            <p id="appendix-C.12-1.2.1"><strong>Appendix B</strong>: Legacy Interoperability (non-normative clarifications):<a href="#appendix-C.12-1.2.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-C.12-1.2.2.1">
                <p id="appendix-C.12-1.2.2.1.1">Captures behavior when interoperating with RFC 4130 systems.<a href="#appendix-C.12-1.2.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="appendix-C.12-1.2.2.2">
                <p id="appendix-C.12-1.2.2.2.1">Explicit note: 3DES withdrawn by NIST in 2024; MAY only be accepted for
backward compatibility, MUST NOT be generated.<a href="#appendix-C.12-1.2.2.2.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li class="normal" id="appendix-C.12-1.3">
            <p id="appendix-C.12-1.3.1"><strong>Appendix C</strong>: This Change Log.<a href="#appendix-C.12-1.3.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
</section>
</div>
<div id="authors-addresses">
<section id="appendix-D">
      <h2 id="name-authors-address">
<a href="#name-authors-address" class="section-name selfRef">Author's Address</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Debra Petta</span></div>
<div dir="auto" class="left"><span class="org">Drummond Group, LLC</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:IETF-Activity@drummondgroup.com" class="email">IETF-Activity@drummondgroup.com</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>
</body>
</html>
